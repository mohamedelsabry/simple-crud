import{A as JT,B as wn,C as ci,D as Xd,E as Ku,F as iy,G as XT,H as e0,I as ne,J as en,K as ft,L as sy,M as t0,N as Qu,O as ye,P as un,Q as eh,R as oy,S as En,T as li,U as fs,V as th,W as n0,X as Vn,Y as yt,a as q,b as Ae,c as ty,d as N,e as HT,f as Kd,g as qT,h as GT,i as L,j as Co,k as Qd,l as zT,m as WT,n as mt,o as Yd,p as Wu,q as ny,r as KT,s as nr,t as ry,u as Zd,v as QT,w as YT,x as Jd,y as ot,z as ZT}from"./chunk-DUSAWRNZ.js";var r0=null;var ay=1,i0=Symbol("SIGNAL");function we(n){let e=r0;return r0=n,e}var s0={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function wV(n){if(!(ly(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===ay)){if(!n.producerMustRecompute(n)&&!uy(n)){n.dirty=!1,n.lastCleanEpoch=ay;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=ay}}function o0(n){return n&&(n.nextProducerIndex=0),we(n)}function a0(n,e){if(we(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(ly(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)cy(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function uy(n){nh(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(wV(t),r!==t.version))return!0}return!1}function u0(n){if(nh(n),ly(n))for(let e=0;e<n.producerNode.length;e++)cy(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function cy(n,e){if(EV(n),nh(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)cy(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];nh(i),i.producerIndexOfThis[r]=e}}function ly(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function nh(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function EV(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function IV(){throw new Error}var CV=IV;function c0(n){CV=n}function ie(n){return typeof n=="function"}function Do(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var rh=Do(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ps(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var et=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ie(r))try{r()}catch(s){e=s instanceof rh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{l0(s)}catch(o){e=e??[],o instanceof rh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new rh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)l0(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ps(t,e)}remove(e){let{_finalizers:t}=this;t&&ps(t,e),e instanceof n&&e._removeParent(this)}};et.EMPTY=(()=>{let n=new et;return n.closed=!0,n})();var dy=et.EMPTY;function ih(n){return n instanceof et||n&&"closed"in n&&ie(n.remove)&&ie(n.add)&&ie(n.unsubscribe)}function l0(n){ie(n)?n():n.unsubscribe()}var Ln={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var bo={setTimeout(n,e,...t){let{delegate:r}=bo;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=bo;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function sh(n){bo.setTimeout(()=>{let{onUnhandledError:e}=Ln;if(e)e(n);else throw n})}function gs(){}var d0=hy("C",void 0,void 0);function h0(n){return hy("E",void 0,n)}function f0(n){return hy("N",n,void 0)}function hy(n,e,t){return{kind:n,value:e,error:t}}var ms=null;function To(n){if(Ln.useDeprecatedSynchronousErrorHandling){let e=!ms;if(e&&(ms={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=ms;if(ms=null,t)throw r}}else n()}function p0(n){Ln.useDeprecatedSynchronousErrorHandling&&ms&&(ms.errorThrown=!0,ms.error=n)}var ys=class extends et{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ih(e)&&e.add(this)):this.destination=TV}static create(e,t,r){return new kr(e,t,r)}next(e){this.isStopped?py(f0(e),this):this._next(e)}error(e){this.isStopped?py(h0(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?py(d0,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},DV=Function.prototype.bind;function fy(n,e){return DV.call(n,e)}var gy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){oh(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){oh(r)}else oh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){oh(t)}}},kr=class extends ys{constructor(e,t,r){super();let i;if(ie(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Ln.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&fy(e.next,s),error:e.error&&fy(e.error,s),complete:e.complete&&fy(e.complete,s)}):i=e}this.destination=new gy(i)}};function oh(n){Ln.useDeprecatedSynchronousErrorHandling?p0(n):sh(n)}function bV(n){throw n}function py(n,e){let{onStoppedNotification:t}=Ln;t&&bo.setTimeout(()=>t(n,e))}var TV={closed:!0,next:gs,error:bV,complete:gs};var So=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Dt(n){return n}function my(...n){return yy(n)}function yy(n){return n.length===0?Dt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var de=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=AV(t)?t:new kr(t,r,i);return To(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=g0(r),new r((i,s)=>{let o=new kr({next:a=>{try{t(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[So](){return this}pipe(...t){return yy(t)(this)}toPromise(t){return t=g0(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function g0(n){var e;return(e=n??Ln.Promise)!==null&&e!==void 0?e:Promise}function SV(n){return n&&ie(n.next)&&ie(n.error)&&ie(n.complete)}function AV(n){return n&&n instanceof ys||SV(n)&&ih(n)}function vy(n){return ie(n?.lift)}function oe(n){return e=>{if(vy(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function se(n,e,t,r,i){return new _y(n,e,t,r,i)}var _y=class extends ys{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ao(){return oe((n,e)=>{let t=null;n._refCount++;let r=se(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var xo=class extends de{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,vy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new et;let t=this.getSubject();e.add(this.source.subscribe(se(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=et.EMPTY)}return e}refCount(){return Ao()(this)}};var m0=Do(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ze=(()=>{class n extends de{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new ah(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new m0}next(t){To(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){To(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){To(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?dy:(this.currentObservers=null,s.push(t),new et(()=>{this.currentObservers=null,ps(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new de;return t.source=this,t}}return n.create=(e,t)=>new ah(e,t),n})(),ah=class extends Ze{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:dy}};var bt=class extends Ze{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Yu={now(){return(Yu.delegate||Date).now()},delegate:void 0};var uh=class extends Ze{constructor(e=1/0,t=1/0,r=Yu){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=t.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var ch=class extends et{constructor(e,t){super()}schedule(e,t=0){return this}};var Zu={setInterval(n,e,...t){let{delegate:r}=Zu;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Zu;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Mo=class extends ch{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return Zu.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Zu.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ps(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Ro=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Ro.now=Yu.now;var No=class extends Ro{constructor(e,t=Ro.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var vs=new No(Mo);var lh=class extends Mo{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var dh=class extends No{};var wy=new dh(lh);var Ht=new de(n=>n.complete());function y0(n){return n&&ie(n.schedule)}function Ey(n){return n[n.length-1]}function Po(n){return ie(Ey(n))?n.pop():void 0}function rr(n){return y0(Ey(n))?n.pop():void 0}function v0(n,e){return typeof Ey(n)=="number"?n.pop():e}var hh=n=>n&&typeof n.length=="number"&&typeof n!="function";function fh(n){return ie(n?.then)}function ph(n){return ie(n[So])}function gh(n){return Symbol.asyncIterator&&ie(n?.[Symbol.asyncIterator])}function mh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function xV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var yh=xV();function vh(n){return ie(n?.[yh])}function _h(n){return qT(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Kd(t.read());if(i)return yield Kd(void 0);yield yield Kd(r)}}finally{t.releaseLock()}})}function wh(n){return ie(n?.getReader)}function ke(n){if(n instanceof de)return n;if(n!=null){if(ph(n))return MV(n);if(hh(n))return RV(n);if(fh(n))return NV(n);if(gh(n))return _0(n);if(vh(n))return PV(n);if(wh(n))return kV(n)}throw mh(n)}function MV(n){return new de(e=>{let t=n[So]();if(ie(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function RV(n){return new de(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function NV(n){return new de(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,sh)})}function PV(n){return new de(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function _0(n){return new de(e=>{OV(n,e).catch(t=>e.error(t))})}function kV(n){return _0(_h(n))}function OV(n,e){var t,r,i,s;return HT(this,void 0,void 0,function*(){try{for(t=GT(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function tn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function In(n,e=0){return oe((t,r)=>{t.subscribe(se(r,i=>tn(r,n,()=>r.next(i),e),()=>tn(r,n,()=>r.complete(),e),i=>tn(r,n,()=>r.error(i),e)))})}function jn(n,e=0){return oe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function w0(n,e){return ke(n).pipe(jn(e),In(e))}function E0(n,e){return ke(n).pipe(jn(e),In(e))}function I0(n,e){return new de(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function C0(n,e){return new de(t=>{let r;return tn(t,e,()=>{r=n[yh](),tn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>ie(r?.return)&&r.return()})}function Eh(n,e){if(!n)throw new Error("Iterable cannot be null");return new de(t=>{tn(t,e,()=>{let r=n[Symbol.asyncIterator]();tn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function D0(n,e){return Eh(_h(n),e)}function b0(n,e){if(n!=null){if(ph(n))return w0(n,e);if(hh(n))return I0(n,e);if(fh(n))return E0(n,e);if(gh(n))return Eh(n,e);if(vh(n))return C0(n,e);if(wh(n))return D0(n,e)}throw mh(n)}function be(n,e){return e?b0(n,e):ke(n)}function Z(...n){let e=rr(n);return be(n,e)}function ko(n,e){let t=ie(n)?n:()=>n,r=i=>i.error(t());return new de(e?i=>e.schedule(r,0,i):r)}function Iy(n){return!!n&&(n instanceof de||ie(n.lift)&&ie(n.subscribe))}var Or=Do(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Q(n,e){return oe((t,r)=>{let i=0;t.subscribe(se(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:FV}=Array;function VV(n,e){return FV(e)?n(...e):n(e)}function Ih(n){return Q(e=>VV(n,e))}var{isArray:LV}=Array,{getPrototypeOf:jV,prototype:UV,keys:BV}=Object;function Ch(n){if(n.length===1){let e=n[0];if(LV(e))return{args:e,keys:null};if($V(e)){let t=BV(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function $V(n){return n&&typeof n=="object"&&jV(n)===UV}function Dh(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Ju(...n){let e=rr(n),t=Po(n),{args:r,keys:i}=Ch(n);if(r.length===0)return be([],e);let s=new de(HV(r,e,i?o=>Dh(i,o):Dt));return t?s.pipe(Ih(t)):s}function HV(n,e,t=Dt){return r=>{T0(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)T0(e,()=>{let l=be(n[u],e),d=!1;l.subscribe(se(r,f=>{s[u]=f,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function T0(n,e,t){n?tn(t,n,e):e()}function S0(n,e,t,r,i,s,o,a){let u=[],l=0,d=0,f=!1,g=()=>{f&&!u.length&&!l&&e.complete()},y=D=>l<r?_(D):u.push(D),_=D=>{s&&e.next(D),l++;let S=!1;ke(t(D,d++)).subscribe(se(e,k=>{i?.(k),s?y(k):e.next(k)},()=>{S=!0},void 0,()=>{if(S)try{for(l--;u.length&&l<r;){let k=u.shift();o?tn(e,o,()=>_(k)):_(k)}g()}catch(k){e.error(k)}}))};return n.subscribe(se(e,y,()=>{f=!0,g()})),()=>{a?.()}}function at(n,e,t=1/0){return ie(e)?at((r,i)=>Q((s,o)=>e(r,s,i,o))(ke(n(r,i))),t):(typeof e=="number"&&(t=e),oe((r,i)=>S0(r,i,n,t)))}function di(n=1/0){return at(Dt,n)}function A0(){return di(1)}function Oo(...n){return A0()(be(n,rr(n)))}function bh(n){return new de(e=>{ke(n()).subscribe(e)})}function Cy(...n){let e=Po(n),{args:t,keys:r}=Ch(n),i=new de(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),u=o,l=o;for(let d=0;d<o;d++){let f=!1;ke(t[d]).subscribe(se(s,g=>{f||(f=!0,l--),a[d]=g},()=>u--,void 0,()=>{(!u||!f)&&(l||s.next(r?Dh(r,a):a),s.complete())}))}});return e?i.pipe(Ih(e)):i}function Fo(...n){let e=rr(n),t=v0(n,1/0),r=n;return r.length?r.length===1?ke(r[0]):di(t)(be(r,e)):Ht}function Tt(n,e){return oe((t,r)=>{let i=0;t.subscribe(se(r,s=>n.call(e,s,i++)&&r.next(s)))})}function hi(n){return oe((e,t)=>{let r=null,i=!1,s;r=e.subscribe(se(t,void 0,void 0,o=>{s=ke(n(o,hi(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function x0(n,e,t,r,i){return(s,o)=>{let a=t,u=e,l=0;s.subscribe(se(o,d=>{let f=l++;u=a?n(u,d,f):(a=!0,d),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function _s(n,e){return ie(e)?at(n,e,1):at(n,1)}function fi(n){return oe((e,t)=>{let r=!1;e.subscribe(se(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Fr(n){return n<=0?()=>Ht:oe((e,t)=>{let r=0;e.subscribe(se(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Dy(n){return Q(()=>n)}function Xu(n,e=Dt){return n=n??qV,oe((t,r)=>{let i,s=!0;t.subscribe(se(r,o=>{let a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function qV(n,e){return n===e}function Th(n=GV){return oe((e,t)=>{let r=!1;e.subscribe(se(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function GV(){return new Or}function ec(n){return oe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Cn(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Tt((i,s)=>n(i,s,r)):Dt,Fr(1),t?fi(e):Th(()=>new Or))}function Vo(n){return n<=0?()=>Ht:oe((e,t)=>{let r=[];e.subscribe(se(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function by(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Tt((i,s)=>n(i,s,r)):Dt,Vo(1),t?fi(e):Th(()=>new Or))}function tc(){return oe((n,e)=>{let t,r=!1;n.subscribe(se(e,i=>{let s=t;t=i,r&&e.next([s,i]),r=!0}))})}function ir(n,e){return oe(x0(n,e,arguments.length>=2,!0))}function nc(n={}){let{connector:e=()=>new Ze,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o,a,u,l=0,d=!1,f=!1,g=()=>{a?.unsubscribe(),a=void 0},y=()=>{g(),o=u=void 0,d=f=!1},_=()=>{let D=o;y(),D?.unsubscribe()};return oe((D,S)=>{l++,!f&&!d&&g();let k=u=u??e();S.add(()=>{l--,l===0&&!f&&!d&&(a=Ty(_,i))}),k.subscribe(S),!o&&l>0&&(o=new kr({next:U=>k.next(U),error:U=>{f=!0,g(),a=Ty(y,t,U),k.error(U)},complete:()=>{d=!0,g(),a=Ty(y,r),k.complete()}}),ke(D).subscribe(o))})(s)}}function Ty(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new kr({next:()=>{r.unsubscribe(),n()}});return ke(e(...t)).subscribe(r)}function Sh(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,nc({connector:()=>new uh(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Sy(n){return oe((e,t)=>{let r=!1,i=0;e.subscribe(se(t,s=>(r||(r=!n(s,i++)))&&t.next(s)))})}function ws(...n){let e=rr(n);return oe((t,r)=>{(e?Oo(n,t,e):Oo(n,t)).subscribe(r)})}function Ge(n,e){return oe((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(se(r,u=>{i?.unsubscribe();let l=0,d=s++;ke(n(u,d)).subscribe(i=se(r,f=>r.next(e?e(u,f,d,l++):f),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Ah(n,e){return ie(e)?Ge(()=>n,e):Ge(()=>n)}function Ay(n){return oe((e,t)=>{ke(n).subscribe(se(t,()=>t.complete(),gs)),!t.closed&&e.subscribe(t)})}function pt(n,e,t){let r=ie(n)||e||t?{next:n,error:e,complete:t}:n;return r?oe((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(se(s,u=>{var l;(l=r.next)===null||l===void 0||l.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,u),s.error(u)},()=>{var u,l;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Dt}function xy(...n){let e=Po(n);return oe((t,r)=>{let i=n.length,s=new Array(i),o=n.map(()=>!1),a=!1;for(let u=0;u<i;u++)ke(n[u]).subscribe(se(r,l=>{s[u]=l,!a&&!o[u]&&(o[u]=!0,(a=o.every(Dt))&&(o=null))},gs));t.subscribe(se(r,u=>{if(a){let l=[u,...s];r.next(e?e(...l):l)}}))})}var hS="https://g.co/ng/security#xss",ee=class extends Error{constructor(e,t){super(Ov(e,t)),this.code=e}};function Ov(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function vc(n){return{toString:n}.toString()}var xh="__parameters__";function zV(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function fS(n,e,t){return vc(()=>{let r=zV(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,l,d){let f=u.hasOwnProperty(xh)?u[xh]:Object.defineProperty(u,xh,{value:[]})[xh];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),u}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Es=globalThis;function Oe(n){for(let e in n)if(n[e]===Oe)return e;throw Error("Could not find renamed property on target object.")}function WV(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function nn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(nn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function M0(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var KV=Oe({__forward_ref__:Oe});function ta(n){return n.__forward_ref__=ta,n.toString=function(){return nn(this())},n}function qt(n){return pS(n)?n():n}function pS(n){return typeof n=="function"&&n.hasOwnProperty(KV)&&n.__forward_ref__===ta}function Y(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function zt(n){return{providers:n.providers||[],imports:n.imports||[]}}function sf(n){return R0(n,mS)||R0(n,yS)}function gS(n){return sf(n)!==null}function R0(n,e){return n.hasOwnProperty(e)?n[e]:null}function QV(n){let e=n&&(n[mS]||n[yS]);return e||null}function N0(n){return n&&(n.hasOwnProperty(P0)||n.hasOwnProperty(YV))?n[P0]:null}var mS=Oe({\u0275prov:Oe}),P0=Oe({\u0275inj:Oe}),yS=Oe({ngInjectableDef:Oe}),YV=Oe({ngInjectorDef:Oe}),z=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Y({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function vS(n){return n&&!!n.\u0275providers}var ZV=Oe({\u0275cmp:Oe}),JV=Oe({\u0275dir:Oe}),XV=Oe({\u0275pipe:Oe}),eL=Oe({\u0275mod:Oe}),Lh=Oe({\u0275fac:Oe}),rc=Oe({__NG_ELEMENT_ID__:Oe}),k0=Oe({__NG_ENV_ID__:Oe});function of(n){return typeof n=="string"?n:n==null?"":String(n)}function tL(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():of(n)}function nL(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ee(-200,n)}function Fv(n,e){throw new ee(-201,!1)}var ge=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ge||{}),zy;function _S(){return zy}function Dn(n){let e=zy;return zy=n,e}function wS(n,e,t){let r=sf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ge.Optional)return null;if(e!==void 0)return e;Fv(n,"Injector")}var rL={},ic=rL,Wy="__NG_DI_FLAG__",jh="ngTempTokenPath",iL="ngTokenPath",sL=/\n/gm,oL="\u0275",O0="__source",$o;function aL(){return $o}function pi(n){let e=$o;return $o=n,e}function uL(n,e=ge.Default){if($o===void 0)throw new ee(-203,!1);return $o===null?wS(n,void 0,e):$o.get(n,e&ge.Optional?null:void 0,e)}function V(n,e=ge.Default){return(_S()||uL)(qt(n),e)}function H(n,e=ge.Default){return V(n,af(e))}function af(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Ky(n){let e=[];for(let t=0;t<n.length;t++){let r=qt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ee(900,!1);let i,s=ge.Default;for(let o=0;o<r.length;o++){let a=r[o],u=cL(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(V(i,s))}else e.push(V(r))}return e}function ES(n,e){return n[Wy]=e,n.prototype[Wy]=e,n}function cL(n){return n[Wy]}function lL(n,e,t,r){let i=n[jh];throw e[O0]&&i.unshift(e[O0]),n.message=dL(`
`+n.message,i,t,r),n[iL]=i,n[jh]=null,n}function dL(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==oL?n.slice(2):n;let i=nn(e);if(Array.isArray(e))i=e.map(nn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):nn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(sL,`
  `)}`}var _c=ES(fS("Optional"),8);var IS=ES(fS("SkipSelf"),4);function qo(n,e){let t=n.hasOwnProperty(Lh);return t?n[Lh]:null}function Vv(n,e){n.forEach(t=>Array.isArray(t)?Vv(t,e):e(t))}function CS(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Uh(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function hL(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function fL(n,e,t){let r=wc(n,e);return r>=0?n[r|1]=t:(r=~r,hL(n,r,e,t)),r}function My(n,e){let t=wc(n,e);if(t>=0)return n[t|1]}function wc(n,e){return pL(n,e,1)}function pL(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var Go={},bn=[],zo=new z(""),DS=new z("",-1),bS=new z(""),Bh=class{get(e,t=ic){if(t===ic){let r=new Error(`NullInjectorError: No provider for ${nn(e)}!`);throw r.name="NullInjectorError",r}return t}},TS=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(TS||{}),ar=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(ar||{}),Ot=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Ot||{});function gL(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function Qy(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];mL(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function SS(n){return n===3||n===4||n===6}function mL(n){return n.charCodeAt(0)===64}function sc(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?F0(n,t,i,null,e[++r]):F0(n,t,i,null,null))}}return n}function F0(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var AS="ng-template";function yL(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&gL(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Lv(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Lv(n){return n.type===4&&n.value!==AS}function vL(n,e,t){let r=n.type===4&&!t?AS:n.value;return e===r}function _L(n,e,t){let r=4,i=n.attrs,s=i!==null?IL(i):0,o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!Un(r)&&!Un(u))return!1;if(o&&Un(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!vL(n,u,t)||u===""&&e.length===1){if(Un(r))return!1;o=!0}}else if(r&8){if(i===null||!yL(n,i,u,t)){if(Un(r))return!1;o=!0}}else{let l=e[++a],d=wL(u,i,Lv(n),t);if(d===-1){if(Un(r))return!1;o=!0;continue}if(l!==""){let f;if(d>s?f="":f=i[d+1].toLowerCase(),r&2&&l!==f){if(Un(r))return!1;o=!0}}}}return Un(r)||o}function Un(n){return(n&1)===0}function wL(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return CL(e,n)}function EL(n,e,t=!1){for(let r=0;r<e.length;r++)if(_L(n,e[r],t))return!0;return!1}function IL(n){for(let e=0;e<n.length;e++){let t=n[e];if(SS(t))return e}return n.length}function CL(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function V0(n,e){return n?":not("+e.trim()+")":e}function DL(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Un(o)&&(e+=V0(s,i),i=""),r=o,s=s||!Un(r);t++}return i!==""&&(e+=V0(s,i)),e}function bL(n){return n.map(DL).join(",")}function TL(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Un(i))break;i=s}r++}return{attrs:e,classes:t}}function _i(n){return vc(()=>{let e=PS(n),t=Ae(q({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===TS.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||ar.Emulated,styles:n.styles||bn,_:null,schemas:n.schemas||null,tView:null,id:""});kS(t);let r=n.dependencies;return t.directiveDefs=j0(r,!1),t.pipeDefs=j0(r,!0),t.id=xL(t),t})}function SL(n){return mi(n)||xS(n)}function AL(n){return n!==null}function Wt(n){return vc(()=>({type:n.type,bootstrap:n.bootstrap||bn,declarations:n.declarations||bn,imports:n.imports||bn,exports:n.exports||bn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function L0(n,e){if(n==null)return Go;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=Ot.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==Ot.None?[r,a]:r,e[s]=o):t[s]=r}return t}function cn(n){return vc(()=>{let e=PS(n);return kS(e),e})}function mi(n){return n[ZV]||null}function xS(n){return n[JV]||null}function MS(n){return n[XV]||null}function RS(n){let e=mi(n)||xS(n)||MS(n);return e!==null?e.standalone:!1}function NS(n,e){let t=n[eL]||null;if(!t&&e===!0)throw new Error(`Type ${nn(n)} does not have '\u0275mod' property.`);return t}function PS(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Go,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||bn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:L0(n.inputs,e),outputs:L0(n.outputs),debugInfo:null}}function kS(n){n.features?.forEach(e=>e(n))}function j0(n,e){if(!n)return null;let t=e?MS:SL;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(AL)}function xL(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function uf(n){return{\u0275providers:n}}function jv(...n){return{\u0275providers:OS(!0,n),\u0275fromNgModule:!0}}function OS(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Vv(e,o=>{let a=o;Yy(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&FS(i,s),t}function FS(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Uv(i,s=>{e(s,r)})}}function Yy(n,e,t,r){if(n=qt(n),!n)return!1;let i=null,s=N0(n),o=!s&&mi(n);if(!s&&!o){let u=n.ngModule;if(s=N0(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of u)Yy(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Vv(s.imports,d=>{Yy(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&FS(l,e)}if(!a){let l=qo(i)||(()=>new i);e({provide:i,useFactory:l,deps:bn},i),e({provide:bS,useValue:i,multi:!0},i),e({provide:zo,useValue:()=>V(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let l=n;Uv(u,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Uv(n,e){for(let t of n)vS(t)&&(t=t.\u0275providers),Array.isArray(t)?Uv(t,e):e(t)}var ML=Oe({provide:String,useValue:Oe});function VS(n){return n!==null&&typeof n=="object"&&ML in n}function RL(n){return!!(n&&n.useExisting)}function NL(n){return!!(n&&n.useFactory)}function Wo(n){return typeof n=="function"}function PL(n){return!!n.useClass}var cf=new z(""),Ph={},kL={},Ry;function Bv(){return Ry===void 0&&(Ry=new Bh),Ry}var rn=class{},oc=class extends rn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Jy(e,o=>this.processProvider(o)),this.records.set(DS,Lo(void 0,this)),i.has("environment")&&this.records.set(rn,Lo(void 0,this));let s=this.records.get(cf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(bS,bn,ge.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=we(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),we(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=pi(this),r=Dn(void 0),i;try{return e()}finally{pi(t),Dn(r)}}get(e,t=ic,r=ge.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(k0))return e[k0](this);r=af(r);let i,s=pi(this),o=Dn(void 0);try{if(!(r&ge.SkipSelf)){let u=this.records.get(e);if(u===void 0){let l=jL(e)&&sf(e);l&&this.injectableDefInScope(l)?u=Lo(Zy(e),Ph):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&ge.Self?Bv():this.parent;return t=r&ge.Optional&&t===ic?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[jh]=a[jh]||[]).unshift(nn(e)),s)throw a;return lL(a,e,"R3InjectorError",this.source)}else throw a}finally{Dn(o),pi(s)}}resolveInjectorInitializers(){let e=we(null),t=pi(this),r=Dn(void 0),i;try{let s=this.get(zo,bn,ge.Self);for(let o of s)o()}finally{pi(t),Dn(r),we(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(nn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ee(205,!1)}processProvider(e){e=qt(e);let t=Wo(e)?e:qt(e&&e.provide),r=FL(e);if(!Wo(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Lo(void 0,Ph,!0),i.factory=()=>Ky(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=we(null);try{return t.value===Ph&&(t.value=kL,t.value=t.factory()),typeof t.value=="object"&&t.value&&LL(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{we(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=qt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Zy(n){let e=sf(n),t=e!==null?e.factory:qo(n);if(t!==null)return t;if(n instanceof z)throw new ee(204,!1);if(n instanceof Function)return OL(n);throw new ee(204,!1)}function OL(n){if(n.length>0)throw new ee(204,!1);let t=QV(n);return t!==null?()=>t.factory(n):()=>new n}function FL(n){if(VS(n))return Lo(void 0,n.useValue);{let e=LS(n);return Lo(e,Ph)}}function LS(n,e,t){let r;if(Wo(n)){let i=qt(n);return qo(i)||Zy(i)}else if(VS(n))r=()=>qt(n.useValue);else if(NL(n))r=()=>n.useFactory(...Ky(n.deps||[]));else if(RL(n))r=()=>V(qt(n.useExisting));else{let i=qt(n&&(n.useClass||n.provide));if(VL(n))r=()=>new i(...Ky(n.deps));else return qo(i)||Zy(i)}return r}function Lo(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function VL(n){return!!n.deps}function LL(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function jL(n){return typeof n=="function"||typeof n=="object"&&n instanceof z}function Jy(n,e){for(let t of n)Array.isArray(t)?Jy(t,e):t&&vS(t)?Jy(t.\u0275providers,e):e(t)}function jr(n,e){n instanceof oc&&n.assertNotDestroyed();let t,r=pi(n),i=Dn(void 0);try{return e()}finally{pi(r),Dn(i)}}function jS(){return _S()!==void 0||aL()!=null}function UL(n){if(!jS())throw new ee(-203,!1)}function BL(n){return typeof n=="function"}var Ur=0,he=1,re=2,Ft=3,Bn=4,Gn=5,ac=6,uc=7,kt=8,Ko=9,$n=10,St=11,cc=12,U0=13,na=14,Hn=15,lf=16,jo=17,Qo=18,df=19,US=20,gi=21,Ny=22,Ds=23,qn=25,BS=1;var bs=7,$h=8,Hh=9,Gt=10,$v=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}($v||{});function Is(n){return Array.isArray(n)&&typeof n[BS]=="object"}function Br(n){return Array.isArray(n)&&n[BS]===!0}function $S(n){return(n.flags&4)!==0}function hf(n){return n.componentOffset>-1}function Hv(n){return(n.flags&1)===1}function yi(n){return!!n.template}function $L(n){return(n[re]&512)!==0}var Xy=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function HS(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function lr(){return qS}function qS(n){return n.type.prototype.ngOnChanges&&(n.setInput=qL),HL}lr.ngInherit=!0;function HL(){let n=zS(this),e=n?.current;if(e){let t=n.previous;if(t===Go)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function qL(n,e,t,r,i){let s=this.declaredInputs[r],o=zS(n)||GL(n,{previous:Go,current:null}),a=o.current||(o.current={}),u=o.previous,l=u[s];a[s]=new Xy(l&&l.currentValue,t,u===Go),HS(n,e,i,t)}var GS="__ngSimpleChanges__";function zS(n){return n[GS]||null}function GL(n,e){return n[GS]=e}var B0=null;var sr=function(n,e,t){B0?.(n,e,t)},zL="svg",WL="math",KL=!1;function QL(){return KL}function ur(n){for(;Array.isArray(n);)n=n[Ur];return n}function WS(n,e){return ur(e[n])}function Tn(n,e){return ur(e[n.index])}function qv(n,e){return n.data[e]}function wi(n,e){let t=e[n];return Is(t)?t:t[Ur]}function Gv(n){return(n[re]&128)===128}function YL(n){return Br(n[Ft])}function qh(n,e){return e==null?null:n[e]}function KS(n){n[jo]=0}function ZL(n){n[re]&1024||(n[re]|=1024,Gv(n)&&lc(n))}function JL(n,e){for(;n>0;)e=e[na],n--;return e}function zv(n){return!!(n[re]&9216||n[Ds]?.dirty)}function ev(n){n[$n].changeDetectionScheduler?.notify(1),zv(n)?lc(n):n[re]&64&&(QL()?(n[re]|=1024,lc(n)):n[$n].changeDetectionScheduler?.notify())}function lc(n){n[$n].changeDetectionScheduler?.notify();let e=dc(n);for(;e!==null&&!(e[re]&8192||(e[re]|=8192,!Gv(e)));)e=dc(e)}function QS(n,e){if((n[re]&256)===256)throw new ee(911,!1);n[gi]===null&&(n[gi]=[]),n[gi].push(e)}function XL(n,e){if(n[gi]===null)return;let t=n[gi].indexOf(e);t!==-1&&n[gi].splice(t,1)}function dc(n){let e=n[Ft];return Br(e)?e[Ft]:e}var ve={lFrame:nA(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function ej(){return ve.lFrame.elementDepthCount}function tj(){ve.lFrame.elementDepthCount++}function nj(){ve.lFrame.elementDepthCount--}function YS(){return ve.bindingsEnabled}function rj(){return ve.skipHydrationRootTNode!==null}function ij(n){return ve.skipHydrationRootTNode===n}function sj(){ve.skipHydrationRootTNode=null}function He(){return ve.lFrame.lView}function zn(){return ve.lFrame.tView}function Wv(n){return ve.lFrame.contextLView=n,n[kt]}function Kv(n){return ve.lFrame.contextLView=null,n}function Sn(){let n=ZS();for(;n!==null&&n.type===64;)n=n.parent;return n}function ZS(){return ve.lFrame.currentTNode}function oj(){let n=ve.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Ec(n,e){let t=ve.lFrame;t.currentTNode=n,t.isParent=e}function JS(){return ve.lFrame.isParent}function aj(){ve.lFrame.isParent=!1}function uj(n){return ve.lFrame.bindingIndex=n}function Ic(){return ve.lFrame.bindingIndex++}function cj(n){let e=ve.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function lj(){return ve.lFrame.inI18n}function dj(n,e){let t=ve.lFrame;t.bindingIndex=t.bindingRootIndex=n,tv(e)}function hj(){return ve.lFrame.currentDirectiveIndex}function tv(n){ve.lFrame.currentDirectiveIndex=n}function fj(n){let e=ve.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function XS(n){ve.lFrame.currentQueryIndex=n}function pj(n){let e=n[he];return e.type===2?e.declTNode:e.type===1?n[Gn]:null}function eA(n,e,t){if(t&ge.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&ge.Host);)if(i=pj(s),i===null||(s=s[na],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=ve.lFrame=tA();return r.currentTNode=e,r.lView=n,!0}function Qv(n){let e=tA(),t=n[he];ve.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function tA(){let n=ve.lFrame,e=n===null?null:n.child;return e===null?nA(n):e}function nA(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function rA(){let n=ve.lFrame;return ve.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var iA=rA;function Yv(){let n=rA();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function gj(n){return(ve.lFrame.contextLView=JL(n,ve.lFrame.contextLView))[kt]}function Ms(){return ve.lFrame.selectedIndex}function Ts(n){ve.lFrame.selectedIndex=n}function sA(){let n=ve.lFrame;return qv(n.tView,n.selectedIndex)}function mj(){return ve.lFrame.currentNamespace}var oA=!0;function Zv(){return oA}function Jv(n){oA=n}function yj(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=qS(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function Xv(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function kh(n,e,t){aA(n,e,3,t)}function Oh(n,e,t,r){(n[re]&3)===t&&aA(n,e,t,r)}function Py(n,e){let t=n[re];(t&3)===e&&(t&=16383,t+=1,n[re]=t)}function aA(n,e,t,r){let i=r!==void 0?n[jo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(n[jo]+=65536),(a<s||s==-1)&&(vj(n,t,e,u),n[jo]=(n[jo]&4294901760)+u+2),u++}function $0(n,e){sr(4,n,e);let t=we(null);try{e.call(n)}finally{we(t),sr(5,n,e)}}function vj(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[re]>>14<n[jo]>>16&&(n[re]&3)===e&&(n[re]+=16384,$0(a,s)):$0(a,s)}var Ho=-1,Ss=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function _j(n){return n instanceof Ss}function wj(n){return(n.flags&8)!==0}function Ej(n){return(n.flags&16)!==0}function uA(n){return n!==Ho}function Gh(n){return n&32767}function Ij(n){return n>>16}function zh(n,e){let t=Ij(n),r=e;for(;t>0;)r=r[na],t--;return r}var nv=!0;function H0(n){let e=nv;return nv=n,e}var Cj=256,cA=Cj-1,lA=5,Dj=0,or={};function bj(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(rc)&&(r=t[rc]),r==null&&(r=t[rc]=Dj++);let i=r&cA,s=1<<i;e.data[n+(i>>lA)]|=s}function Wh(n,e){let t=dA(n,e);if(t!==-1)return t;let r=e[he];r.firstCreatePass&&(n.injectorIndex=e.length,ky(r.data,n),ky(e,null),ky(r.blueprint,null));let i=e_(n,e),s=n.injectorIndex;if(uA(i)){let o=Gh(i),a=zh(i,e),u=a[he].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|u[o+l]}return e[s+8]=i,s}function ky(n,e){n.push(0,0,0,0,0,0,0,0,e)}function dA(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function e_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=mA(i),r===null)return Ho;if(t++,i=i[na],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ho}function rv(n,e,t){bj(n,e,t)}function Tj(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(SS(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function hA(n,e,t){if(t&ge.Optional||n!==void 0)return n;Fv(e,"NodeInjector")}function fA(n,e,t,r){if(t&ge.Optional&&r===void 0&&(r=null),!(t&(ge.Self|ge.Host))){let i=n[Ko],s=Dn(void 0);try{return i?i.get(e,r,t&ge.Optional):wS(e,r,t&ge.Optional)}finally{Dn(s)}}return hA(r,e,t)}function pA(n,e,t,r=ge.Default,i){if(n!==null){if(e[re]&2048&&!(r&ge.Self)){let o=Rj(n,e,t,r,or);if(o!==or)return o}let s=gA(n,e,t,r,or);if(s!==or)return s}return fA(e,t,r,i)}function gA(n,e,t,r,i){let s=xj(t);if(typeof s=="function"){if(!eA(e,n,r))return r&ge.Host?hA(i,t,r):fA(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&ge.Optional))Fv(t);else return o}finally{iA()}}else if(typeof s=="number"){let o=null,a=dA(n,e),u=Ho,l=r&ge.Host?e[Hn][Gn]:null;for((a===-1||r&ge.SkipSelf)&&(u=a===-1?e_(n,e):e[a+8],u===Ho||!G0(r,!1)?a=-1:(o=e[he],a=Gh(u),e=zh(u,e)));a!==-1;){let d=e[he];if(q0(s,a,d.data)){let f=Sj(a,e,t,o,r,l);if(f!==or)return f}u=e[a+8],u!==Ho&&G0(r,e[he].data[a+8]===l)&&q0(s,a,e)?(o=d,a=Gh(u),e=zh(u,e)):a=-1}}return i}function Sj(n,e,t,r,i,s){let o=e[he],a=o.data[n+8],u=r==null?hf(a)&&nv:r!=o&&(a.type&3)!==0,l=i&ge.Host&&s===a,d=Aj(a,o,t,u,l);return d!==null?Yo(e,o,d,a):or}function Aj(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,u=n.directiveStart,l=n.directiveEnd,d=s>>20,f=r?a:a+d,g=i?a+d:l;for(let y=f;y<g;y++){let _=o[y];if(y<u&&t===_||y>=u&&_.type===t)return y}if(i){let y=o[u];if(y&&yi(y)&&y.type===t)return u}return null}function Yo(n,e,t,r){let i=n[t],s=e.data;if(_j(i)){let o=i;o.resolving&&nL(tL(s[t]));let a=H0(o.canSeeViewProviders);o.resolving=!0;let u,l=o.injectImpl?Dn(o.injectImpl):null,d=eA(n,r,ge.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&yj(t,s[t],e)}finally{l!==null&&Dn(l),H0(a),o.resolving=!1,iA()}}return i}function xj(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(rc)?n[rc]:void 0;return typeof e=="number"?e>=0?e&cA:Mj:e}function q0(n,e,t){let r=1<<n;return!!(t[e+(n>>lA)]&r)}function G0(n,e){return!(n&ge.Self)&&!(n&ge.Host&&e)}var Cs=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return pA(this._tNode,this._lView,e,af(r),t)}};function Mj(){return new Cs(Sn(),He())}function Cc(n){return vc(()=>{let e=n.prototype.constructor,t=e[Lh]||iv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Lh]||iv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function iv(n){return pS(n)?()=>{let e=iv(qt(n));return e&&e()}:qo(n)}function Rj(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[re]&2048&&!(o[re]&512);){let a=gA(s,o,t,r|ge.Self,or);if(a!==or)return a;let u=s.parent;if(!u){let l=o[US];if(l){let d=l.get(t,or,r);if(d!==or)return d}u=mA(o),o=o[na]}s=u}return i}function mA(n){let e=n[he],t=e.type;return t===2?e.declTNode:t===1?n[Gn]:null}function t_(n){return Tj(Sn(),n)}function z0(n,e=null,t=null,r){let i=yA(n,e,t,r);return i.resolveInjectorInitializers(),i}function yA(n,e=null,t=null,r,i=new Set){let s=[t||bn,jv(n)];return r=r||(typeof n=="object"?void 0:nn(n)),new oc(s,e||Bv(),r||null,i)}var $r=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return z0({name:""},i,r,"");{let s=r.name??"";return z0({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=ic,e.NULL=new Bh,e.\u0275prov=Y({token:e,providedIn:"any",factory:()=>V(DS)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var Nj="ngOriginalError";function Oy(n){return n[Nj]}var cr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Oy(e);for(;t&&Oy(t);)t=Oy(t);return t||null}},vA=new z("",{providedIn:"root",factory:()=>H(cr).handleError.bind(void 0)}),n_=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Pj,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),sv=class extends n_{constructor(e){super(),this._lView=e}onDestroy(e){return QS(this._lView,e),()=>XL(this._lView,e)}};function Pj(){return new sv(He())}function kj(){return r_(Sn(),He())}function r_(n,e){return new Ei(Tn(n,e))}var Ei=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=kj;let n=e;return n})();var ov=class extends Ze{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,jS()&&(this.destroyRef=H(n_,{optional:!0})??void 0)}emit(e){let t=we(null);try{super.next(e)}finally{we(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=Fy(s),i&&(i=Fy(i)),o&&(o=Fy(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof et&&e.add(a),a}};function Fy(n){return e=>{setTimeout(n,void 0,e)}}var Pt=ov;function _A(n){return(n.flags&128)===128}var wA=new Map,Oj=0;function Fj(){return Oj++}function Vj(n){wA.set(n[df],n)}function Lj(n){wA.delete(n[df])}var W0="__ngContext__";function As(n,e){Is(e)?(n[W0]=e[df],Vj(e)):n[W0]=e}function EA(n){return CA(n[cc])}function IA(n){return CA(n[Bn])}function CA(n){for(;n!==null&&!Br(n);)n=n[Bn];return n}var av;function DA(n){av=n}function jj(){if(av!==void 0)return av;if(typeof document<"u")return document;throw new ee(210,!1)}var i_=new z("",{providedIn:"root",factory:()=>Uj}),Uj="ng",s_=new z(""),Vt=new z("",{providedIn:"platform",factory:()=>"unknown"});var o_=new z("",{providedIn:"root",factory:()=>jj().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Bj="h",$j="b";var Hj=()=>null;function a_(n,e,t=!1){return Hj(n,e,t)}var bA=!1,qj=new z("",{providedIn:"root",factory:()=>bA});var Mh;function Gj(){if(Mh===void 0&&(Mh=null,Es.trustedTypes))try{Mh=Es.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Mh}function K0(n){return Gj()?.createScriptURL(n)||n}var Kh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${hS})`}};function Dc(n){return n instanceof Kh?n.changingThisBreaksApplicationSecurity:n}function u_(n,e){let t=zj(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${hS})`)}return t===e}function zj(n){return n instanceof Kh&&n.getTypeName()||null}var Wj=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function TA(n){return n=String(n),n.match(Wj)?n:"unsafe:"+n}var ff=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(ff||{});function Kj(n){let e=AA();return e?e.sanitize(ff.URL,n)||"":u_(n,"URL")?Dc(n):TA(of(n))}function Qj(n){let e=AA();if(e)return K0(e.sanitize(ff.RESOURCE_URL,n)||"");if(u_(n,"ResourceURL"))return K0(Dc(n));throw new ee(904,!1)}function Yj(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?Qj:Kj}function SA(n,e,t){return Yj(e,t)(n)}function AA(){let n=He();return n&&n[$n].sanitizer}function xA(n){return n instanceof Function?n():n}function Zj(n){return(n??H($r)).get(Vt)==="browser"}var Vr=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Vr||{}),Jj;function c_(n,e){return Jj(n,e)}function Uo(n,e,t,r,i){if(r!=null){let s,o=!1;Br(r)?s=r:Is(r)&&(o=!0,r=r[Ur]);let a=ur(r);n===0&&t!==null?i==null?PA(e,t,a):Qh(e,t,a,i||null,!0):n===1&&t!==null?Qh(e,t,a,i||null,!0):n===2?g2(e,a,o):n===3&&e.destroyNode(a),s!=null&&y2(e,n,s,t,i)}}function Xj(n,e){return n.createText(e)}function e2(n,e,t){n.setValue(e,t)}function MA(n,e,t){return n.createElement(e,t)}function t2(n,e){RA(n,e),e[Ur]=null,e[Gn]=null}function n2(n,e,t,r,i,s){r[Ur]=i,r[Gn]=e,gf(n,r,t,1,i,s)}function RA(n,e){e[$n].changeDetectionScheduler?.notify(1),gf(n,e,e[St],2,null,null)}function r2(n){let e=n[cc];if(!e)return Vy(n[he],n);for(;e;){let t=null;if(Is(e))t=e[cc];else{let r=e[Gt];r&&(t=r)}if(!t){for(;e&&!e[Bn]&&e!==n;)Is(e)&&Vy(e[he],e),e=e[Ft];e===null&&(e=n),Is(e)&&Vy(e[he],e),t=e&&e[Bn]}e=t}}function i2(n,e,t,r){let i=Gt+r,s=t.length;r>0&&(t[i-1][Bn]=e),r<s-Gt?(e[Bn]=t[i],CS(t,Gt+r,e)):(t.push(e),e[Bn]=null),e[Ft]=t;let o=e[lf];o!==null&&t!==o&&s2(o,e);let a=e[Qo];a!==null&&a.insertView(n),ev(e),e[re]|=128}function s2(n,e){let t=n[Hh],i=e[Ft][Ft][Hn];e[Hn]!==i&&(n[re]|=$v.HasTransplantedViews),t===null?n[Hh]=[e]:t.push(e)}function NA(n,e){let t=n[Hh],r=t.indexOf(e);t.splice(r,1)}function hc(n,e){if(n.length<=Gt)return;let t=Gt+e,r=n[t];if(r){let i=r[lf];i!==null&&i!==n&&NA(i,r),e>0&&(n[t-1][Bn]=r[Bn]);let s=Uh(n,Gt+e);t2(r[he],r);let o=s[Qo];o!==null&&o.detachView(s[he]),r[Ft]=null,r[Bn]=null,r[re]&=-129}return r}function pf(n,e){if(!(e[re]&256)){let t=e[St];t.destroyNode&&gf(n,e,t,3,null,null),r2(e)}}function Vy(n,e){if(e[re]&256)return;let t=we(null);try{e[re]&=-129,e[re]|=256,e[Ds]&&u0(e[Ds]),a2(n,e),o2(n,e),e[he].type===1&&e[St].destroy();let r=e[lf];if(r!==null&&Br(e[Ft])){r!==e[Ft]&&NA(r,e);let i=e[Qo];i!==null&&i.detachView(n)}Lj(e)}finally{we(t)}}function o2(n,e){let t=n.cleanup,r=e[uc];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[uc]=null);let i=e[gi];if(i!==null){e[gi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function a2(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Ss)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];sr(4,a,u);try{u.call(a)}finally{sr(5,a,u)}}else{sr(4,i,s);try{s.call(i)}finally{sr(5,i,s)}}}}}function u2(n,e,t){return c2(n,e.parent,t)}function c2(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[Ur];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===ar.None||s===ar.Emulated)return null}return Tn(r,t)}}function Qh(n,e,t,r,i){n.insertBefore(e,t,r,i)}function PA(n,e,t){n.appendChild(e,t)}function Q0(n,e,t,r,i){r!==null?Qh(n,e,t,r,i):PA(n,e,t)}function l2(n,e,t,r){n.removeChild(e,t,r)}function l_(n,e){return n.parentNode(e)}function d2(n,e){return n.nextSibling(e)}function h2(n,e,t){return p2(n,e,t)}function f2(n,e,t){return n.type&40?Tn(n,t):null}var p2=f2,Y0;function d_(n,e,t,r){let i=u2(n,r,e),s=e[St],o=r.parent||e[Gn],a=h2(o,r,e);if(i!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)Q0(s,i,t[u],a,!1);else Q0(s,i,t,a,!1);Y0!==void 0&&Y0(s,r,e,t,i)}function Fh(n,e){if(e!==null){let t=e.type;if(t&3)return Tn(e,n);if(t&4)return uv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Fh(n,r);{let i=n[e.index];return Br(i)?uv(-1,i):ur(i)}}else{if(t&32)return c_(e,n)()||ur(n[e.index]);{let r=kA(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=dc(n[Hn]);return Fh(i,r)}else return Fh(n,e.next)}}}return null}function kA(n,e){if(e!==null){let r=n[Hn][Gn],i=e.projection;return r.projection[i]}return null}function uv(n,e){let t=Gt+n+1;if(t<e.length){let r=e[t],i=r[he].firstChild;if(i!==null)return Fh(r,i)}return e[bs]}function g2(n,e,t){let r=l_(n,e);r&&l2(n,r,e,t)}function h_(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],u=t.type;if(o&&e===0&&(a&&As(ur(a),r),t.flags|=2),(t.flags&32)!==32)if(u&8)h_(n,e,t.child,r,i,s,!1),Uo(e,n,i,a,s);else if(u&32){let l=c_(t,r),d;for(;d=l();)Uo(e,n,i,d,s);Uo(e,n,i,a,s)}else u&16?m2(n,e,r,t,i,s):Uo(e,n,i,a,s);t=o?t.projectionNext:t.next}}function gf(n,e,t,r,i,s){h_(t,r,n.firstChild,e,i,s,!1)}function m2(n,e,t,r,i,s){let o=t[Hn],u=o[Gn].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let d=u[l];Uo(e,n,i,d,s)}else{let l=u,d=o[Ft];_A(r)&&(l.flags|=128),h_(n,e,l,d,i,s,!0)}}function y2(n,e,t,r,i){let s=t[bs],o=ur(t);s!==o&&Uo(e,n,r,s,i);for(let a=Gt;a<t.length;a++){let u=t[a];gf(u[he],u,n,e,r,s)}}function v2(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:Vr.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Vr.Important),n.setStyle(t,r,i,s))}}function _2(n,e,t){n.setAttribute(e,"style",t)}function OA(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function FA(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&Qy(n,e,r),i!==null&&OA(n,e,i),s!==null&&_2(n,e,s)}var ra={};function Wn(n=1){VA(zn(),He(),Ms()+n,!1)}function VA(n,e,t,r){if(!r)if((e[re]&3)===3){let s=n.preOrderCheckHooks;s!==null&&kh(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Oh(e,s,0,t)}Ts(t)}function Ee(n,e=ge.Default){let t=He();if(t===null)return V(n,e);let r=Sn();return pA(r,t,qt(n),e)}function LA(){let n="invalid";throw new Error(n)}function jA(n,e,t,r,i,s){let o=we(null);try{let a=null;i&Ot.SignalBased&&(a=e[r][i0]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Ot.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):HS(e,a,r,s)}finally{we(o)}}function w2(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Ts(~i);else{let s=i,o=t[++r],a=t[++r];dj(o,s);let u=e[s];a(2,u)}}}finally{Ts(-1)}}function mf(n,e,t,r,i,s,o,a,u,l,d){let f=e.blueprint.slice();return f[Ur]=i,f[re]=r|4|128|8|64,(l!==null||n&&n[re]&2048)&&(f[re]|=2048),KS(f),f[Ft]=f[na]=n,f[kt]=t,f[$n]=o||n&&n[$n],f[St]=a||n&&n[St],f[Ko]=u||n&&n[Ko]||null,f[Gn]=s,f[df]=Fj(),f[ac]=d,f[US]=l,f[Hn]=e.type==2?n[Hn]:f,f}function yf(n,e,t,r,i){let s=n.data[e];if(s===null)s=E2(n,e,t,r,i),lj()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=oj();s.injectorIndex=o===null?-1:o.injectorIndex}return Ec(s,!0),s}function E2(n,e,t,r,i){let s=ZS(),o=JS(),a=o?s:s&&s.parent,u=n.data[e]=T2(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function UA(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function BA(n,e,t,r,i){let s=Ms(),o=r&2;try{Ts(-1),o&&e.length>qn&&VA(n,e,qn,!1),sr(o?2:0,i),t(r,i)}finally{Ts(s),sr(o?3:1,i)}}function $A(n,e,t){if($S(e)){let r=we(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let u=t[o];a.contentQueries(1,u,o)}}}finally{we(r)}}}function HA(n,e,t){YS()&&(P2(n,e,t,Tn(t,e)),(t.flags&64)===64&&KA(n,e,t))}function qA(n,e,t=Tn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function GA(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=f_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function f_(n,e,t,r,i,s,o,a,u,l,d){let f=qn+r,g=f+i,y=I2(f,g),_=typeof l=="function"?l():l;return y[he]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:_,incompleteFirstPass:!1,ssrId:d}}function I2(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:ra);return t}function C2(n,e,t,r){let s=r.get(qj,bA)||t===ar.ShadowDom,o=n.selectRootElement(e,s);return D2(o),o}function D2(n){b2(n)}var b2=()=>null;function T2(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return rj()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Z0(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=Ot.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?J0(r,t,l,a,u):J0(r,t,l,a)}return r}function J0(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function S2(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],u=null,l=null;for(let d=r;d<i;d++){let f=s[d],g=t?t.get(f):null,y=g?g.inputs:null,_=g?g.outputs:null;u=Z0(0,f.inputs,d,u,y),l=Z0(1,f.outputs,d,l,_);let D=u!==null&&o!==null&&!Lv(e)?q2(u,d,o):null;a.push(D)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}function A2(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function x2(n,e,t,r,i,s,o,a){let u=Tn(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(p_(n,t,d,r,i),hf(e)&&M2(t,e.index)):e.type&3?(r=A2(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function M2(n,e){let t=wi(e,n);t[re]&16||(t[re]|=64)}function zA(n,e,t,r){if(YS()){let i=r===null?null:{"":-1},s=O2(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&WA(n,e,t,o,i,a),i&&F2(t,r,i)}t.mergedAttrs=sc(t.mergedAttrs,t.attrs)}function WA(n,e,t,r,i,s){for(let l=0;l<r.length;l++)rv(Wh(t,e),n,r[l].type);L2(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,u=UA(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=sc(t.mergedAttrs,d.hostAttrs),j2(n,t,e,u,d),V2(u,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let f=d.type.prototype;!o&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),u++}S2(n,t,s)}function R2(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;N2(o)!=a&&o.push(a),o.push(t,r,s)}}function N2(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function P2(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;hf(t)&&U2(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Wh(t,e),As(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let u=n.data[a],l=Yo(e,n,a,t);if(As(l,e),o!==null&&H2(e,a-i,l,u,t,o),yi(u)){let d=wi(t.index,e);d[kt]=Yo(e,n,a,t)}}}function KA(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=hj();try{Ts(s);for(let a=r;a<i;a++){let u=n.data[a],l=e[a];tv(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&k2(u,l)}}finally{Ts(-1),tv(o)}}function k2(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function O2(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(EL(e,o.selectors,!1))if(r||(r=[]),yi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;cv(n,e,u)}else r.unshift(o),cv(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function cv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function F2(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new ee(-301,!1);r.push(e[i],s)}}}function V2(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;yi(e)&&(t[""]=n)}}function L2(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function j2(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=qo(i.type,!0)),o=new Ss(s,yi(i),Ee);n.blueprint[r]=o,t[r]=o,R2(n,e,r,UA(n,t,i.hostVars,ra),i)}function U2(n,e,t){let r=Tn(e,n),i=GA(t),s=n[$n].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=vf(n,mf(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function B2(n,e,t,r,i,s){let o=Tn(n,e);$2(e[St],o,s,n.value,t,r,i)}function $2(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?of(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function H2(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],l=o[a++],d=o[a++],f=o[a++];jA(r,t,u,l,d,f)}}function q2(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function QA(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function YA(n,e){let t=n.contentQueries;if(t!==null){let r=we(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];XS(s),a.contentQueries(2,e[o],o)}}}finally{we(r)}}}function vf(n,e){return n[cc]?n[U0][Bn]=e:n[cc]=e,n[U0]=e,e}function lv(n,e,t){XS(0);let r=we(null);try{e(n,t)}finally{we(r)}}function G2(n){return n[uc]||(n[uc]=[])}function z2(n){return n.cleanup||(n.cleanup=[])}function ZA(n,e){let t=n[Ko],r=t?t.get(cr,null):null;r&&r.handleError(e)}function p_(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],u=t[s++],l=e[o],d=n.data[o];jA(d,l,r,a,u,i)}}function W2(n,e,t){let r=WS(e,n);e2(n[St],r,t)}function K2(n,e){let t=wi(e,n),r=t[he];Q2(r,t);let i=t[Ur];i!==null&&t[ac]===null&&(t[ac]=a_(i,t[Ko])),g_(r,t,t[kt])}function Q2(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function g_(n,e,t){Qv(e);try{let r=n.viewQuery;r!==null&&lv(1,r,t);let i=n.template;i!==null&&BA(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Qo]?.finishViewCreation(n),n.staticContentQueries&&YA(n,e),n.staticViewQueries&&lv(2,n.viewQuery,t);let s=n.components;s!==null&&Y2(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[re]&=-5,Yv()}}function Y2(n,e){for(let t=0;t<e.length;t++)K2(n,e[t])}function m_(n,e,t,r){let i=we(null);try{let s=e.tView,a=n[re]&4096?4096:16,u=mf(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];u[lf]=l;let d=n[Qo];return d!==null&&(u[Qo]=d.createEmbeddedView(s)),g_(s,u,t),u}finally{we(i)}}function JA(n,e){let t=Gt+e;if(t<n.length)return n[t]}function fc(n,e){return!e||e.firstChild===null||_A(n)}function _f(n,e,t,r=!0){let i=e[he];if(i2(i,e,n,t),r){let o=uv(t,n),a=e[St],u=l_(a,n[bs]);u!==null&&n2(i,n[Gn],a,e,u,o)}let s=e[ac];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function XA(n,e){let t=hc(n,e);return t!==void 0&&pf(t[he],t),t}function Yh(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(ur(s)),Br(s)&&Z2(s,r);let o=t.type;if(o&8)Yh(n,e,t.child,r);else if(o&32){let a=c_(t,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=kA(e,t);if(Array.isArray(a))r.push(...a);else{let u=dc(e[Hn]);Yh(u[he],u,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function Z2(n,e){for(let t=Gt;t<n.length;t++){let r=n[t],i=r[he].firstChild;i!==null&&Yh(r[he],r,i,e)}n[bs]!==n[Ur]&&e.push(n[bs])}var ex=[];function J2(n){return n[Ds]??X2(n)}function X2(n){let e=ex.pop()??Object.create(tU);return e.lView=n,e}function eU(n){n.lView[Ds]!==n&&(n.lView=null,ex.push(n))}var tU=Ae(q({},s0),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{lc(n.lView)},consumerOnSignalRead(){this.lView[Ds]=this}}),tx=100;function nx(n,e=!0,t=0){let r=n[$n],i=r.rendererFactory,s=!1;s||i.begin?.();try{nU(n,t)}catch(o){throw e&&ZA(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function nU(n,e){dv(n,e);let t=0;for(;zv(n);){if(t===tx)throw new ee(103,!1);t++,dv(n,1)}}function rU(n,e,t,r){let i=e[re];if((i&256)===256)return;let s=!1;!s&&e[$n].inlineEffectRunner?.flush(),Qv(e);let o=null,a=null;!s&&iU(n)&&(a=J2(e),o=o0(a));try{KS(e),uj(n.bindingStartIndex),t!==null&&BA(n,e,t,2,r);let u=(i&3)===3;if(!s)if(u){let f=n.preOrderCheckHooks;f!==null&&kh(e,f,null)}else{let f=n.preOrderHooks;f!==null&&Oh(e,f,0,null),Py(e,0)}if(sU(e),rx(e,0),n.contentQueries!==null&&YA(n,e),!s)if(u){let f=n.contentCheckHooks;f!==null&&kh(e,f)}else{let f=n.contentHooks;f!==null&&Oh(e,f,1),Py(e,1)}w2(n,e);let l=n.components;l!==null&&sx(e,l,0);let d=n.viewQuery;if(d!==null&&lv(2,d,r),!s)if(u){let f=n.viewCheckHooks;f!==null&&kh(e,f)}else{let f=n.viewHooks;f!==null&&Oh(e,f,2),Py(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Ny]){for(let f of e[Ny])f();e[Ny]=null}s||(e[re]&=-73)}catch(u){throw lc(e),u}finally{a!==null&&(a0(a,o),eU(a)),Yv()}}function iU(n){return n.type!==2}function rx(n,e){for(let t=EA(n);t!==null;t=IA(t))for(let r=Gt;r<t.length;r++){let i=t[r];ix(i,e)}}function sU(n){for(let e=EA(n);e!==null;e=IA(e)){if(!(e[re]&$v.HasTransplantedViews))continue;let t=e[Hh];for(let r=0;r<t.length;r++){let i=t[r],s=i[Ft];ZL(i)}}}function oU(n,e,t){let r=wi(e,n);ix(r,t)}function ix(n,e){Gv(n)&&dv(n,e)}function dv(n,e){let r=n[he],i=n[re],s=n[Ds],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&uy(s)),s&&(s.dirty=!1),n[re]&=-9217,o)rU(r,n,r.template,n[kt]);else if(i&8192){rx(n,1);let a=r.components;a!==null&&sx(n,a,1)}}function sx(n,e,t){for(let r=0;r<e.length;r++)oU(n,e[r],t)}function y_(n){for(n[$n].changeDetectionScheduler?.notify();n;){n[re]|=64;let e=dc(n);if($L(n)&&!e)return n;n=e}return null}var Zo=class{get rootNodes(){let e=this._lView,t=e[he];return Yh(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[kt]}set context(e){this._lView[kt]=e}get destroyed(){return(this._lView[re]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Ft];if(Br(e)){let t=e[$h],r=t?t.indexOf(this):-1;r>-1&&(hc(e,r),Uh(t,r))}this._attachedToViewContainer=!1}pf(this._lView[he],this._lView)}onDestroy(e){QS(this._lView,e)}markForCheck(){y_(this._cdRefInjectingView||this._lView)}detach(){this._lView[re]&=-129}reattach(){ev(this._lView),this._lView[re]|=128}detectChanges(){this._lView[re]|=1024,nx(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,RA(this._lView[he],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ee(902,!1);this._appRef=e,ev(this._lView)}};var rZ=new RegExp(`^(\\d+)*(${$j}|${Bj})*(.*)`);var aU=()=>null;function pc(n,e){return aU(n,e)}var Zh=class{},hv=class{},Jh=class{};function uU(n){let e=Error(`No component factory found for ${nn(n)}.`);return e[cU]=n,e}var cU="ngComponent";var fv=class{resolveComponentFactory(e){throw uU(e)}},wf=(()=>{let e=class e{};e.NULL=new fv;let n=e;return n})(),gc=class{},Rs=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>lU();let n=e;return n})();function lU(){let n=He(),e=Sn(),t=wi(e.index,n);return(Is(t)?t:n)[St]}var dU=(()=>{let e=class e{};e.\u0275prov=Y({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Ly={};var X0=new Set;function bc(n){X0.has(n)||(X0.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function eS(...n){}function hU(){let n=typeof Es.requestAnimationFrame=="function",e=Es[n?"requestAnimationFrame":"setTimeout"],t=Es[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var Te=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Pt(!1),this.onMicrotaskEmpty=new Pt(!1),this.onStable=new Pt(!1),this.onError=new Pt(!1),typeof Zone>"u")throw new ee(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=hU().nativeRequestAnimationFrame,gU(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ee(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ee(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,fU,eS,eS);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},fU={};function v_(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function pU(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Es,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,pv(n),n.isCheckStableRunning=!0,v_(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),pv(n))}function gU(n){let e=()=>{pU(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(mU(a))return t.invokeTask(i,s,o,a);try{return tS(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),nS(n)}},onInvoke:(t,r,i,s,o,a,u)=>{try{return tS(n),t.invoke(i,s,o,a,u)}finally{n.shouldCoalesceRunChangeDetection&&e(),nS(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,pv(n),v_(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function pv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function tS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function nS(n){n._nesting--,v_(n)}function mU(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}var Bo=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Bo||{}),yU={destroy(){}};function Ef(n,e){!e&&UL(Ef);let t=e?.injector??H($r);if(!Zj(t))return yU;bc("NgAfterNextRender");let r=t.get(__),i=r.handler??=new mv,s=e?.phase??Bo.MixedReadWrite,o=()=>{i.unregister(u),a()},a=t.get(n_).onDestroy(o),u=jr(t,()=>new gv(s,()=>{o(),n()}));return i.register(u),{destroy:o}}var gv=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=H(Te),this.errorHandler=H(cr,{optional:!0}),H(Zh,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},mv=class{constructor(){this.executingCallbacks=!1,this.buckets={[Bo.EarlyRead]:new Set,[Bo.Write]:new Set,[Bo.MixedReadWrite]:new Set,[Bo.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},__=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=Y({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function yv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=M0(i,a);else if(s==2){let u=a,l=e[++o];r=M0(r,u+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Xh=class extends wf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=mi(e);return new Jo(t,this.ngModule)}};function rS(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function vU(n){let e=n.toLowerCase();return e==="svg"?zL:e==="math"?WL:null}var vv=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=af(r);let i=this.injector.get(e,Ly,r);return i!==Ly||t===Ly?i:this.parentInjector.get(e,t,r)}},Jo=class extends Jh{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=rS(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return rS(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=bL(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=we(null);try{i=i||this.ngModule;let o=i instanceof rn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new vv(e,o):e,u=a.get(gc,null);if(u===null)throw new ee(407,!1);let l=a.get(dU,null),d=a.get(__,null),f=a.get(Zh,null),g={rendererFactory:u,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:f},y=u.createRenderer(null,this.componentDef),_=this.componentDef.selectors[0][0]||"div",D=r?C2(y,r,this.componentDef.encapsulation,a):MA(y,_,vU(_)),S=512;this.componentDef.signals?S|=4096:this.componentDef.onPush||(S|=16);let k=null;D!==null&&(k=a_(D,a,!0));let U=f_(0,null,null,1,0,null,null,null,null,null,null),F=mf(null,U,null,S,null,null,g,y,a,null,k);Qv(F);let W,te;try{let X=this.componentDef,I,v=null;X.findHostDirectiveDefs?(I=[],v=new Map,X.findHostDirectiveDefs(X,I,v),I.push(X)):I=[X];let E=_U(F,D),C=wU(E,D,X,I,F,g,y);te=qv(U,qn),D&&CU(y,X,D,r),t!==void 0&&DU(te,this.ngContentSelectors,t),W=IU(C,X,I,v,F,[bU]),g_(U,F,null)}finally{Yv()}return new _v(this.componentType,W,r_(te,F),F,te)}finally{we(s)}}},_v=class extends hv{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Zo(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;p_(s[he],s,i,e,t),this.previousInputValues.set(e,t);let o=wi(this._tNode.index,s);y_(o)}}get injector(){return new Cs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function _U(n,e){let t=n[he],r=qn;return n[r]=e,yf(t,r,2,"#host",null)}function wU(n,e,t,r,i,s,o){let a=i[he];EU(r,n,e,o);let u=null;e!==null&&(u=a_(e,i[Ko]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let f=mf(i,GA(t),null,d,i[n.index],n,s,l,null,null,u);return a.firstCreatePass&&cv(a,n,r.length-1),vf(i,f),i[n.index]=f}function EU(n,e,t,r){for(let i of n)e.mergedAttrs=sc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(yv(e,e.mergedAttrs,!0),t!==null&&FA(r,t,e))}function IU(n,e,t,r,i,s){let o=Sn(),a=i[he],u=Tn(o,i);WA(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let f=o.directiveStart+d,g=Yo(i,a,f,o);As(g,i)}KA(a,i,o),u&&As(u,i);let l=Yo(i,a,o.directiveStart+o.componentOffset,o);if(n[kt]=i[kt]=l,s!==null)for(let d of s)d(l,e);return $A(a,o,i),l}function CU(n,e,t,r){if(r)Qy(n,t,["ng-version","17.3.10"]);else{let{attrs:i,classes:s}=TL(e.selectors[0]);i&&Qy(n,t,i),s&&s.length>0&&OA(n,t,s.join(" "))}}function DU(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function bU(){let n=Sn();Xv(He()[he],n)}var If=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=TU;let n=e;return n})();function TU(){let n=Sn();return AU(n,He())}var SU=If,ox=class extends SU{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return r_(this._hostTNode,this._hostLView)}get injector(){return new Cs(this._hostTNode,this._hostLView)}get parentInjector(){let e=e_(this._hostTNode,this._hostLView);if(uA(e)){let t=zh(e,this._hostLView),r=Gh(e),i=t[he].data[r+8];return new Cs(i,t)}else return new Cs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=iS(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Gt}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=pc(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,fc(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!BL(e),a;if(o)a=t;else{let _=t||{};a=_.index,r=_.injector,i=_.projectableNodes,s=_.environmentInjector||_.ngModuleRef}let u=o?e:new Jo(mi(e)),l=r||this.parentInjector;if(!s&&u.ngModule==null){let D=(o?l:this.parentInjector).get(rn,null);D&&(s=D)}let d=mi(u.componentType??{}),f=pc(this._lContainer,d?.id??null),g=f?.firstChild??null,y=u.create(l,i,g,s);return this.insertImpl(y.hostView,a,fc(this._hostTNode,f)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(YL(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[Ft],l=new ox(u,u[Gn],u[Ft]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return _f(o,i,s,r),e.attachToViewContainerRef(),CS(jy(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=iS(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=hc(this._lContainer,t);r&&(Uh(jy(this._lContainer),t),pf(r[he],r))}detach(e){let t=this._adjustIndex(e,-1),r=hc(this._lContainer,t);return r&&Uh(jy(this._lContainer),t)!=null?new Zo(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function iS(n){return n[$h]}function jy(n){return n[$h]||(n[$h]=[])}function AU(n,e){let t,r=e[n.index];return Br(r)?t=r:(t=QA(r,e,null,n),e[n.index]=t,vf(e,t)),MU(t,e,n,r),new ox(t,n,e)}function xU(n,e){let t=n[St],r=t.createComment(""),i=Tn(e,n),s=l_(t,i);return Qh(t,s,r,d2(t,i),!1),r}var MU=PU,RU=()=>!1;function NU(n,e,t){return RU(n,e,t)}function PU(n,e,t,r){if(n[bs])return;let i;t.type&8?i=ur(r):i=xU(e,t),n[bs]=i}function kU(n){return Object.getPrototypeOf(n.prototype).constructor}function Ii(n){let e=kU(n.type),t=!0,r=[n];for(;e;){let i;if(yi(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ee(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=Rh(n.inputs),o.inputTransforms=Rh(n.inputTransforms),o.declaredInputs=Rh(n.declaredInputs),o.outputs=Rh(n.outputs);let a=i.hostBindings;a&&jU(n,a);let u=i.viewQuery,l=i.contentQueries;if(u&&VU(n,u),l&&LU(n,l),OU(n,i),WV(n.outputs,i.outputs),yi(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===Ii&&(t=!1)}}e=Object.getPrototypeOf(e)}FU(r)}function OU(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function FU(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=sc(i.hostAttrs,t=sc(t,i.hostAttrs))}}function Rh(n){return n===Go?{}:n===bn?[]:n}function VU(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function LU(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function jU(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function w_(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var vi=class{},mc=class{};var wv=class extends vi{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Xh(this);let i=NS(e);this._bootstrapComponents=xA(i.bootstrap),this._r3Injector=yA(e,t,[{provide:vi,useValue:this},{provide:wf,useValue:this.componentFactoryResolver},...r],nn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Ev=class extends mc{constructor(e){super(),this.moduleType=e}create(e){return new wv(this.moduleType,e,[])}};var ef=class extends vi{constructor(e){super(),this.componentFactoryResolver=new Xh(this),this.instance=null;let t=new oc([...e.providers,{provide:vi,useValue:this},{provide:wf,useValue:this.componentFactoryResolver}],e.parent||Bv(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Cf(n,e,t=null){return new ef({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var Df=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new bt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function ia(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function UU(n){return(n.flags&32)===32}function BU(n,e,t,r,i,s,o,a,u){let l=e.consts,d=yf(e,n,4,o||null,qh(l,a));zA(e,t,d,qh(l,u)),Xv(e,d);let f=d.tView=f_(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}function Xo(n,e,t,r,i,s,o,a){let u=He(),l=zn(),d=n+qn,f=l.firstCreatePass?BU(d,l,u,e,t,r,i,s,o):l.data[d];Ec(f,!1);let g=$U(l,u,f,n);Zv()&&d_(l,u,g,f),As(g,u);let y=QA(g,u,g,f);return u[d]=y,vf(u,y),NU(y,f,u),Hv(f)&&HA(l,u,f),o!=null&&qA(u,f,a),Xo}var $U=HU;function HU(n,e,t,r){return Jv(!0),e[St].createComment("")}function bf(n,e,t,r){let i=He(),s=Ic();if(ia(i,s,e)){let o=zn(),a=sA();B2(a,i,n,e,t,r)}return bf}function qU(n,e,t,r){return ia(n,Ic(),t)?e+of(t)+r:ra}function Nh(n,e){return n<<17|e<<2}function xs(n){return n>>17&32767}function GU(n){return(n&2)==2}function zU(n,e){return n&131071|e<<17}function Iv(n){return n|2}function ea(n){return(n&131068)>>2}function Uy(n,e){return n&-131069|e<<2}function WU(n){return(n&1)===1}function Cv(n){return n|1}function KU(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=xs(o),u=ea(o);n[r]=t;let l=!1,d;if(Array.isArray(t)){let f=t;d=f[1],(d===null||wc(f,d)>0)&&(l=!0)}else d=t;if(i)if(u!==0){let g=xs(n[a+1]);n[r+1]=Nh(g,a),g!==0&&(n[g+1]=Uy(n[g+1],r)),n[a+1]=zU(n[a+1],r)}else n[r+1]=Nh(a,0),a!==0&&(n[a+1]=Uy(n[a+1],r)),a=r;else n[r+1]=Nh(u,0),a===0?a=r:n[u+1]=Uy(n[u+1],r),u=r;l&&(n[r+1]=Iv(n[r+1])),sS(n,d,r,!0),sS(n,d,r,!1),QU(e,d,n,r,s),o=Nh(a,u),s?e.classBindings=o:e.styleBindings=o}function QU(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&wc(s,e)>=0&&(t[r+1]=Cv(t[r+1]))}function sS(n,e,t,r){let i=n[t+1],s=e===null,o=r?xs(i):ea(i),a=!1;for(;o!==0&&(a===!1||s);){let u=n[o],l=n[o+1];YU(u,e)&&(a=!0,n[o+1]=r?Cv(l):Iv(l)),o=r?xs(l):ea(l)}a&&(n[t+1]=r?Iv(i):Cv(i))}function YU(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?wc(n,e)>=0:!1}function E_(n,e,t){let r=He(),i=Ic();if(ia(r,i,e)){let s=zn(),o=sA();x2(s,o,r,n,e,r[St],t,!1)}return E_}function oS(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";p_(n,t,s[o],o,r)}function Tf(n,e){return ZU(n,e,null,!0),Tf}function ZU(n,e,t,r){let i=He(),s=zn(),o=cj(2);if(s.firstUpdatePass&&XU(s,n,o,r),e!==ra&&ia(i,o,e)){let a=s.data[Ms()];iB(s,a,i,i[St],n,i[o+1]=sB(e,t),r,o)}}function JU(n,e){return e>=n.expandoStartIndex}function XU(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[Ms()],o=JU(n,t);oB(s,r)&&e===null&&!o&&(e=!1),e=eB(i,s,e,r),KU(i,s,e,t,o,r)}}function eB(n,e,t,r){let i=fj(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=By(null,n,e,t,r),t=yc(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=By(i,n,e,t,r),s===null){let u=tB(n,e,r);u!==void 0&&Array.isArray(u)&&(u=By(null,n,e,u[1],r),u=yc(u,e.attrs,r),nB(n,e,r,u))}else s=rB(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function tB(n,e,t){let r=t?e.classBindings:e.styleBindings;if(ea(r)!==0)return n[xs(r)]}function nB(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[xs(i)]=r}function rB(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=yc(r,o,t)}return yc(r,e.attrs,t)}function By(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=yc(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function yc(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),fL(n,o,t?!0:e[++s]))}return n===void 0?null:n}function iB(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let u=n.data,l=u[a+1],d=WU(l)?aS(u,e,t,i,ea(l),o):void 0;if(!tf(d)){tf(s)||GU(l)&&(s=aS(u,null,t,i,a,o));let f=WS(Ms(),t);v2(r,o,f,i,s)}}function aS(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let u=n[i],l=Array.isArray(u),d=l?u[1]:u,f=d===null,g=t[i+1];g===ra&&(g=f?bn:void 0);let y=f?My(g,r):d===r?g:void 0;if(l&&!tf(y)&&(y=My(u,r)),tf(y)&&(a=y,o))return a;let _=n[i+1];i=o?xs(_):ea(_)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=My(u,r))}return a}function tf(n){return n!==void 0}function sB(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=nn(Dc(n)))),n}function oB(n,e){return(n.flags&(e?8:16))!==0}var Dv=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),s=this.detach(i);if(i-r>1){let o=this.detach(r);this.attach(r,s),this.attach(i,o)}else this.attach(r,s)}move(e,t){this.attach(t,this.detach(e))}};function $y(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function aB(n,e,t){let r,i,s=0,o=n.length-1;if(Array.isArray(e)){let a=e.length-1;for(;s<=o&&s<=a;){let u=n.at(s),l=e[s],d=$y(s,u,s,l,t);if(d!==0){d<0&&n.updateValue(s,l),s++;continue}let f=n.at(o),g=e[a],y=$y(o,f,a,g,t);if(y!==0){y<0&&n.updateValue(o,g),o--,a--;continue}let _=t(s,u),D=t(o,f),S=t(s,l);if(Object.is(S,D)){let k=t(a,g);Object.is(k,_)?(n.swap(s,o),n.updateValue(o,g),a--,o--):n.move(o,s),n.updateValue(s,l),s++;continue}if(r??=new nf,i??=cS(n,s,o,t),bv(n,r,s,S))n.updateValue(s,l),s++,o++;else if(i.has(S))r.set(_,n.detach(s)),o--;else{let k=n.create(s,e[s]);n.attach(s,k),s++,o++}}for(;s<=a;)uS(n,r,t,s,e[s]),s++}else if(e!=null){let a=e[Symbol.iterator](),u=a.next();for(;!u.done&&s<=o;){let l=n.at(s),d=u.value,f=$y(s,l,s,d,t);if(f!==0)f<0&&n.updateValue(s,d),s++,u=a.next();else{r??=new nf,i??=cS(n,s,o,t);let g=t(s,d);if(bv(n,r,s,g))n.updateValue(s,d),s++,o++,u=a.next();else if(!i.has(g))n.attach(s,n.create(s,d)),s++,o++,u=a.next();else{let y=t(s,l);r.set(y,n.detach(s)),o--}}}for(;!u.done;)uS(n,r,t,n.length,u.value),u=a.next()}for(;s<=o;)n.destroy(n.detach(o--));r?.forEach(a=>{n.destroy(a)})}function bv(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function uS(n,e,t,r,i){if(bv(n,e,r,t(r,i)))n.updateValue(r,i);else{let s=n.create(r,i);n.attach(r,s)}}function cS(n,e,t,r){let i=new Set;for(let s=e;s<=t;s++)i.add(r(s,n.at(s)));return i}var nf=class{constructor(){this.kvMap=new Map,this._vMap=void 0}has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};function Sf(n,e,t){bc("NgControlFlow");let r=He(),i=Ic(),s=xv(r,qn+n),o=0;if(ia(r,i,e)){let a=we(null);try{if(XA(s,o),e!==-1){let u=Mv(r[he],qn+e),l=pc(s,u.tView.ssrId),d=m_(r,u,t,{dehydratedView:l});_f(s,d,o,fc(u,l))}}finally{we(a)}}else{let a=JA(s,o);a!==void 0&&(a[kt]=t)}}var Tv=class{constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-Gt}};function ax(n){return n}var Sv=class{constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function ux(n,e,t,r,i,s,o,a,u,l,d,f,g){bc("NgControlFlow");let y=u!==void 0,_=He(),D=a?o.bind(_[Hn][kt]):o,S=new Sv(y,D);_[qn+n]=S,Xo(n+1,e,t,r,i,s),y&&Xo(n+2,u,l,d,f,g)}var Av=class extends Dv{constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Gt}at(e){return this.getLView(e)[kt].$implicit}attach(e,t){let r=t[ac];this.needsIndexUpdate||=e!==this.length,_f(this.lContainer,t,e,fc(this.templateTNode,r))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,uB(this.lContainer,e)}create(e,t){let r=pc(this.lContainer,this.templateTNode.tView.ssrId);return m_(this.hostLView,this.templateTNode,new Tv(this.lContainer,t,e),{dehydratedView:r})}destroy(e){pf(e[he],e)}updateValue(e,t){this.getLView(e)[kt].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[kt].$index=e}getLView(e){return cB(this.lContainer,e)}};function cx(n){let e=we(null),t=Ms();try{let r=He(),i=r[he],s=r[t];if(s.liveCollection===void 0){let a=t+1,u=xv(r,a),l=Mv(i,a);s.liveCollection=new Av(u,r,l)}else s.liveCollection.reset();let o=s.liveCollection;if(aB(o,n,s.trackByFn),o.updateIndexes(),s.hasEmptyBlock){let a=Ic(),u=o.length===0;if(ia(r,a,u)){let l=t+2,d=xv(r,l);if(u){let f=Mv(i,l),g=pc(d,f.tView.ssrId),y=m_(r,f,void 0,{dehydratedView:g});_f(d,y,0,fc(f,g))}else XA(d,0)}}}finally{we(e)}}function xv(n,e){return n[e]}function uB(n,e){return hc(n,e)}function cB(n,e){return JA(n,e)}function Mv(n,e){return qv(n,e)}function lB(n,e,t,r,i,s){let o=e.consts,a=qh(o,i),u=yf(e,n,2,r,a);return zA(e,t,u,qh(o,s)),u.attrs!==null&&yv(u,u.attrs,!1),u.mergedAttrs!==null&&yv(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function je(n,e,t,r){let i=He(),s=zn(),o=qn+n,a=i[St],u=s.firstCreatePass?lB(o,s,i,e,t,r):s.data[o],l=dB(s,i,u,a,e,n);i[o]=l;let d=Hv(u);return Ec(u,!0),FA(a,l,u),!UU(u)&&Zv()&&d_(s,i,l,u),ej()===0&&As(l,i),tj(),d&&(HA(s,i,u),$A(s,u,i)),r!==null&&qA(i,u),je}function Fe(){let n=Sn();JS()?aj():(n=n.parent,Ec(n,!1));let e=n;ij(e)&&sj(),nj();let t=zn();return t.firstCreatePass&&(Xv(t,n),$S(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&wj(e)&&oS(t,e,He(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&Ej(e)&&oS(t,e,He(),e.stylesWithoutHost,!1),Fe}function dr(n,e,t,r){return je(n,e,t,r),Fe(),dr}var dB=(n,e,t,r,i,s)=>(Jv(!0),MA(r,i,mj()));function lx(){return He()}var rf="en-US";var hB=rf;function fB(n){typeof n=="string"&&(hB=n.toLowerCase().replace(/_/g,"-"))}function Kn(n,e,t,r){let i=He(),s=zn(),o=Sn();return gB(s,i,i[St],o,n,e,r),Kn}function pB(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[uc],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function gB(n,e,t,r,i,s,o){let a=Hv(r),l=n.firstCreatePass&&z2(n),d=e[kt],f=G2(e),g=!0;if(r.type&3||o){let D=Tn(r,e),S=o?o(D):D,k=f.length,U=o?W=>o(ur(W[r.index])):r.index,F=null;if(!o&&a&&(F=pB(n,e,i,r.index)),F!==null){let W=F.__ngLastListenerFn__||F;W.__ngNextListenerFn__=s,F.__ngLastListenerFn__=s,g=!1}else{s=dS(r,e,d,s,!1);let W=t.listen(S,i,s);f.push(s,W),l&&l.push(i,U,k,k+1)}}else s=dS(r,e,d,s,!1);let y=r.outputs,_;if(g&&y!==null&&(_=y[i])){let D=_.length;if(D)for(let S=0;S<D;S+=2){let k=_[S],U=_[S+1],te=e[k][U].subscribe(s),X=f.length;f.push(s,te),l&&l.push(i,r.index,X,-(X+1))}}}function lS(n,e,t,r){let i=we(null);try{return sr(6,e,t),t(r)!==!1}catch(s){return ZA(n,s),!1}finally{sr(7,e,t),we(i)}}function dS(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?wi(n.index,e):e;y_(a);let u=lS(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)u=lS(e,t,l,o)&&u,l=l.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function I_(n=1){return gj(n)}function tt(n,e=""){let t=He(),r=zn(),i=n+qn,s=r.firstCreatePass?yf(r,i,1,e,null):r.data[i],o=mB(r,t,s,e,n);t[i]=o,Zv()&&d_(r,t,o,s),Ec(s,!1)}var mB=(n,e,t,r,i)=>(Jv(!0),Xj(e[St],r));function Af(n){return Tc("",n,""),Af}function Tc(n,e,t){let r=He(),i=qU(r,n,e,t);return i!==ra&&W2(r,Ms(),i),Tc}function yB(n,e,t){let r=zn();if(r.firstCreatePass){let i=yi(n);Rv(t,r.data,r.blueprint,i,!0),Rv(e,r.data,r.blueprint,i,!1)}}function Rv(n,e,t,r,i){if(n=qt(n),Array.isArray(n))for(let s=0;s<n.length;s++)Rv(n[s],e,t,r,i);else{let s=zn(),o=He(),a=Sn(),u=Wo(n)?n:qt(n.provide),l=LS(n),d=a.providerIndexes&1048575,f=a.directiveStart,g=a.providerIndexes>>20;if(Wo(n)||!n.multi){let y=new Ss(l,i,Ee),_=qy(u,e,i?d:d+g,f);_===-1?(rv(Wh(a,o),s,u),Hy(s,n,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(y),o.push(y)):(t[_]=y,o[_]=y)}else{let y=qy(u,e,d+g,f),_=qy(u,e,d,d+g),D=y>=0&&t[y],S=_>=0&&t[_];if(i&&!S||!i&&!D){rv(Wh(a,o),s,u);let k=wB(i?_B:vB,t.length,i,r,l);!i&&S&&(t[_].providerFactory=k),Hy(s,n,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(k),o.push(k)}else{let k=dx(t[i?_:y],l,!i&&r);Hy(s,n,y>-1?y:_,k)}!i&&r&&S&&t[_].componentProviders++}}}function Hy(n,e,t,r){let i=Wo(e),s=PL(e);if(i||s){let u=(s?qt(e.useClass):e).prototype.ngOnDestroy;if(u){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,u]):l[d+1].push(r,u)}else l.push(t,u)}}}function dx(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function qy(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function vB(n,e,t,r){return Nv(this.multi,[])}function _B(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Yo(t,t[he],this.providerFactory.index,r);s=a.slice(0,o),Nv(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],Nv(i,s);return s}function Nv(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function wB(n,e,t,r,i){let s=new Ss(n,t,Ee);return s.multi=[],s.index=e,s.componentProviders=0,dx(s,i,r&&!t),s}function xf(n,e=[]){return t=>{t.providersResolver=(r,i)=>yB(r,i?i(n):n,e)}}var EB=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=OS(!1,r.type),s=i.length>0?Cf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=Y({token:e,providedIn:"environment",factory:()=>new e(V(rn))});let n=e;return n})();function Ci(n){bc("NgStandalone"),n.getStandaloneInjector=e=>e.get(EB).getOrCreateStandaloneInjector(n)}var Lr=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},hx=new Lr("17.3.10"),Mf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var fx=new z("");function Ns(n){return!!n&&typeof n.then=="function"}function px(n){return!!n&&typeof n.subscribe=="function"}var Rf=new z(""),gx=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=H(Rf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Ns(o))r.push(o);else if(px(o)){let a=new Promise((u,l)=>{o.subscribe({complete:u,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Nf=new z("");function IB(){c0(()=>{throw new ee(600,!1)})}function CB(n){return n.isBoundToModule}function DB(n,e,t){try{let r=t();return Ns(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var Sc=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=H(vA),this.afterRenderEffectManager=H(__),this.externalTestViews=new Set,this.beforeRender=new Ze,this.afterTick=new Ze,this.componentTypes=[],this.components=[],this.isStable=H(Df).hasPendingTasks.pipe(Q(r=>!r)),this._injector=H(rn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Jh;if(!this._injector.get(gx).done){let y=!s&&RS(r),_=!1;throw new ee(405,_)}let a;s?a=r:a=this._injector.get(wf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=CB(a)?void 0:this._injector.get(vi),l=i||a.selector,d=a.create($r.NULL,[],l,u),f=d.location.nativeElement,g=d.injector.get(fx,null);return g?.registerApplication(f),d.onDestroy(()=>{this.detachView(d.hostView),Gy(this.components,d),g?.unregisterApplication(f)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new ee(101,!1);let i=we(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,we(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===tx)throw new ee(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:u}of this._views)bB(a,o,u)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Pv(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Pv(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Gy(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(Nf,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Gy(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new ee(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Gy(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function bB(n,e,t){!e&&!Pv(n)||TB(n,t,e)}function Pv(n){return zv(n)}function TB(n,e,t){let r;t?(r=0,n[re]|=1024):n[re]&64?r=0:r=1,nx(n,e,r)}var kv=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Pf=(()=>{let e=class e{compileModuleSync(r){return new Ev(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=NS(r),o=xA(s.declarations).reduce((a,u)=>{let l=mi(u);return l&&a.push(new Jo(l)),a},[]);return new kv(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var SB=(()=>{let e=class e{constructor(){this.zone=H(Te),this.applicationRef=H(Sc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function AB(n){return[{provide:Te,useFactory:n},{provide:zo,multi:!0,useFactory:()=>{let e=H(SB,{optional:!0});return()=>e.initialize()}},{provide:zo,multi:!0,useFactory:()=>{let e=H(NB);return()=>{e.initialize()}}},{provide:vA,useFactory:xB}]}function xB(){let n=H(Te),e=H(cr);return t=>n.runOutsideAngular(()=>e.handleError(t))}function MB(n){let e=AB(()=>new Te(RB(n)));return uf([[],e])}function RB(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var NB=(()=>{let e=class e{constructor(){this.subscription=new et,this.initialized=!1,this.zone=H(Te),this.pendingTasks=H(Df)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Te.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Te.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function PB(){return typeof $localize<"u"&&$localize.locale||rf}var C_=new z("",{providedIn:"root",factory:()=>H(C_,ge.Optional|ge.SkipSelf)||PB()});var mx=new z("");var Vh=null;function kB(n=[],e){return $r.create({name:e,providers:[{provide:cf,useValue:"platform"},{provide:mx,useValue:new Set([()=>Vh=null])},...n]})}function OB(n=[]){if(Vh)return Vh;let e=kB(n);return Vh=e,IB(),FB(e),e}function FB(n){n.get(s_,null)?.forEach(t=>t())}function D_(){return!1}var sa=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=VB;let n=e;return n})();function VB(n){return LB(Sn(),He(),(n&16)===16)}function LB(n,e,t){if(hf(n)&&!t){let r=wi(n.index,e);return new Zo(r,r)}else if(n.type&47){let r=e[Hn];return new Zo(r,e)}return null}function yx(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=OB(r),s=[MB(),...t||[]],a=new ef({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,u=a.get(Te);return u.run(()=>{a.resolveInjectorInitializers();let l=a.get(cr,null),d;u.runOutsideAngular(()=>{d=u.onError.subscribe({next:y=>{l.handleError(y)}})});let f=()=>a.destroy(),g=i.get(mx);return g.add(f),a.onDestroy(()=>{d.unsubscribe(),g.delete(f)}),DB(l,u,()=>{let y=a.get(gx);return y.runInitializers(),y.donePromise.then(()=>{let _=a.get(C_,rf);fB(_||rf);let D=a.get(Sc);return e!==void 0&&D.bootstrap(e),D})})})}catch(e){return Promise.reject(e)}}function oa(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function vx(n){let e=mi(n);if(!e)return null;let t=new Jo(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var Ex=null;function qr(){return Ex}function Ix(n){Ex??=n}var kf=class{};var sn=new z(""),S_=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:()=>H(jB),providedIn:"platform"});let n=e;return n})(),Cx=new z(""),jB=(()=>{let e=class e extends S_{constructor(){super(),this._doc=H(sn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return qr().getBaseHref(this._doc)}onPopState(r){let i=qr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=qr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function A_(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function _x(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Hr(n){return n&&n[0]!=="?"?"?"+n:n}var Gr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:()=>H(x_),providedIn:"root"});let n=e;return n})(),Dx=new z(""),x_=(()=>{let e=class e extends Gr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??H(sn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return A_(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Hr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Hr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Hr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(V(S_),V(Dx,8))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),bx=(()=>{let e=class e extends Gr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=A_(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Hr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Hr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(V(S_),V(Dx,8))},e.\u0275prov=Y({token:e,factory:e.\u0275fac});let n=e;return n})(),aa=(()=>{let e=class e{constructor(r){this._subject=new Pt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=$B(_x(wx(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Hr(i))}normalize(r){return e.stripTrailingSlash(BB(this._basePath,wx(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Hr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Hr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Hr,e.joinWithSlash=A_,e.stripTrailingSlash=_x,e.\u0275fac=function(i){return new(i||e)(V(Gr))},e.\u0275prov=Y({token:e,factory:()=>UB(),providedIn:"root"});let n=e;return n})();function UB(){return new aa(V(Gr))}function BB(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function wx(n){return n.replace(/\/index.html$/,"")}function $B(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function Tx(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var M_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Wt({type:e}),e.\u0275inj=zt({});let n=e;return n})(),R_="browser",HB="server";function qB(n){return n===R_}function Ps(n){return n===HB}var Sx=(()=>{let e=class e{};e.\u0275prov=Y({token:e,providedIn:"root",factory:()=>qB(H(Vt))?new b_(H(sn),window):new T_});let n=e;return n})(),b_=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=GB(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function GB(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var T_=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Of=class{};var k_=class extends kf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},O_=class n extends k_{static makeCurrent(){Ix(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=WB();return t==null?null:KB(t)}resetBaseElement(){Ac=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Tx(document.cookie,e)}},Ac=null;function WB(){return Ac=Ac||document.querySelector("base"),Ac?Ac.getAttribute("href"):null}function KB(n){return new URL(n,document.baseURI).pathname}var QB=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac});let n=e;return n})(),F_=new z(""),Rx=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new ee(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(V(F_),V(Te))},e.\u0275prov=Y({token:e,factory:e.\u0275fac});let n=e;return n})(),Ff=class{constructor(e){this._doc=e}},N_="ng-app-id",Nx=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ps(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${N_}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(N_),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(N_,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(V(sn),V(i_),V(o_,8),V(Vt))},e.\u0275prov=Y({token:e,factory:e.\u0275fac});let n=e;return n})(),P_={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},L_=/%COMP%/g,Px="%COMP%",YB=`_nghost-${Px}`,ZB=`_ngcontent-${Px}`,JB=!0,XB=new z("",{providedIn:"root",factory:()=>JB});function e$(n){return ZB.replace(L_,n)}function t$(n){return YB.replace(L_,n)}function kx(n,e){return e.map(t=>t.replace(L_,n))}var Ax=(()=>{let e=class e{constructor(r,i,s,o,a,u,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=Ps(u),this.defaultRenderer=new xc(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ar.ShadowDom&&(i=Ae(q({},i),{encapsulation:ar.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Vf?s.applyToHost(r):s instanceof Mc&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(i.encapsulation){case ar.Emulated:o=new Vf(l,d,i,this.appId,f,a,u,g);break;case ar.ShadowDom:return new V_(l,d,r,i,a,u,this.nonce,g);default:o=new Mc(l,d,i,f,a,u,g);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(V(Rx),V(Nx),V(i_),V(XB),V(sn),V(Vt),V(Te),V(o_))},e.\u0275prov=Y({token:e,factory:e.\u0275fac});let n=e;return n})(),xc=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(P_[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(xx(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(xx(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ee(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=P_[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=P_[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Vr.DashCase|Vr.Important)?e.style.setProperty(t,r,i&Vr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Vr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=qr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function xx(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var V_=class extends xc{constructor(e,t,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=kx(i.id,i.styles);for(let d of l){let f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=d,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Mc=class extends xc{constructor(e,t,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?kx(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Vf=class extends Mc{constructor(e,t,r,i,s,o,a,u){let l=i+"-"+r.id;super(e,t,r,s,o,a,u,l),this.contentAttr=e$(l),this.hostAttr=t$(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},n$=(()=>{let e=class e extends Ff{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(V(sn))},e.\u0275prov=Y({token:e,factory:e.\u0275fac});let n=e;return n})(),Mx=["alt","control","meta","shift"],r$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},i$={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},s$=(()=>{let e=class e extends Ff{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>qr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),Mx.forEach(d=>{let f=i.indexOf(d);f>-1&&(i.splice(f,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=r$[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Mx.forEach(a=>{if(a!==s){let u=i$[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(V(sn))},e.\u0275prov=Y({token:e,factory:e.\u0275fac});let n=e;return n})();function Ox(n,e){return yx(q({rootComponent:n},o$(e)))}function o$(n){return{appProviders:[...d$,...n?.providers??[]],platformProviders:l$}}function a$(){O_.makeCurrent()}function u$(){return new cr}function c$(){return DA(document),document}var l$=[{provide:Vt,useValue:R_},{provide:s_,useValue:a$,multi:!0},{provide:sn,useFactory:c$,deps:[]}];var d$=[{provide:cf,useValue:"root"},{provide:cr,useFactory:u$,deps:[]},{provide:F_,useClass:n$,multi:!0,deps:[sn,Te,Vt]},{provide:F_,useClass:s$,multi:!0,deps:[sn]},Ax,Nx,Rx,{provide:gc,useExisting:Ax},{provide:Of,useClass:QB,deps:[]},[]];var Fx=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(V(sn))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var le="primary",zc=Symbol("RouteTitle"),H_=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ha(n){return new H_(n)}function f$(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function p$(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!hr(n[t],e[t]))return!1;return!0}function hr(n,e){let t=n?q_(n):void 0,r=e?q_(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Gx(n[i],e[i]))return!1;return!0}function q_(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Gx(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function zx(n){return n.length>0?n[n.length-1]:null}function Si(n){return Iy(n)?n:Ns(n)?be(Promise.resolve(n)):Z(n)}var g$={exact:Kx,subset:Qx},Wx={exact:m$,subset:y$,ignored:()=>!0};function Vx(n,e,t){return g$[t.paths](n.root,e.root,t.matrixParams)&&Wx[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function m$(n,e){return hr(n,e)}function Kx(n,e,t){if(!Os(n.segments,e.segments)||!Uf(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Kx(n.children[r],e.children[r],t))return!1;return!0}function y$(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Gx(n[t],e[t]))}function Qx(n,e,t){return Yx(n,e,e.segments,t)}function Yx(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Os(i,t)||e.hasChildren()||!Uf(i,t,r))}else if(n.segments.length===t.length){if(!Os(n.segments,t)||!Uf(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!Qx(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Os(n.segments,i)||!Uf(n.segments,i,r)||!n.children[le]?!1:Yx(n.children[le],e,s,r)}}function Uf(n,e,t){return e.every((r,i)=>Wx[t](n[i].parameters,r.parameters))}var Di=class{constructor(e=new Re([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ha(this.queryParams),this._queryParamMap}toString(){return w$.serialize(this)}},Re=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Bf(this)}},ks=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ha(this.parameters),this._parameterMap}toString(){return Jx(this)}};function v$(n,e){return Os(n,e)&&n.every((t,r)=>hr(t.parameters,e[r].parameters))}function Os(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function _$(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===le&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==le&&(t=t.concat(e(i,r)))}),t}var Wc=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:()=>new Vc,providedIn:"root"});let n=e;return n})(),Vc=class{parse(e){let t=new z_(e);return new Di(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Rc(e.root,!0)}`,r=C$(e.queryParams),i=typeof e.fragment=="string"?`#${E$(e.fragment)}`:"";return`${t}${r}${i}`}},w$=new Vc;function Bf(n){return n.segments.map(e=>Jx(e)).join("/")}function Rc(n,e){if(!n.hasChildren())return Bf(n);if(e){let t=n.children[le]?Rc(n.children[le],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==le&&r.push(`${i}:${Rc(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=_$(n,(r,i)=>i===le?[Rc(n.children[le],!1)]:[`${i}:${Rc(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[le]!=null?`${Bf(n)}/${t[0]}`:`${Bf(n)}/(${t.join("//")})`}}function Zx(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Lf(n){return Zx(n).replace(/%3B/gi,";")}function E$(n){return encodeURI(n)}function G_(n){return Zx(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function $f(n){return decodeURIComponent(n)}function Lx(n){return $f(n.replace(/\+/g,"%20"))}function Jx(n){return`${G_(n.path)}${I$(n.parameters)}`}function I$(n){return Object.entries(n).map(([e,t])=>`;${G_(e)}=${G_(t)}`).join("")}function C$(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Lf(t)}=${Lf(i)}`).join("&"):`${Lf(t)}=${Lf(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var D$=/^[^\/()?;#]+/;function j_(n){let e=n.match(D$);return e?e[0]:""}var b$=/^[^\/()?;=#]+/;function T$(n){let e=n.match(b$);return e?e[0]:""}var S$=/^[^=?&#]+/;function A$(n){let e=n.match(S$);return e?e[0]:""}var x$=/^[^&#]+/;function M$(n){let e=n.match(x$);return e?e[0]:""}var z_=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Re([],{}):new Re([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[le]=new Re(e,t)),r}parseSegment(){let e=j_(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ee(4009,!1);return this.capture(e),new ks($f(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=T$(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=j_(this.remaining);i&&(r=i,this.capture(r))}e[$f(t)]=$f(r)}parseQueryParam(e){let t=A$(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=M$(this.remaining);o&&(r=o,this.capture(r))}let i=Lx(t),s=Lx(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=j_(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ee(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=le);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[le]:new Re([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ee(4011,!1)}};function Xx(n){return n.segments.length>0?new Re([],{[le]:n}):n}function eM(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=eM(i);if(r===le&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Re(n.segments,e);return R$(t)}function R$(n){if(n.numberOfChildren===1&&n.children[le]){let e=n.children[le];return new Re(n.segments.concat(e.segments),e.children)}return n}function fa(n){return n instanceof Di}function N$(n,e,t=null,r=null){let i=tM(n);return nM(i,e,t,r)}function tM(n){let e;function t(s){let o={};for(let u of s.children){let l=t(u);o[u.outlet]=l}let a=new Re(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=Xx(r);return e??i}function nM(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return U_(i,i,i,t,r);let s=P$(e);if(s.toRoot())return U_(i,i,new Re([],{}),t,r);let o=k$(s,i,n),a=o.processChildren?kc(o.segmentGroup,o.index,s.commands):iM(o.segmentGroup,o.index,s.commands);return U_(i,o.segmentGroup,a,t,r)}function Hf(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Lc(n){return typeof n=="object"&&n!=null&&n.outlets}function U_(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([u,l])=>{s[u]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=rM(n,e,t);let a=Xx(eM(o));return new Di(a,s,i)}function rM(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=rM(s,e,t)}),new Re(n.segments,r)}var qf=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Hf(r[0]))throw new ee(4003,!1);let i=r.find(Lc);if(i&&i!==zx(r))throw new ee(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function P$(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new qf(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,l])=>{a[u]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new qf(t,e,r)}var la=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function k$(n,e,t){if(n.isAbsolute)return new la(e,!0,0);if(!t)return new la(e,!1,NaN);if(t.parent===null)return new la(t,!0,0);let r=Hf(n.commands[0])?0:1,i=t.segments.length-1+r;return O$(t,i,n.numberOfDoubleDots)}function O$(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ee(4005,!1);i=r.segments.length}return new la(r,!1,i-s)}function F$(n){return Lc(n[0])?n[0].outlets:{[le]:n}}function iM(n,e,t){if(n??=new Re([],{}),n.segments.length===0&&n.hasChildren())return kc(n,e,t);let r=V$(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Re(n.segments.slice(0,r.pathIndex),{});return s.children[le]=new Re(n.segments.slice(r.pathIndex),n.children),kc(s,0,i)}else return r.match&&i.length===0?new Re(n.segments,{}):r.match&&!n.hasChildren()?W_(n,e,t):r.match?kc(n,0,i):W_(n,e,t)}function kc(n,e,t){if(t.length===0)return new Re(n.segments,{});{let r=F$(t),i={};if(Object.keys(r).some(s=>s!==le)&&n.children[le]&&n.numberOfChildren===1&&n.children[le].segments.length===0){let s=kc(n.children[le],e,t);return new Re(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=iM(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Re(n.segments,i)}}function V$(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Lc(a))break;let u=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&l&&typeof l=="object"&&l.outlets===void 0){if(!Ux(u,l,o))return s;r+=2}else{if(!Ux(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function W_(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Lc(s)){let u=L$(s.outlets);return new Re(r,u)}if(i===0&&Hf(t[0])){let u=n.segments[e];r.push(new ks(u.path,jx(t[0]))),i++;continue}let o=Lc(s)?s.outlets[le]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Hf(a)?(r.push(new ks(o,jx(a))),i+=2):(r.push(new ks(o,{})),i++)}return new Re(r,{})}function L$(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=W_(new Re([],{}),0,r))}),e}function jx(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Ux(n,e,t){return n==t.path&&hr(e,t.parameters)}var Oc="imperative",vt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(vt||{}),An=class{constructor(e,t){this.id=e,this.url=t}},pa=class extends An{constructor(e,t,r="imperative",i=null){super(e,t),this.type=vt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},fr=class extends An{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=vt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},hn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(hn||{}),Gf=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Gf||{}),bi=class extends An{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=vt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ti=class extends An{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=vt.NavigationSkipped}},jc=class extends An{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=vt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},zf=class extends An{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=vt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},K_=class extends An{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=vt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Q_=class extends An{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=vt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Y_=class extends An{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=vt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Z_=class extends An{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=vt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},J_=class{constructor(e){this.route=e,this.type=vt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},X_=class{constructor(e){this.route=e,this.type=vt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ew=class{constructor(e){this.snapshot=e,this.type=vt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},tw=class{constructor(e){this.snapshot=e,this.type=vt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},nw=class{constructor(e){this.snapshot=e,this.type=vt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},rw=class{constructor(e){this.snapshot=e,this.type=vt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Wf=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=vt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Uc=class{},Bc=class{constructor(e){this.url=e}};var iw=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Kc,this.attachRef=null}},Kc=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new iw,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Kf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=sw(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=sw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=ow(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return ow(e,this._root).map(t=>t.value)}};function sw(n,e){if(n===e.value)return e;for(let t of e.children){let r=sw(n,t);if(r)return r}return null}function ow(n,e){if(n===e.value)return[e];for(let t of e.children){let r=ow(n,t);if(r.length)return r.unshift(e),r}return[]}var dn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ca(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Qf=class extends Kf{constructor(e,t){super(e),this.snapshot=t,mw(this,e)}toString(){return this.snapshot.toString()}};function sM(n){let e=j$(n),t=new bt([new ks("",{})]),r=new bt({}),i=new bt({}),s=new bt({}),o=new bt(""),a=new pr(t,r,s,o,i,le,n,e.root);return a.snapshot=e.root,new Qf(new dn(a,[]),e)}function j$(n){let e={},t={},r={},i="",s=new $c([],e,r,i,t,le,n,null,{});return new Yf("",new dn(s,[]))}var pr=class{constructor(e,t,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Q(l=>l[zc]))??Z(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Q(e=>ha(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Q(e=>ha(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function gw(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:q(q({},e.params),n.params),data:q(q({},e.data),n.data),resolve:q(q(q(q({},n.data),e.data),i?.data),n._resolvedData)}:r={params:q({},n.params),data:q({},n.data),resolve:q(q({},n.data),n._resolvedData??{})},i&&aM(i)&&(r.resolve[zc]=i.title),r}var $c=class{get title(){return this.data?.[zc]}constructor(e,t,r,i,s,o,a,u,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ha(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ha(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Yf=class extends Kf{constructor(e,t){super(t),this.url=e,mw(this,t)}toString(){return oM(this._root)}};function mw(n,e){e.value._routerState=n,e.children.forEach(t=>mw(n,t))}function oM(n){let e=n.children.length>0?` { ${n.children.map(oM).join(", ")} } `:"";return`${n.value}${e}`}function B_(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,hr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),hr(e.params,t.params)||n.paramsSubject.next(t.params),p$(e.url,t.url)||n.urlSubject.next(t.url),hr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function aw(n,e){let t=hr(n.params,e.params)&&v$(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||aw(n.parent,e.parent))}function aM(n){return typeof n.title=="string"||n.title===null}var yw=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=le,this.activateEvents=new Pt,this.deactivateEvents=new Pt,this.attachEvents=new Pt,this.detachEvents=new Pt,this.parentContexts=H(Kc),this.location=H(If),this.changeDetector=H(sa),this.environmentInjector=H(rn),this.inputBinder=H(ep,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ee(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ee(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ee(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new ee(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,l=new uw(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=cn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[lr]});let n=e;return n})(),uw=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===pr?this.route:e===Kc?this.childContexts:this.parent.get(e,t)}},ep=new z(""),Bx=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Ju([i.queryParams,i.params,i.data]).pipe(Ge(([o,a,u],l)=>(u=q(q(q({},o),a),u),l===0?Z(u):Promise.resolve(u)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=vx(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:u}of a.inputs)r.activatedComponentRef.setInput(u,o[u])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac});let n=e;return n})();function U$(n,e,t){let r=Hc(n,e._root,t?t._root:void 0);return new Qf(r,e)}function Hc(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=B$(n,e,t);return new dn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Hc(n,a)),o}}let r=$$(e.value),i=e.children.map(s=>Hc(n,s));return new dn(r,i)}}function B$(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Hc(n,r,i);return Hc(n,r)})}function $$(n){return new pr(new bt(n.url),new bt(n.params),new bt(n.queryParams),new bt(n.fragment),new bt(n.data),n.outlet,n.component,n)}var uM="ngNavigationCancelingError";function cM(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=fa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=lM(!1,hn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function lM(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[uM]=!0,t.cancellationCode=e,t}function H$(n){return dM(n)&&fa(n.url)}function dM(n){return!!n&&n[uM]}var q$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=_i({type:e,selectors:[["ng-component"]],standalone:!0,features:[Ci],decls:1,vars:0,template:function(i,s){i&1&&dr(0,"router-outlet")},dependencies:[yw],encapsulation:2});let n=e;return n})();function G$(n,e){return n.providers&&!n._injector&&(n._injector=Cf(n.providers,e,`Route: ${n.path}`)),n._injector??e}function vw(n){let e=n.children&&n.children.map(vw),t=e?Ae(q({},n),{children:e}):q({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==le&&(t.component=q$),t}function gr(n){return n.outlet||le}function z$(n,e){let t=n.filter(r=>gr(r)===e);return t.push(...n.filter(r=>gr(r)!==e)),t}function Qc(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var W$=(n,e,t,r)=>Q(i=>(new cw(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),cw=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),B_(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=ca(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ca(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ca(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=ca(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new rw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new tw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(B_(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),B_(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Qc(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Zf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},da=class{constructor(e,t){this.component=e,this.route=t}};function K$(n,e,t){let r=n._root,i=e?e._root:null;return Nc(r,i,t,[r.value])}function Q$(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function ma(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!gS(n)?n:e.get(n):r}function Nc(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=ca(e);return n.children.forEach(o=>{Y$(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Fc(a,t.getContext(o),i)),i}function Y$(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=Z$(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Zf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Nc(n,e,a?a.children:null,r,i):Nc(n,e,t,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new da(a.outlet.component,o))}else o&&Fc(e,a,i),i.canActivateChecks.push(new Zf(r)),s.component?Nc(n,null,a?a.children:null,r,i):Nc(n,null,t,r,i);return i}function Z$(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Os(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Os(n.url,e.url)||!hr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!aw(n,e)||!hr(n.queryParams,e.queryParams);case"paramsChange":default:return!aw(n,e)}}function Fc(n,e,t){let r=ca(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Fc(o,e.children.getContext(s),t):Fc(o,null,t):Fc(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new da(e.outlet.component,i)):t.canDeactivateChecks.push(new da(null,i)):t.canDeactivateChecks.push(new da(null,i))}function Yc(n){return typeof n=="function"}function J$(n){return typeof n=="boolean"}function X$(n){return n&&Yc(n.canLoad)}function eH(n){return n&&Yc(n.canActivate)}function tH(n){return n&&Yc(n.canActivateChild)}function nH(n){return n&&Yc(n.canDeactivate)}function rH(n){return n&&Yc(n.canMatch)}function hM(n){return n instanceof Or||n?.name==="EmptyError"}var jf=Symbol("INITIAL_VALUE");function ga(){return Ge(n=>Ju(n.map(e=>e.pipe(Fr(1),ws(jf)))).pipe(Q(e=>{for(let t of e)if(t!==!0){if(t===jf)return jf;if(t===!1||t instanceof Di)return t}return!0}),Tt(e=>e!==jf),Fr(1)))}function iH(n,e){return at(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?Z(Ae(q({},t),{guardsResult:!0})):sH(o,r,i,n).pipe(at(a=>a&&J$(a)?oH(r,s,n,e):Z(a)),Q(a=>Ae(q({},t),{guardsResult:a})))})}function sH(n,e,t,r){return be(n).pipe(at(i=>dH(i.component,i.route,t,e,r)),Cn(i=>i!==!0,!0))}function oH(n,e,t,r){return be(e).pipe(_s(i=>Oo(uH(i.route.parent,r),aH(i.route,r),lH(n,i.path,t),cH(n,i.route,t))),Cn(i=>i!==!0,!0))}function aH(n,e){return n!==null&&e&&e(new nw(n)),Z(!0)}function uH(n,e){return n!==null&&e&&e(new ew(n)),Z(!0)}function cH(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Z(!0);let i=r.map(s=>bh(()=>{let o=Qc(e)??t,a=ma(s,o),u=eH(a)?a.canActivate(e,n):jr(o,()=>a(e,n));return Si(u).pipe(Cn())}));return Z(i).pipe(ga())}function lH(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>Q$(o)).filter(o=>o!==null).map(o=>bh(()=>{let a=o.guards.map(u=>{let l=Qc(o.node)??t,d=ma(u,l),f=tH(d)?d.canActivateChild(r,n):jr(l,()=>d(r,n));return Si(f).pipe(Cn())});return Z(a).pipe(ga())}));return Z(s).pipe(ga())}function dH(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return Z(!0);let o=s.map(a=>{let u=Qc(e)??i,l=ma(a,u),d=nH(l)?l.canDeactivate(n,e,t,r):jr(u,()=>l(n,e,t,r));return Si(d).pipe(Cn())});return Z(o).pipe(ga())}function hH(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return Z(!0);let s=i.map(o=>{let a=ma(o,n),u=X$(a)?a.canLoad(e,t):jr(n,()=>a(e,t));return Si(u)});return Z(s).pipe(ga(),fM(r))}function fM(n){return my(pt(e=>{if(fa(e))throw cM(n,e)}),Q(e=>e===!0))}function fH(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return Z(!0);let s=i.map(o=>{let a=ma(o,n),u=rH(a)?a.canMatch(e,t):jr(n,()=>a(e,t));return Si(u)});return Z(s).pipe(ga(),fM(r))}var qc=class{constructor(e){this.segmentGroup=e||null}},Jf=class extends Error{constructor(e){super(),this.urlTree=e}};function ua(n){return ko(new qc(n))}function pH(n){return ko(new ee(4e3,!1))}function gH(n){return ko(lM(!1,hn.GuardRejected))}var lw=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Z(r);if(i.numberOfChildren>1||!i.children[le])return pH(e.redirectTo);i=i.children[le]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Jf(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Di(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new Re(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ee(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},dw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function mH(n,e,t,r,i){let s=_w(n,e,t);return s.matched?(r=G$(e,r),fH(r,e,t,i).pipe(Q(o=>o===!0?s:q({},dw)))):Z(s)}function _w(n,e,t){if(e.path==="**")return yH(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?q({},dw):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||f$)(t,n,e);if(!i)return q({},dw);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?q(q({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function yH(n){return{matched:!0,parameters:n.length>0?zx(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function $x(n,e,t,r){return t.length>0&&wH(n,t,r)?{segmentGroup:new Re(e,_H(r,new Re(t,n.children))),slicedSegments:[]}:t.length===0&&EH(n,t,r)?{segmentGroup:new Re(n.segments,vH(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Re(n.segments,n.children),slicedSegments:t}}function vH(n,e,t,r){let i={};for(let s of t)if(tp(n,e,s)&&!r[gr(s)]){let o=new Re([],{});i[gr(s)]=o}return q(q({},r),i)}function _H(n,e){let t={};t[le]=e;for(let r of n)if(r.path===""&&gr(r)!==le){let i=new Re([],{});t[gr(r)]=i}return t}function wH(n,e,t){return t.some(r=>tp(n,e,r)&&gr(r)!==le)}function EH(n,e,t){return t.some(r=>tp(n,e,r))}function tp(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function IH(n,e,t,r){return gr(n)!==r&&(r===le||!tp(e,t,n))?!1:_w(e,n,t).matched}function CH(n,e,t){return e.length===0&&!n.children[t]}var hw=class{};function DH(n,e,t,r,i,s,o="emptyOnly"){return new fw(n,e,t,r,i,o,s).recognize()}var bH=31,fw=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new lw(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ee(4002,`'${e.segmentGroup}'`)}recognize(){let e=$x(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Q(t=>{let r=new $c([],Object.freeze({}),Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,{},le,this.rootComponentType,null,{}),i=new dn(r,t),s=new Yf("",i),o=N$(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,le).pipe(hi(r=>{if(r instanceof Jf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof qc?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=gw(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Q(s=>s instanceof dn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return be(i).pipe(_s(s=>{let o=r.children[s],a=z$(t,s);return this.processSegmentGroup(e,a,o,s)}),ir((s,o)=>(s.push(...o),s)),fi(null),by(),at(s=>{if(s===null)return ua(r);let o=pM(s);return TH(o),Z(o)}))}processSegment(e,t,r,i,s,o){return be(t).pipe(_s(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(hi(u=>{if(u instanceof qc)return Z(null);throw u}))),Cn(a=>!!a),hi(a=>{if(hM(a))return CH(r,i,s)?Z(new hw):ua(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return IH(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):ua(i):ua(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:l,remainingSegments:d}=_w(t,i,s);if(!a)return ua(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>bH&&(this.allowRedirects=!1));let f=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,f).pipe(at(g=>this.processSegment(e,r,t,g.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=mH(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(Ge(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ge(({routes:u})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:f,parameters:g}=a,y=new $c(d,g,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,AH(r),gr(r),r.component??r._loadedComponent??null,r,xH(r)),{segmentGroup:_,slicedSegments:D}=$x(t,d,f,u);if(D.length===0&&_.hasChildren())return this.processChildren(l,u,_).pipe(Q(k=>k===null?null:new dn(y,k)));if(u.length===0&&D.length===0)return Z(new dn(y,[]));let S=gr(r)===s;return this.processSegment(l,u,_,D,S?le:s,!0).pipe(Q(k=>new dn(y,k instanceof dn?[k]:[])))}))):ua(t)))}getChildConfig(e,t,r){return t.children?Z({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Z({routes:t._loadedRoutes,injector:t._loadedInjector}):hH(e,t,r,this.urlSerializer).pipe(at(i=>i?this.configLoader.loadChildren(e,t).pipe(pt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):gH(t))):Z({routes:[],injector:e})}};function TH(n){n.sort((e,t)=>e.value.outlet===le?-1:t.value.outlet===le?1:e.value.outlet.localeCompare(t.value.outlet))}function SH(n){let e=n.value.routeConfig;return e&&e.path===""}function pM(n){let e=[],t=new Set;for(let r of n){if(!SH(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=pM(r.children);e.push(new dn(r.value,i))}return e.filter(r=>!t.has(r))}function AH(n){return n.data||{}}function xH(n){return n.resolve||{}}function MH(n,e,t,r,i,s){return at(o=>DH(n,e,t,r,o.extractedUrl,i,s).pipe(Q(({state:a,tree:u})=>Ae(q({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function RH(n,e){return at(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Z(t);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let l of gM(u))o.add(l);let a=0;return be(o).pipe(_s(u=>s.has(u)?NH(u,r,n,e):(u.data=gw(u,u.parent,n).resolve,Z(void 0))),pt(()=>a++),Vo(1),at(u=>a===o.size?Z(t):Ht))})}function gM(n){let e=n.children.map(t=>gM(t)).flat();return[n,...e]}function NH(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!aM(i)&&(s[zc]=i.title),PH(s,n,e,r).pipe(Q(o=>(n._resolvedData=o,n.data=gw(n,n.parent,t).resolve,null)))}function PH(n,e,t,r){let i=q_(n);if(i.length===0)return Z({});let s={};return be(i).pipe(at(o=>kH(n[o],e,t,r).pipe(Cn(),pt(a=>{s[o]=a}))),Vo(1),Dy(s),hi(o=>hM(o)?Ht:ko(o)))}function kH(n,e,t,r){let i=Qc(e)??r,s=ma(n,i),o=s.resolve?s.resolve(e,t):jr(i,()=>s(e,t));return Si(o)}function $_(n){return Ge(e=>{let t=n(e);return t?be(t).pipe(Q(()=>e)):Z(e)})}var mM=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===le);return i}getResolvedTitleForRoute(r){return r.data[zc]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:()=>H(OH),providedIn:"root"});let n=e;return n})(),OH=(()=>{let e=class e extends mM{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(V(Fx))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Zc=new z("",{providedIn:"root",factory:()=>({})}),Gc=new z(""),ww=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=H(Pf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Z(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Si(r.loadComponent()).pipe(Q(yM),pt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),ec(()=>{this.componentLoaders.delete(r)})),s=new xo(i,()=>new Ze).pipe(Ao());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Z({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=FH(i,this.compiler,r,this.onLoadEndListener).pipe(ec(()=>{this.childrenLoaders.delete(i)})),a=new xo(o,()=>new Ze).pipe(Ao());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function FH(n,e,t,r){return Si(n.loadChildren()).pipe(Q(yM),at(i=>i instanceof mc||Array.isArray(i)?Z(i):be(e.compileModuleAsync(i))),Q(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(Gc,[],{optional:!0,self:!0}).flat()),{routes:o.map(vw),injector:s}}))}function VH(n){return n&&typeof n=="object"&&"default"in n}function yM(n){return VH(n)?n.default:n}var Ew=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:()=>H(LH),providedIn:"root"});let n=e;return n})(),LH=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),vM=new z(""),_M=new z("");function jH(n,e,t){let r=n.get(_M),i=n.get(sn);return n.get(Te).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),UH(n))),{onViewTransitionCreated:u}=r;return u&&jr(n,()=>u({transition:a,from:e,to:t})),o})}function UH(n){return new Promise(e=>{Ef(e,{injector:n})})}var Iw=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ze,this.transitionAbortSubject=new Ze,this.configLoader=H(ww),this.environmentInjector=H(rn),this.urlSerializer=H(Wc),this.rootContexts=H(Kc),this.location=H(aa),this.inputBindingEnabled=H(ep,{optional:!0})!==null,this.titleStrategy=H(mM),this.options=H(Zc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=H(Ew),this.createViewTransition=H(vM,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Z(void 0),this.rootComponentType=null;let r=s=>this.events.next(new J_(s)),i=s=>this.events.next(new X_(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Ae(q(q({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new bt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Oc,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Tt(o=>o.id!==0),Q(o=>Ae(q({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ge(o=>{let a=!1,u=!1;return Z(o).pipe(Ge(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",hn.SupersededByNewNavigation),Ht;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Ae(q({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&f!=="reload"){let g="";return this.events.next(new Ti(l.id,this.urlSerializer.serialize(l.rawUrl),g,Gf.IgnoredSameUrlNavigation)),l.resolve(null),Ht}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Z(l).pipe(Ge(g=>{let y=this.transitions?.getValue();return this.events.next(new pa(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),y!==this.transitions?.getValue()?Ht:Promise.resolve(g)}),MH(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),pt(g=>{o.targetSnapshot=g.targetSnapshot,o.urlAfterRedirects=g.urlAfterRedirects,this.currentNavigation=Ae(q({},this.currentNavigation),{finalUrl:g.urlAfterRedirects});let y=new zf(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(y)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:g,extractedUrl:y,source:_,restoredState:D,extras:S}=l,k=new pa(g,this.urlSerializer.serialize(y),_,D);this.events.next(k);let U=sM(this.rootComponentType).snapshot;return this.currentTransition=o=Ae(q({},l),{targetSnapshot:U,urlAfterRedirects:y,extras:Ae(q({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=y,Z(o)}else{let g="";return this.events.next(new Ti(l.id,this.urlSerializer.serialize(l.extractedUrl),g,Gf.IgnoredByUrlHandlingStrategy)),l.resolve(null),Ht}}),pt(l=>{let d=new K_(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Q(l=>(this.currentTransition=o=Ae(q({},l),{guards:K$(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),iH(this.environmentInjector,l=>this.events.next(l)),pt(l=>{if(o.guardsResult=l.guardsResult,fa(l.guardsResult))throw cM(this.urlSerializer,l.guardsResult);let d=new Q_(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),Tt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",hn.GuardRejected),!1)),$_(l=>{if(l.guards.canActivateChecks.length)return Z(l).pipe(pt(d=>{let f=new Y_(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}),Ge(d=>{let f=!1;return Z(d).pipe(RH(this.paramsInheritanceStrategy,this.environmentInjector),pt({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(d,"",hn.NoDataFromResolver)}}))}),pt(d=>{let f=new Z_(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}))}),$_(l=>{let d=f=>{let g=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(f.routeConfig).pipe(pt(y=>{f.component=y}),Q(()=>{})));for(let y of f.children)g.push(...d(y));return g};return Ju(d(l.targetSnapshot.root)).pipe(fi(null),Fr(1))}),$_(()=>this.afterPreactivation()),Ge(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,f=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return f?be(f).pipe(Q(()=>o)):Z(o)}),Q(l=>{let d=U$(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=Ae(q({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),pt(()=>{this.events.next(new Uc)}),W$(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Fr(1),pt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new fr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Ay(this.transitionAbortSubject.pipe(pt(l=>{throw l}))),ec(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",hn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),hi(l=>{if(u=!0,dM(l))this.events.next(new bi(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),H$(l)?this.events.next(new Bc(l.url)):o.resolve(!1);else{this.events.next(new jc(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Ht}))}))}cancelNavigationTransition(r,i,s){let o=new bi(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function BH(n){return n!==Oc}var $H=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:()=>H(HH),providedIn:"root"});let n=e;return n})(),pw=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},HH=(()=>{let e=class e extends pw{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Cc(e)))(s||e)}})(),e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),wM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:()=>H(qH),providedIn:"root"});let n=e;return n})(),qH=(()=>{let e=class e extends wM{constructor(){super(...arguments),this.location=H(aa),this.urlSerializer=H(Wc),this.options=H(Zc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=H(Ew),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Di,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=sM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof pa)this.stateMemento=this.createStateMemento();else if(r instanceof Ti)this.rawUrlTree=i.initialUrl;else if(r instanceof zf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Uc?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof bi&&(r.code===hn.GuardRejected||r.code===hn.NoDataFromResolver)?this.restoreHistory(i):r instanceof jc?this.restoreHistory(i,!0):r instanceof fr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=q(q({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=q(q({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Cc(e)))(s||e)}})(),e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Pc=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Pc||{});function EM(n,e){n.events.pipe(Tt(t=>t instanceof fr||t instanceof bi||t instanceof jc||t instanceof Ti),Q(t=>t instanceof fr||t instanceof Ti?Pc.COMPLETE:(t instanceof bi?t.code===hn.Redirect||t.code===hn.SupersededByNewNavigation:!1)?Pc.REDIRECTING:Pc.FAILED),Tt(t=>t!==Pc.REDIRECTING),Fr(1)).subscribe(()=>{e()})}function GH(n){throw n}var zH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},WH={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},fn=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=H(Mf),this.stateManager=H(wM),this.options=H(Zc,{optional:!0})||{},this.pendingTasks=H(Df),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=H(Iw),this.urlSerializer=H(Wc),this.location=H(aa),this.urlHandlingStrategy=H(Ew),this._events=new Ze,this.errorHandler=this.options.errorHandler||GH,this.navigated=!1,this.routeReuseStrategy=H($H),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=H(Gc,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!H(ep,{optional:!0}),this.eventsSubscription=new et,this.isNgZoneEnabled=H(Te)instanceof Te&&Te.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof bi&&i.code!==hn.Redirect&&i.code!==hn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof fr)this.navigated=!0;else if(i instanceof Bc){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||BH(s.source)};this.scheduleNavigation(a,Oc,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}QH(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Oc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=q({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(vw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,f=null;switch(u){case"merge":f=q(q({},this.currentUrlTree.queryParams),o);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=o||null}f!==null&&(f=this.removeEmptyProps(f));let g;try{let y=s?s.snapshot:this.routerState.snapshot.root;g=tM(y)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),g=this.currentUrlTree.root}return nM(g,r,f,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=fa(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Oc,null,i)}navigate(r,i={skipLocationChange:!1}){return KH(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=q({},zH):i===!1?s=q({},WH):s=i,fa(r))return Vx(this.currentUrlTree,r,s);let o=this.parseUrl(r);return Vx(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,l,d;a?(u=a.resolve,l=a.reject,d=a.promise):d=new Promise((g,y)=>{u=g,l=y});let f=this.pendingTasks.add();return EM(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(g=>Promise.reject(g))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function KH(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ee(4008,!1)}function QH(n){return!(n instanceof Uc)&&!(n instanceof Bc)}var IM=(()=>{let e=class e{constructor(r,i,s,o,a,u){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=u,this.href=null,this.commands=null,this.onChanges=new Ze,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof fr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let u=this.urlTree;if(u===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:SA(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(Ee(fn),Ee(pr),t_("tabindex"),Ee(Rs),Ee(Ei),Ee(Gr))},e.\u0275dir=cn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Kn("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&bf("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Ot.HasDecoratorInputTransform,"preserveFragment","preserveFragment",oa],skipLocationChange:[Ot.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",oa],replaceUrl:[Ot.HasDecoratorInputTransform,"replaceUrl","replaceUrl",oa],routerLink:"routerLink"},standalone:!0,features:[w_,lr]});let n=e;return n})();var Xf=class{};var YH=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Tt(r=>r instanceof fr),_s(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Cf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(u,o.children??o._loadedRoutes))}return be(s).pipe(di())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=Z(null);let o=s.pipe(at(a=>a===null?Z(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return be([o,a]).pipe(di())}else return o})}};e.\u0275fac=function(i){return new(i||e)(V(fn),V(Pf),V(rn),V(Xf),V(ww))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),CM=new z(""),ZH=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=H(rn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof pa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof fr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Ti&&r.code===Gf.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Wf&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>N(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),Ef(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Wf(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){LA()},e.\u0275prov=Y({token:e,factory:e.\u0275fac});let n=e;return n})();function DM(n,...e){return uf([{provide:Gc,multi:!0,useValue:n},[],{provide:pr,useFactory:bM,deps:[fn]},{provide:Nf,multi:!0,useFactory:TM},e.map(t=>t.\u0275providers)])}function bM(n){return n.routerState.root}function Jc(n,e){return{\u0275kind:n,\u0275providers:e}}function TM(){let n=H($r);return e=>{let t=n.get(Sc);if(e!==t.components[0])return;let r=n.get(fn),i=n.get(SM);n.get(Cw)===1&&r.initialNavigation(),n.get(AM,null,ge.Optional)?.setUpPreloading(),n.get(CM,null,ge.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var SM=new z("",{factory:()=>new Ze}),Cw=new z("",{providedIn:"root",factory:()=>1});function JH(){return Jc(2,[{provide:Cw,useValue:0},{provide:Rf,multi:!0,deps:[$r],useFactory:e=>{let t=e.get(Cx,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(fn),s=e.get(SM);EM(i,()=>{r(!0)}),e.get(Iw).afterPreactivation=()=>(r(!0),s.closed?Z(void 0):s),i.initialNavigation()}))}}])}function XH(){return Jc(3,[{provide:Rf,multi:!0,useFactory:()=>{let e=H(fn);return()=>{e.setUpLocationChangeListener()}}},{provide:Cw,useValue:2}])}var AM=new z("");function eq(n){return Jc(0,[{provide:AM,useExisting:YH},{provide:Xf,useExisting:n}])}function tq(){return Jc(8,[Bx,{provide:ep,useExisting:Bx}])}function nq(n){let e=[{provide:vM,useValue:jH},{provide:_M,useValue:q({skipNextTransition:!!n?.skipInitialTransition},n)}];return Jc(9,e)}var Hx=new z("ROUTER_FORROOT_GUARD"),rq=[aa,{provide:Wc,useClass:Vc},fn,Kc,{provide:pr,useFactory:bM,deps:[fn]},ww,[]],xM=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[rq,[],{provide:Gc,multi:!0,useValue:r},{provide:Hx,useFactory:aq,deps:[[fn,new _c,new IS]]},{provide:Zc,useValue:i||{}},i?.useHash?sq():oq(),iq(),i?.preloadingStrategy?eq(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?uq(i):[],i?.bindToComponentInputs?tq().\u0275providers:[],i?.enableViewTransitions?nq().\u0275providers:[],cq()]}}static forChild(r){return{ngModule:e,providers:[{provide:Gc,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(V(Hx,8))},e.\u0275mod=Wt({type:e}),e.\u0275inj=zt({});let n=e;return n})();function iq(){return{provide:CM,useFactory:()=>{let n=H(Sx),e=H(Te),t=H(Zc),r=H(Iw),i=H(Wc);return t.scrollOffset&&n.setOffset(t.scrollOffset),new ZH(i,r,n,e,t)}}}function sq(){return{provide:Gr,useClass:bx}}function oq(){return{provide:Gr,useClass:x_}}function aq(n){return"guarded"}function uq(n){return[n.initialNavigation==="disabled"?XH().\u0275providers:[],n.initialNavigation==="enabledBlocking"?JH().\u0275providers:[]]}var qx=new z("");function cq(){return[{provide:qx,useFactory:TM},{provide:Nf,multi:!0,useExisting:qx}]}var lq="firebase",dq="10.12.2";Vn(lq,dq,"app");var Ai=new Lr("ANGULARFIRE2_VERSION");var hq=(n,e)=>{let t=e?[e]:n0(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},zr=class{constructor(){return hq(fq)}},fq="app-check";function Dw(){}var np=class{zone;delegate;constructor(e,t=wy){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},bw=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Dw,{},Dw,Dw)),t.pipe(pt({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ya=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new np(Zone.current)),this.insideAngular=t.run(()=>new np(Zone.current,vs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(V(Te))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pq(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function nt(n){return gq(pq())(n)}function gq(n){return function(t){return t=t.lift(new bw(n.ngZone)),t.pipe(jn(n.outsideAngular),In(n.insideAngular))}}var mq=new Map,yq={activated:!1,tokenObservers:[]},vq={initialized:!1,enabled:!1};function Qn(n){return mq.get(n)||Object.assign({},yq)}function VM(){return vq}var _q="https://content-firebaseappcheck.googleapis.com/v1";var wq="exchangeDebugToken",RM={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},jJ=24*60*60*1e3;var Aw=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return N(this,null,function*(){this.stop();try{this.pending=new mt,this.pending.promise.catch(t=>{}),yield Eq(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new mt,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function Eq(n){return new Promise(e=>{setTimeout(e,n)})}var Iq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},xi=new YT("appCheck","AppCheck",Iq);function LM(n){if(!Qn(n).activated)throw xi.create("use-before-activation",{appName:n.name})}function jM(r,i){return N(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let y=yield o.getHeartbeatsHeader();y&&(s["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(n,a)}catch(y){throw xi.create("fetch-network-error",{originalErrorMessage:y?.message})}if(u.status!==200)throw xi.create("fetch-status-error",{httpStatus:u.status});let l;try{l=yield u.json()}catch(y){throw xi.create("fetch-parse-error",{originalErrorMessage:y?.message})}let d=l.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw xi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let f=Number(d[1])*1e3,g=Date.now();return{token:l.token,expireTimeMillis:g+f,issuedAtTimeMillis:g}})}function UM(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${_q}/projects/${t}/apps/${r}:${wq}?key=${i}`,body:{debug_token:e}}}var Cq="firebase-app-check-database",Dq=1,xw="firebase-app-check-store";var rp=null;function bq(){return rp||(rp=new Promise((n,e)=>{try{let t=indexedDB.open(Cq,Dq);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(xi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(xw,{keyPath:"compositeKey"})}}}catch(t){e(xi.create("storage-open",{originalErrorMessage:t?.message}))}}),rp)}function Tq(n,e){return Sq(Aq(n),e)}function Sq(n,e){return N(this,null,function*(){let r=(yield bq()).transaction(xw,"readwrite"),s=r.objectStore(xw).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var l;a(xi.create("storage-set",{originalErrorMessage:(l=u.target.error)===null||l===void 0?void 0:l.message}))}})})}function Aq(n){return`${n.options.appId}-${n.name}`}var Mw=new li("@firebase/app-check");function Sw(n,e){return Zd()?Tq(n,e).catch(t=>{Mw.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function BM(){return VM().enabled}function $M(){return N(this,null,function*(){let n=VM();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var xq={error:"UNKNOWN_ERROR"};function Mq(n){return Qd.encodeString(JSON.stringify(n),!1)}function Rw(n,e=!1){return N(this,null,function*(){let t=n.app;LM(t);let r=Qn(t),i=r.token,s;if(i&&!Xc(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(Xc(u)?i=u:yield Sw(t,void 0))}if(!e&&i&&Xc(i))return{token:i.token};let o=!1;if(BM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=jM(UM(t,yield $M()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield Sw(t,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Qn(t).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?Mw.warn(u.message):Mw.error(u),s=u}let a;return i?s?Xc(i)?a={token:i.token,internalError:s}:a=PM(s):(a={token:i.token},r.token=i,yield Sw(t,i)):a=PM(s),o&&kq(t,a),a})}function Rq(n){return N(this,null,function*(){let e=n.app;LM(e);let{provider:t}=Qn(e);if(BM()){let r=yield $M(),{token:i}=yield jM(UM(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function Nq(n,e,t,r){let{app:i}=n,s=Qn(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Xc(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),NM(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>NM(n))}function HM(n,e){let t=Qn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function NM(n){let{app:e}=n,t=Qn(e),r=t.tokenRefresher;r||(r=Pq(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Pq(n){let{app:e}=n;return new Aw(()=>N(this,null,function*(){let t=Qn(e),r;if(t.token?r=yield Rw(n,!0):r=yield Rw(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Qn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},RM.RETRIAL_MIN_WAIT,RM.RETRIAL_MAX_WAIT)}function kq(n,e){let t=Qn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Xc(n){return n.expireTimeMillis-Date.now()>0}function PM(n){return{token:Mq(xq),error:n}}var Nw=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Qn(this.app);for(let t of e)HM(this.app,t.next);return Promise.resolve()}};function Oq(n,e){return new Nw(n,e)}function Fq(n){return{getToken:e=>Rw(n,e),getLimitedUseToken:()=>Rq(n),addTokenListener:e=>Nq(n,"INTERNAL",e),removeTokenListener:e=>HM(n.app,e)}}var Vq="@firebase/app-check",Lq="0.8.4";var jq="app-check",kM="app-check-internal";function Uq(){fs(new un(jq,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return Oq(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(kM).initialize()})),fs(new un(kM,n=>{let e=n.getProvider("app-check").getImmediate();return Fq(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Vn(Vq,Lq)}Uq();var Bq=["localhost","0.0.0.0","127.0.0.1"],ZJ=typeof window<"u"&&Bq.includes(window.location.hostname);var $q="firebase",Hq="10.12.2";yt.registerVersion($q,Hq,"app-compat");var qq=["ngOnDestroy"],GM=(n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(qq.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(l=>t.run(()=>l)):t.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,l)=>o.then(d=>{let f=d?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,f),f})})})});var ip=class{constructor(e){return e}},Mi=new z("angularfire2.app.options"),Ri=new z("angularfire2.app.name");function Fs(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let o=yt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>yt.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;Gq("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new ip(o)}var Gq=(n,...e)=>{D_()&&typeof console<"u"&&console[n](...e)},zq={provide:ip,useFactory:Fs,deps:[Mi,Te,[new _c,Ri]]},zM=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:Mi,useValue:t},{provide:Ri,useValue:r}]}}constructor(t){yt.registerVersion("angularfire",Ai.full,"core"),yt.registerVersion("angularfire",Ai.full,"app-compat"),yt.registerVersion("angular",hx.full,t.toString())}static \u0275fac=function(r){return new(r||n)(V(Vt))};static \u0275mod=Wt({type:n});static \u0275inj=zt({providers:[zq]})}return n})();function va(n,e,t,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return Wq(i,o)||(qM("error",`${e} was already initialized on the ${t} Firebase App with different settings.${Kq?" You may need to reload as Firebase is not HMR aware.":""}`),qM("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function Wq(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var Kq=typeof module<"u"&&!!module.hot,qM=(n,...e)=>{D_()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var el=new z("angularfire2.auth.use-emulator"),tl=new z("angularfire2.auth.settings"),nl=new z("angularfire2.auth.tenant-id"),rl=new z("angularfire2.auth.langugage-code"),il=new z("angularfire2.auth.use-device-language"),sl=new z("angularfire.auth.persistence"),ol=(n,e,t,r,i,s,o,a)=>va(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let u=e.runOutsideAngular(()=>n.auth());if(t&&u.useEmulator(...t),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[l,d]of Object.entries(o))u.settings[l]=d;return a&&u.setPersistence(a),u},[t,r,i,s,o,a]),_a=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,a,u,l,d,f,g,y){let _=new Ze,D=Z(void 0).pipe(In(o.outsideAngular),Ge(()=>s.runOutsideAngular(()=>import("./chunk-L2XLMUFV.js"))),Q(()=>Fs(t,s,r)),Q(S=>ol(S,s,a,l,d,f,u,g)),Sh({bufferSize:1,refCount:!1}));if(Ps(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Z(null);else{D.pipe(Cn()).subscribe();let S=D.pipe(Ge(F=>F.getRedirectResult().then(W=>W,()=>null)),nt,Sh({bufferSize:1,refCount:!1})),k=D.pipe(Ge(F=>new de(W=>({unsubscribe:s.runOutsideAngular(()=>F.onAuthStateChanged(te=>W.next(te),te=>W.error(te),()=>W.complete()))})))),U=D.pipe(Ge(F=>new de(W=>({unsubscribe:s.runOutsideAngular(()=>F.onIdTokenChanged(te=>W.next(te),te=>W.error(te),()=>W.complete()))}))));this.authState=S.pipe(Ah(k),jn(o.outsideAngular),In(o.insideAngular)),this.user=S.pipe(Ah(U),jn(o.outsideAngular),In(o.insideAngular)),this.idToken=this.user.pipe(Ge(F=>F?be(F.getIdToken()):Z(null))),this.idTokenResult=this.user.pipe(Ge(F=>F?be(F.getIdTokenResult()):Z(null))),this.credential=Fo(S,_,this.authState.pipe(Tt(F=>!F))).pipe(Q(F=>F?.user?F:null),jn(o.outsideAngular),In(o.insideAngular))}return GM(this,D,s,{spy:{apply:(S,k,U)=>{(S.startsWith("signIn")||S.startsWith("createUser"))&&U.then(F=>_.next(F))}}})}static \u0275fac=function(r){return new(r||n)(V(Mi),V(Ri,8),V(Vt),V(Te),V(ya),V(el,8),V(tl,8),V(nl,8),V(rl,8),V(il,8),V(sl,8),V(zr,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var KM="@firebase/database",QM="1.0.5";var GE="";function zE(n){GE=n}var Bw=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ot(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Jd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var $w=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return wn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var TR=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Bw(e)}}catch{}return new $w},Ls=TR("localStorage"),Hw=TR("sessionStorage");var Ca=new li("@firebase/database"),SR=function(){let n=1;return function(){return n++}}(),AR=function(n){let e=t0(n),t=new e0;t.update(e);let r=t.digest();return Qd.encodeByteArray(r)},Ml=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Ml.apply(null,r):typeof r=="object"?e+=ot(r):e+=r,e+=" "}return e},js=null,YM=!0,xR=function(n,e){L(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Ca.logLevel=En.VERBOSE,js=Ca.log.bind(Ca),e&&Hw.set("logging_enabled",!0)):typeof n=="function"?js=n:(js=null,Hw.remove("logging_enabled"))},_t=function(...n){if(YM===!0&&(YM=!1,js===null&&Hw.get("logging_enabled")===!0&&xR(!0)),js){let e=Ml.apply(null,n);js(e)}},Rl=function(n){return function(...e){_t(n,...e)}},qw=function(...n){let e="FIREBASE INTERNAL ERROR: "+Ml(...n);Ca.error(e)},vr=function(...n){let e=`FIREBASE FATAL ERROR: ${Ml(...n)}`;throw Ca.error(e),new Error(e)},Lt=function(...n){let e="FIREBASE WARNING: "+Ml(...n);Ca.warn(e)},Yq=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Lt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Np=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Zq=function(n){if(nr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Oi="[MIN_NAME]",Wr="[MAX_NAME]",Bs=function(n,e){if(n===e)return 0;if(n===Oi||e===Wr)return-1;if(e===Oi||n===Wr)return 1;{let t=ZM(n),r=ZM(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},Jq=function(n,e){return n===e?0:n<e?-1:1},al=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+ot(e))},WE=function(n){if(typeof n!="object"||n===null)return ot(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=ot(e[r]),t+=":",t+=WE(n[e[r]]);return t+="}",t},MR=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function wt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var RR=function(n){L(!Np(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,u;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(u=t;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),f="";for(u=0;u<64;u+=8){let g=parseInt(d.substr(u,8),2).toString(16);g.length===1&&(g="0"+g),f=f+g}return f.toLowerCase()},Xq=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},eG=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function tG(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var nG=new RegExp("^-?(0*)\\d{1,10}$"),rG=-2147483648,iG=2147483647,ZM=function(n){if(nG.test(n)){let e=Number(n);if(e>=rG&&e<=iG)return e}return null},Na=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Lt("Exception was thrown by user callback.",t),e},Math.floor(0))}},sG=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},dl=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var Gw=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Lt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var zw=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(_t("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Lt(e)}},hl=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),op="5",NR="v",PR="s",kR="r",OR="f",FR=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,VR="ls",LR="p",Ww="ac",jR="websocket",UR="long_polling";var ap=class{constructor(e,t,r,i,s=!1,o="",a=!1,u=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ls.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ls.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function oG(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function BR(n,e,t){L(typeof e=="string","typeof type must == string"),L(typeof t=="object","typeof params must == object");let r;if(e===jR)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===UR)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);oG(n)&&(t.ns=n.namespace);let i=[];return wt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var Kw=class{constructor(){this.counters_={}}incrementCounter(e,t=1){wn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return WT(this.counters_)}};var kw={},Ow={};function KE(n){let e=n.toString();return kw[e]||(kw[e]=new Kw),kw[e]}function aG(n,e){let t=n.toString();return Ow[t]||(Ow[t]=e()),Ow[t]}var Qw=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Na(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var JM="start",uG="close",cG="pLPCommand",lG="pRTLPCB",$R="id",HR="pw",qR="ser",dG="cb",hG="seg",fG="ts",pG="d",gG="dframe",GR=1870,zR=30,mG=GR-zR,yG=25e3,vG=3e4,ml=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Rl(e),this.stats_=KE(t),this.urlFn=u=>(this.appCheckToken&&(u[Ww]=this.appCheckToken),BR(t,UR,u))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Qw(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(vG)),Zq(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Yw((...s)=>{let[o,a,u,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===JM)this.id=a,this.password=u;else if(o===uG)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[JM]="t",r[qR]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[dG]=this.scriptTagHolder.uniqueCallbackIdentifier),r[NR]=op,this.transportSessionId&&(r[PR]=this.transportSessionId),this.lastSessionId&&(r[VR]=this.lastSessionId),this.applicationId&&(r[LR]=this.applicationId),this.appCheckToken&&(r[Ww]=this.appCheckToken),typeof location<"u"&&location.hostname&&FR.test(location.hostname)&&(r[kR]=OR);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return nr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Xq()&&!eG()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=ot(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=zT(t),i=MR(r,mG);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(nr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[gG]="t",r[$R]=e,r[HR]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=ot(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},Yw=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,nr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=SR(),window[cG+this.uniqueCallbackIdentifier]=e,window[lG+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){_t("frame writing exception"),a.stack&&_t(a.stack),_t(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||_t("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[$R]=this.myID,e[HR]=this.myPW,e[qR]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+zR+r.length<=GR;){let o=this.pendingSegs.shift();r=r+"&"+hG+i+"="+o.seg+"&"+fG+i+"="+o.ts+"&"+pG+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(yG)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){nr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{_t("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var _G=16384,wG=45e3,up=null;typeof MozWebSocket<"u"?up=MozWebSocket:typeof WebSocket<"u"&&(up=WebSocket);var Ea=(()=>{class n{constructor(t,r,i,s,o,a,u){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Rl(this.connId),this.stats_=KE(r),this.connURL=n.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[NR]=op,!nr()&&typeof location<"u"&&location.hostname&&FR.test(location.hostname)&&(a[kR]=OR),r&&(a[PR]=r),i&&(a[VR]=i),s&&(a[Ww]=s),o&&(a[LR]=o),BR(t,jR,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ls.set("previous_websocket_failure",!0);try{let i;if(nr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${op}/${GE}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new up(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&up!==null&&!n.forceDisallow_}static previouslyFailed(){return Ls.isInMemoryStorage||Ls.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ls.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Jd(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(L(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=ot(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=MR(r,_G);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(wG))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),WR=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[ml,Ea]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=Ea&&Ea.isAvailable(),i=r&&!Ea.previouslyFailed();if(t.webSocketOnly&&(r||Lt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ea];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),EG=6e4,IG=5e3,CG=10*1024,DG=100*1024,Fw="t",XM="d",bG="s",eR="r",TG="e",tR="o",nR="a",rR="n",iR="p",SG="h",Zw=class{constructor(e,t,r,i,s,o,a,u,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Rl("c:"+this.id+":"),this.transportManager_=new WR(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=dl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>DG?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>CG?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Fw in e){let t=e[Fw];t===nR?this.upgradeIfSecondaryHealthy_():t===eR?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===tR&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=al("t",e),r=al("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:iR,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:nR,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:rR,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=al("t",e),r=al("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=al(Fw,e);if(XM in e){let r=e[XM];if(t===SG){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===rR){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===bG?this.onConnectionShutdown_(r):t===eR?this.onReset_(r):t===TG?qw("Server Error: "+r):t===tR?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):qw("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),op!==r&&Lt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),dl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(EG))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):dl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(IG))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:iR,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ls.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var cp=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var lp=class{constructor(e){this.allowedEvents_=e,this.listeners_={},L(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){L(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var dp=class n extends lp{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ny()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return L(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var sR=32,oR=768,Me=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function xe(){return new Me("")}function fe(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Fi(n){return n.pieces_.length-n.pieceNum_}function Ve(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Me(n.pieces_,e)}function QE(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function AG(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function yl(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function KR(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Me(e,0)}function ze(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Me)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Me(t,0)}function pe(n){return n.pieceNum_>=n.pieces_.length}function Kt(n,e){let t=fe(n),r=fe(e);if(t===null)return e;if(t===r)return Kt(Ve(n),Ve(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function xG(n,e){let t=yl(n,0),r=yl(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=Bs(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function YE(n,e){if(Fi(n)!==Fi(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function xn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Fi(n)>Fi(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var Jw=class{constructor(e,t){this.errorPrefix_=t,this.parts_=yl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Qu(this.parts_[r]);QR(this)}};function MG(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Qu(e),QR(n)}function RG(n){let e=n.parts_.pop();n.byteLength_-=Qu(e),n.parts_.length>0&&(n.byteLength_-=1)}function QR(n){if(n.byteLength_>oR)throw new Error(n.errorPrefix_+"has a key path longer than "+oR+" bytes ("+n.byteLength_+").");if(n.parts_.length>sR)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+sR+") or object contains a cycle "+Vs(n))}function Vs(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var Xw=class n extends lp{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return L(e==="visible","Unknown event type: "+e),[this.visible_]}};var ul=1e3,NG=60*5*1e3,aR=30*1e3,PG=1.3,kG=3e4,OG="server_kill",uR=3,ZE=(()=>{class n extends cp{constructor(t,r,i,s,o,a,u,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=Rl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ul,this.maxReconnectDelay_=NG,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!nr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Xw.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&dp.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(ot(o)),L(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new mt,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),L(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),L(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,u=>{let l=u.d,d=u.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",u),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&wn(t,"w")){let i=ci(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Lt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||JT(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=aR)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=ZT(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),L(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+ot(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):qw("Unrecognized action received from server: "+ot(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){L(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ul,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ul,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>kG&&(this.reconnectDelay_=ul),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*PG)}this.onConnectStatus_(!1)}establishConnection_(){return N(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,l=function(){u?u.close():(a=!0,i())},d=function(g){L(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(g)};this.realtime_={close:l,sendRequest:d};let f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,y]=yield Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);a?_t("getToken() completed but was canceled"):(_t("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=y&&y.token,u=new Zw(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,_=>{Lt(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(OG)},o))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&Lt(g),l())}}})}interrupt(t){_t("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){_t("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Xd(this.interruptReasons_)&&(this.reconnectDelay_=ul,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>WE(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new Me(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){_t("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=uR&&(this.reconnectDelay_=aR,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){_t("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=uR&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";nr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+GE.replace(/\./g,"-")]=1,ny()?t["framework.cordova"]=1:KT()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=dp.getInstance().currentlyOnline();return Xd(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),me=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Da=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new me(Oi,e),i=new me(Oi,t);return this.compare(r,i)!==0}minPost(){return me.MIN}};var sp,hp=class extends Da{static get __EMPTY_NODE(){return sp}static set __EMPTY_NODE(e){sp=e}compare(e,t){return Bs(e.name,t.name)}isDefinedOn(e){throw Co("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return me.MIN}maxPost(){return new me(Wr,sp)}makePost(e,t){return L(typeof e=="string","KeyIndex indexValue must always be a string."),new me(e,sp)}toString(){return".key"}},yr=new hp;var Ia=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Yn=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Mn.EMPTY_NODE,this.right=o??Mn.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Mn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Mn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),eE=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Yn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Mn=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Yn.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Yn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ia(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ia(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ia(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ia(this.root_,null,this.comparator_,!0,e)}};Mn.EMPTY_NODE=new eE;function FG(n,e){return Bs(n.name,e.name)}function JE(n,e){return Bs(n,e)}var tE;function VG(n){tE=n}var YR=function(n){return typeof n=="number"?"number:"+RR(n):"string:"+n},ZR=function(n){if(n.isLeafNode()){let e=n.val();L(typeof e=="string"||typeof e=="number"||typeof e=="object"&&wn(e,".sv"),"Priority must be a string or number.")}else L(n===tE||n.isEmpty(),"priority of unexpected type.");L(n===tE||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var cR,ba=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,L(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),ZR(this.priorityNode_)}static set __childrenNodeConstructor(t){cR=t}static get __childrenNodeConstructor(){return cR}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return pe(t)?this:fe(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=fe(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(L(i!==".priority"||Fi(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ve(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+YR(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=RR(this.value_):t+=this.value_,this.lazyHash_=AR(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(L(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return L(s>=0,"Unknown leaf type: "+r),L(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),JR,XR;function LG(n){JR=n}function jG(n){XR=n}var nE=class extends Da{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Bs(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return me.MIN}maxPost(){return new me(Wr,new ba("[PRIORITY-POST]",XR))}makePost(e,t){let r=JR(e);return new me(t,new ba("[PRIORITY-POST]",r))}toString(){return".priority"}},Ue=new nE;var UG=Math.log(2),rE=class{constructor(e){let t=s=>parseInt(Math.log(s)/UG,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},fp=function(n,e,t,r){n.sort(e);let i=function(u,l){let d=l-u,f,g;if(d===0)return null;if(d===1)return f=n[u],g=t?t(f):f,new Yn(g,f.node,Yn.BLACK,null,null);{let y=parseInt(d/2,10)+u,_=i(u,y),D=i(y+1,l);return f=n[y],g=t?t(f):f,new Yn(g,f.node,Yn.BLACK,_,D)}},s=function(u){let l=null,d=null,f=n.length,g=function(_,D){let S=f-_,k=f;f-=_;let U=i(S+1,k),F=n[S],W=t?t(F):F;y(new Yn(W,F.node,D,null,U))},y=function(_){l?(l.left=_,l=_):(d=_,l=_)};for(let _=0;_<u.count;++_){let D=u.nextBitIsOne(),S=Math.pow(2,u.count-(_+1));D?g(S,Yn.BLACK):(g(S,Yn.BLACK),g(S,Yn.RED))}return d},o=new rE(n.length),a=s(o);return new Mn(r||e,a)};var Vw,wa={},Ta=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return L(wa&&Ue,"ChildrenNode.ts has not been loaded"),Vw=Vw||new n({".priority":wa},{".priority":Ue}),Vw}get(e){let t=ci(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Mn?t:null}hasIndex(e){return wn(this.indexSet_,e.toString())}addIndex(e,t){L(e!==yr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(me.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=fp(r,e.getCompare()):a=wa;let u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;let d=Object.assign({},this.indexes_);return d[u]=a,new n(d,l)}addToIndexes(e,t){let r=Ku(this.indexes_,(i,s)=>{let o=ci(this.indexSet_,s);if(L(o,"Missing index implementation for "+s),i===wa)if(o.isDefinedOn(e.node)){let a=[],u=t.getIterator(me.Wrap),l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),fp(a,o.getCompare())}else return wa;else{let a=t.get(e.name),u=i;return a&&(u=u.remove(new me(e.name,a))),u.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Ku(this.indexes_,i=>{if(i===wa)return i;{let s=t.get(e.name);return s?i.remove(new me(e.name,s)):i}});return new n(r,this.indexSet_)}};var cl,ae=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&ZR(this.priorityNode_),this.children_.isEmpty()&&L(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return cl||(cl=new n(new Mn(JE),null,Ta.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||cl}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?cl:r}}getChild(t){let r=fe(t);return r===null?this:this.getImmediateChild(r).getChild(Ve(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(L(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new me(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?cl:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=fe(t);if(i===null)return r;{L(fe(t)!==".priority"||Fi(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ve(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ue,(a,u)=>{r[a]=u.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+YR(this.getPriority().val())+":"),this.forEachChild(Ue,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":AR(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new me(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new me(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new me(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,me.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,me.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Nl?-1:0}withIndex(t){if(t===yr||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===yr||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ue),s=r.getIterator(Ue),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===yr?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),iE=class extends ae{constructor(){super(new Mn(JE),ae.EMPTY_NODE,Ta.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ae.EMPTY_NODE}isEmpty(){return!1}},Nl=new iE;Object.defineProperties(me,{MIN:{value:new me(Oi,ae.EMPTY_NODE)},MAX:{value:new me(Wr,Nl)}});hp.__EMPTY_NODE=ae.EMPTY_NODE;ba.__childrenNodeConstructor=ae;VG(Nl);jG(Nl);var BG=!0;function Ke(n,e=null){if(n===null)return ae.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),L(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new ba(t,Ke(e))}if(!(n instanceof Array)&&BG){let t=[],r=!1;if(wt(n,(o,a)=>{if(o.substring(0,1)!=="."){let u=Ke(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),t.push(new me(o,u)))}}),t.length===0)return ae.EMPTY_NODE;let s=fp(t,FG,o=>o.name,JE);if(r){let o=fp(t,Ue.getCompare());return new ae(s,Ke(e),new Ta({".priority":o},{".priority":Ue}))}else return new ae(s,Ke(e),Ta.Default)}else{let t=ae.EMPTY_NODE;return wt(n,(r,i)=>{if(wn(n,r)&&r.substring(0,1)!=="."){let s=Ke(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Ke(e))}}LG(Ke);var vl=class extends Da{constructor(e){super(),this.indexPath_=e,L(!pe(e)&&fe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Bs(e.name,t.name):s}makePost(e,t){let r=Ke(e),i=ae.EMPTY_NODE.updateChild(this.indexPath_,r);return new me(t,i)}maxPost(){let e=ae.EMPTY_NODE.updateChild(this.indexPath_,Nl);return new me(Wr,e)}toString(){return yl(this.indexPath_,0).join("/")}};var sE=class extends Da{compare(e,t){let r=e.node.compareTo(t.node);return r===0?Bs(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return me.MIN}maxPost(){return me.MAX}makePost(e,t){let r=Ke(e);return new me(t,r)}toString(){return".value"}},XE=new sE;function eN(n){return{type:"value",snapshotNode:n}}function Sa(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function _l(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function wl(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function $G(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var El=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){L(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(_l(t,a)):L(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Sa(t,r)):o.trackChildChange(wl(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ue,(i,s)=>{t.hasChild(i)||r.trackChildChange(_l(i,s))}),t.isLeafNode()||t.forEachChild(Ue,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(wl(i,s,o))}else r.trackChildChange(Sa(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ae.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var pp=class n{constructor(e){this.indexedFilter_=new El(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new me(t,r))||(r=ae.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=ae.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(ae.EMPTY_NODE);let s=this;return t.forEachChild(Ue,(o,a)=>{s.matches(new me(o,a))||(i=i.updateImmediateChild(o,ae.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var oE=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new pp(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new me(t,r))||(r=ae.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=ae.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=ae.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(ae.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ae.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let f=this.index_.getCompare();o=(g,y)=>f(y,g)}else o=this.index_.getCompare();let a=e;L(a.numChildren()===this.limit_,"");let u=new me(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(u);if(a.hasChild(t)){let f=a.getImmediateChild(t),g=i.getChildAfterChild(this.index_,l,this.reverse_);for(;g!=null&&(g.name===t||a.hasChild(g.name));)g=i.getChildAfterChild(this.index_,g,this.reverse_);let y=g==null?1:o(g,u);if(d&&!r.isEmpty()&&y>=0)return s?.trackChildChange(wl(t,r,f)),a.updateImmediateChild(t,r);{s?.trackChildChange(_l(t,f));let D=a.updateImmediateChild(t,ae.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(s?.trackChildChange(Sa(g.name,g.node)),D.updateImmediateChild(g.name,g.node)):D}}else return r.isEmpty()?e:d&&o(l,u)>=0?(s!=null&&(s.trackChildChange(_l(l.name,l.node)),s.trackChildChange(Sa(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,ae.EMPTY_NODE)):e}};var Il=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ue}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return L(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return L(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Oi}hasEnd(){return this.endSet_}getIndexEndValue(){return L(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return L(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Wr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return L(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ue}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function HG(n){return n.loadsAllData()?new El(n.getIndex()):n.hasLimit()?new oE(n):new pp(n)}function qG(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function GG(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function aE(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function zG(n,e,t){let r;return n.index_===yr||t?r=aE(n,e,t):r=aE(n,e,Wr),r.startAfterSet_=!0,r}function uE(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function WG(n,e,t){let r;return n.index_===yr||t?r=uE(n,e,t):r=uE(n,e,Oi),r.endBeforeSet_=!0,r}function Pp(n,e){let t=n.copy();return t.index_=e,t}function lR(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Ue?t="$priority":n.index_===XE?t="$value":n.index_===yr?t="$key":(L(n.index_ instanceof vl,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=ot(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=ot(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+ot(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=ot(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+ot(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function dR(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ue&&(e.i=n.index_.toString()),e}var cE=class n extends cp{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Rl("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(L(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let u=lR(e._queryParams);this.restRequest_(s+".json",u,(l,d)=>{let f=d;if(l===404&&(f=null,l=null),l===null&&this.onDataUpdate_(s,f,!1,r),ci(this.listens_,o)===a){let g;l?l===401?g="permission_denied":g="rest_error:"+l:g="ok",i(g,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=lR(e._queryParams),r=e._path.toString(),i=new mt;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+XT(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=Jd(a.responseText)}catch{Lt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&Lt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var lE=class{constructor(){this.rootNode_=ae.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function gp(){return{value:null,children:new Map}}function Pa(n,e,t){if(pe(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=fe(e);n.children.has(r)||n.children.set(r,gp());let i=n.children.get(r);e=Ve(e),Pa(i,e,t)}}function dE(n,e){if(pe(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(Ue,(r,i)=>{Pa(n,new Me(r),i)}),dE(n,e)}}else if(n.children.size>0){let t=fe(e);return e=Ve(e),n.children.has(t)&&dE(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function hE(n,e,t){n.value!==null?t(e,n.value):KG(n,(r,i)=>{let s=new Me(e.toString()+"/"+r);hE(i,s,t)})}function KG(n,e){n.children.forEach((t,r)=>{e(r,t)})}var fE=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&wt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var hR=10*1e3,QG=30*1e3,YG=5*60*1e3,pE=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new fE(e);let r=hR+(QG-hR)*Math.random();dl(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;wt(e,(i,s)=>{s>0&&wn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),dl(this.reportStats_.bind(this),Math.floor(Math.random()*2*YG))}};var mr=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(mr||{});function eI(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function tI(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function nI(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var gE=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=mr.ACK_USER_WRITE,this.source=eI()}operationForChild(e){if(pe(this.path)){if(this.affectedTree.value!=null)return L(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Me(e));return new n(xe(),t,this.revert)}}else return L(fe(this.path)===e,"operationForChild called for unrelated child."),new n(Ve(this.path),this.affectedTree,this.revert)}};var mp=class n{constructor(e,t){this.source=e,this.path=t,this.type=mr.LISTEN_COMPLETE}operationForChild(e){return pe(this.path)?new n(this.source,xe()):new n(this.source,Ve(this.path))}};var Aa=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=mr.OVERWRITE}operationForChild(e){return pe(this.path)?new n(this.source,xe(),this.snap.getImmediateChild(e)):new n(this.source,Ve(this.path),this.snap)}};var Cl=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=mr.MERGE}operationForChild(e){if(pe(this.path)){let t=this.children.subtree(new Me(e));return t.isEmpty()?null:t.value?new Aa(this.source,xe(),t.value):new n(this.source,xe(),t)}else return L(fe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Ve(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var _r=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pe(e))return this.isFullyInitialized()&&!this.filtered_;let t=fe(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var mE=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function ZG(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push($G(o.childName,o.snapshotNode))}),ll(n,i,"child_removed",e,r,t),ll(n,i,"child_added",e,r,t),ll(n,i,"child_moved",s,r,t),ll(n,i,"child_changed",e,r,t),ll(n,i,"value",e,r,t),i}function ll(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,u)=>XG(n,a,u)),o.forEach(a=>{let u=JG(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,n.query_))})})}function JG(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function XG(n,e,t){if(e.childName==null||t.childName==null)throw Co("Should only compare child_ events.");let r=new me(e.childName,e.snapshotNode),i=new me(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function kp(n,e){return{eventCache:n,serverCache:e}}function fl(n,e,t,r){return kp(new _r(e,t,r),n.serverCache)}function tN(n,e,t,r){return kp(n.eventCache,new _r(e,t,r))}function yp(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Us(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var Lw,e4=()=>(Lw||(Lw=new Mn(Jq)),Lw),Qt=class n{constructor(e,t=e4()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return wt(e,(r,i)=>{t=t.set(new Me(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:xe(),value:this.value};if(pe(e))return null;{let r=fe(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ve(e),t);return s!=null?{path:ze(new Me(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pe(e))return this;{let t=fe(e),r=this.children.get(t);return r!==null?r.subtree(Ve(e)):new n(null)}}set(e,t){if(pe(e))return new n(t,this.children);{let r=fe(e),s=(this.children.get(r)||new n(null)).set(Ve(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(pe(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=fe(e),r=this.children.get(t);if(r){let i=r.remove(Ve(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(pe(e))return this.value;{let t=fe(e),r=this.children.get(t);return r?r.get(Ve(e)):null}}setTree(e,t){if(pe(e))return t;{let r=fe(e),s=(this.children.get(r)||new n(null)).setTree(Ve(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(xe(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(ze(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,xe(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(pe(e))return null;{let s=fe(e),o=this.children.get(s);return o?o.findOnPath_(Ve(e),ze(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,xe(),t)}foreachOnPath_(e,t,r){if(pe(e))return this;{this.value&&r(t,this.value);let i=fe(e),s=this.children.get(i);return s?s.foreachOnPath_(Ve(e),ze(t,i),r):new n(null)}}foreach(e){this.foreach_(xe(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(ze(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Zn=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new Qt(null))}};function pl(n,e,t){if(pe(e))return new Zn(new Qt(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Kt(i,e);return s=s.updateChild(o,t),new Zn(n.writeTree_.set(i,s))}else{let i=new Qt(t),s=n.writeTree_.setTree(e,i);return new Zn(s)}}}function yE(n,e,t){let r=n;return wt(t,(i,s)=>{r=pl(r,ze(e,i),s)}),r}function fR(n,e){if(pe(e))return Zn.empty();{let t=n.writeTree_.setTree(e,new Qt(null));return new Zn(t)}}function vE(n,e){return $s(n,e)!=null}function $s(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Kt(t.path,e)):null}function pR(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ue,(r,i)=>{e.push(new me(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new me(r,i.value))}),e}function Pi(n,e){if(pe(e))return n;{let t=$s(n,e);return t!=null?new Zn(new Qt(t)):new Zn(n.writeTree_.subtree(e))}}function _E(n){return n.writeTree_.isEmpty()}function xa(n,e){return nN(xe(),n.writeTree_,e)}function nN(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(L(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=nN(ze(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(ze(n,".priority"),r)),t}}function Op(n,e){return oN(e,n)}function t4(n,e,t,r,i){L(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=pl(n.visibleWrites,e,t)),n.lastWriteId=r}function n4(n,e,t,r){L(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=yE(n.visibleWrites,e,t),n.lastWriteId=r}function r4(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function i4(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);L(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&s4(a,r.path)?i=!1:xn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return o4(n),!0;if(r.snap)n.visibleWrites=fR(n.visibleWrites,r.path);else{let a=r.children;wt(a,u=>{n.visibleWrites=fR(n.visibleWrites,ze(r.path,u))})}return!0}else return!1}function s4(n,e){if(n.snap)return xn(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&xn(ze(n.path,t),e))return!0;return!1}function o4(n){n.visibleWrites=rN(n.allWrites,a4,xe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function a4(n){return n.visible}function rN(n,e,t){let r=Zn.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)xn(t,o)?(a=Kt(t,o),r=pl(r,a,s.snap)):xn(o,t)&&(a=Kt(o,t),r=pl(r,xe(),s.snap.getChild(a)));else if(s.children){if(xn(t,o))a=Kt(t,o),r=yE(r,a,s.children);else if(xn(o,t))if(a=Kt(o,t),pe(a))r=yE(r,xe(),s.children);else{let u=ci(s.children,fe(a));if(u){let l=u.getChild(Ve(a));r=pl(r,xe(),l)}}}else throw Co("WriteRecord should have .snap or .children")}}return r}function iN(n,e,t,r,i){if(!r&&!i){let s=$s(n.visibleWrites,e);if(s!=null)return s;{let o=Pi(n.visibleWrites,e);if(_E(o))return t;if(t==null&&!vE(o,xe()))return null;{let a=t||ae.EMPTY_NODE;return xa(o,a)}}}else{let s=Pi(n.visibleWrites,e);if(!i&&_E(s))return t;if(!i&&t==null&&!vE(s,xe()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(xn(l.path,e)||xn(e,l.path))},a=rN(n.allWrites,o,e),u=t||ae.EMPTY_NODE;return xa(a,u)}}}function u4(n,e,t){let r=ae.EMPTY_NODE,i=$s(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ue,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=Pi(n.visibleWrites,e);return t.forEachChild(Ue,(o,a)=>{let u=xa(Pi(s,new Me(o)),a);r=r.updateImmediateChild(o,u)}),pR(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Pi(n.visibleWrites,e);return pR(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function c4(n,e,t,r,i){L(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=ze(e,t);if(vE(n.visibleWrites,s))return null;{let o=Pi(n.visibleWrites,s);return _E(o)?i.getChild(t):xa(o,i.getChild(t))}}function l4(n,e,t,r){let i=ze(e,t),s=$s(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=Pi(n.visibleWrites,i);return xa(o,r.getNode().getImmediateChild(t))}else return null}function d4(n,e){return $s(n.visibleWrites,e)}function h4(n,e,t,r,i,s,o){let a,u=Pi(n.visibleWrites,e),l=$s(u,xe());if(l!=null)a=l;else if(t!=null)a=xa(u,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],f=o.getCompare(),g=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),y=g.getNext();for(;y&&d.length<i;)f(y,r)!==0&&d.push(y),y=g.getNext();return d}else return[]}function f4(){return{visibleWrites:Zn.empty(),allWrites:[],lastWriteId:-1}}function vp(n,e,t,r){return iN(n.writeTree,n.treePath,e,t,r)}function rI(n,e){return u4(n.writeTree,n.treePath,e)}function gR(n,e,t,r){return c4(n.writeTree,n.treePath,e,t,r)}function _p(n,e){return d4(n.writeTree,ze(n.treePath,e))}function p4(n,e,t,r,i,s){return h4(n.writeTree,n.treePath,e,t,r,i,s)}function iI(n,e,t){return l4(n.writeTree,n.treePath,e,t)}function sN(n,e){return oN(ze(n.treePath,e),n.writeTree)}function oN(n,e){return{treePath:n,writeTree:e}}var wE=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;L(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),L(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,wl(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,_l(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Sa(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,wl(r,e.snapshotNode,i.oldSnap));else throw Co("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var EE=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},aN=new EE,Dl=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new _r(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return iI(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Us(this.viewCache_),s=p4(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function g4(n){return{filter:n}}function m4(n,e){L(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),L(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function y4(n,e,t,r,i){let s=new wE,o,a;if(t.type===mr.OVERWRITE){let l=t;l.source.fromUser?o=IE(n,e,l.path,l.snap,r,i,s):(L(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!pe(l.path),o=wp(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===mr.MERGE){let l=t;l.source.fromUser?o=_4(n,e,l.path,l.children,r,i,s):(L(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=CE(n,e,l.path,l.children,r,i,a,s))}else if(t.type===mr.ACK_USER_WRITE){let l=t;l.revert?o=I4(n,e,l.path,r,i,s):o=w4(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===mr.LISTEN_COMPLETE)o=E4(n,e,t.path,r,s);else throw Co("Unknown operation type: "+t.type);let u=s.getChanges();return v4(e,o,u),{viewCache:o,changes:u}}function v4(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=yp(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(eN(yp(e)))}}function uN(n,e,t,r,i,s){let o=e.eventCache;if(_p(r,t)!=null)return e;{let a,u;if(pe(t))if(L(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Us(e),d=l instanceof ae?l:ae.EMPTY_NODE,f=rI(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{let l=vp(r,Us(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=fe(t);if(l===".priority"){L(Fi(t)===1,"Can't have a priority with additional path components");let d=o.getNode();u=e.serverCache.getNode();let f=gR(r,t,d,u);f!=null?a=n.filter.updatePriority(d,f):a=o.getNode()}else{let d=Ve(t),f;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();let g=gR(r,t,o.getNode(),u);g!=null?f=o.getNode().getImmediateChild(l).updateChild(d,g):f=o.getNode().getImmediateChild(l)}else f=iI(r,l,e.serverCache);f!=null?a=n.filter.updateChild(o.getNode(),l,f,d,i,s):a=o.getNode()}}return fl(e,a,o.isFullyInitialized()||pe(t),n.filter.filtersNodes())}}function wp(n,e,t,r,i,s,o,a){let u=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(pe(t))l=d.updateFullNode(u.getNode(),r,null);else if(d.filtersNodes()&&!u.isFiltered()){let y=u.getNode().updateChild(t,r);l=d.updateFullNode(u.getNode(),y,null)}else{let y=fe(t);if(!u.isCompleteForPath(t)&&Fi(t)>1)return e;let _=Ve(t),S=u.getNode().getImmediateChild(y).updateChild(_,r);y===".priority"?l=d.updatePriority(u.getNode(),S):l=d.updateChild(u.getNode(),y,S,_,aN,null)}let f=tN(e,l,u.isFullyInitialized()||pe(t),d.filtersNodes()),g=new Dl(i,f,s);return uN(n,f,t,i,g,a)}function IE(n,e,t,r,i,s,o){let a=e.eventCache,u,l,d=new Dl(i,e,s);if(pe(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),u=fl(e,l,!0,n.filter.filtersNodes());else{let f=fe(t);if(f===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),u=fl(e,l,a.isFullyInitialized(),a.isFiltered());else{let g=Ve(t),y=a.getNode().getImmediateChild(f),_;if(pe(g))_=r;else{let D=d.getCompleteChild(f);D!=null?QE(g)===".priority"&&D.getChild(KR(g)).isEmpty()?_=D:_=D.updateChild(g,r):_=ae.EMPTY_NODE}if(y.equals(_))u=e;else{let D=n.filter.updateChild(a.getNode(),f,_,g,d,o);u=fl(e,D,a.isFullyInitialized(),n.filter.filtersNodes())}}}return u}function mR(n,e){return n.eventCache.isCompleteForChild(e)}function _4(n,e,t,r,i,s,o){let a=e;return r.foreach((u,l)=>{let d=ze(t,u);mR(e,fe(d))&&(a=IE(n,a,d,l,i,s,o))}),r.foreach((u,l)=>{let d=ze(t,u);mR(e,fe(d))||(a=IE(n,a,d,l,i,s,o))}),a}function yR(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function CE(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,l;pe(t)?l=r:l=new Qt(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((f,g)=>{if(d.hasChild(f)){let y=e.serverCache.getNode().getImmediateChild(f),_=yR(n,y,g);u=wp(n,u,new Me(f),_,i,s,o,a)}}),l.children.inorderTraversal((f,g)=>{let y=!e.serverCache.isCompleteForChild(f)&&g.value===null;if(!d.hasChild(f)&&!y){let _=e.serverCache.getNode().getImmediateChild(f),D=yR(n,_,g);u=wp(n,u,new Me(f),D,i,s,o,a)}}),u}function w4(n,e,t,r,i,s,o){if(_p(i,t)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(pe(t)&&u.isFullyInitialized()||u.isCompleteForPath(t))return wp(n,e,t,u.getNode().getChild(t),i,s,a,o);if(pe(t)){let l=new Qt(null);return u.getNode().forEachChild(yr,(d,f)=>{l=l.set(new Me(d),f)}),CE(n,e,t,l,i,s,a,o)}else return e}else{let l=new Qt(null);return r.foreach((d,f)=>{let g=ze(t,d);u.isCompleteForPath(g)&&(l=l.set(d,u.getNode().getChild(g)))}),CE(n,e,t,l,i,s,a,o)}}function E4(n,e,t,r,i){let s=e.serverCache,o=tN(e,s.getNode(),s.isFullyInitialized()||pe(t),s.isFiltered());return uN(n,o,t,r,aN,i)}function I4(n,e,t,r,i,s){let o;if(_p(r,t)!=null)return e;{let a=new Dl(r,e,i),u=e.eventCache.getNode(),l;if(pe(t)||fe(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=vp(r,Us(e));else{let f=e.serverCache.getNode();L(f instanceof ae,"serverChildren would be complete if leaf node"),d=rI(r,f)}d=d,l=n.filter.updateFullNode(u,d,s)}else{let d=fe(t),f=iI(r,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=u.getImmediateChild(d)),f!=null?l=n.filter.updateChild(u,d,f,Ve(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(u,d,ae.EMPTY_NODE,Ve(t),a,s):l=u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=vp(r,Us(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||_p(r,xe())!=null,fl(e,l,o,n.filter.filtersNodes())}}var DE=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new El(r.getIndex()),s=HG(r);this.processor_=g4(s);let o=t.serverCache,a=t.eventCache,u=i.updateFullNode(ae.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(ae.EMPTY_NODE,a.getNode(),null),d=new _r(u,o.isFullyInitialized(),i.filtersNodes()),f=new _r(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=kp(f,d),this.eventGenerator_=new mE(this.query_)}get query(){return this.query_}};function C4(n){return n.viewCache_.serverCache.getNode()}function D4(n){return yp(n.viewCache_)}function b4(n,e){let t=Us(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!pe(e)&&!t.getImmediateChild(fe(e)).isEmpty())?t.getChild(e):null}function vR(n){return n.eventRegistrations_.length===0}function T4(n,e){n.eventRegistrations_.push(e)}function _R(n,e,t){let r=[];if(t){L(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function wR(n,e,t,r){e.type===mr.MERGE&&e.source.queryId!==null&&(L(Us(n.viewCache_),"We should always have a full cache before handling merges"),L(yp(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=y4(n.processor_,i,e,t,r);return m4(n.processor_,s.viewCache),L(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,cN(n,s.changes,s.viewCache.eventCache.getNode(),null)}function S4(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ue,(s,o)=>{r.push(Sa(s,o))}),t.isFullyInitialized()&&r.push(eN(t.getNode())),cN(n,r,t.getNode(),e)}function cN(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return ZG(n.eventGenerator_,e,t,i)}var Ep,Ip=class{constructor(){this.views=new Map}};function A4(n){L(!Ep,"__referenceConstructor has already been defined"),Ep=n}function x4(){return L(Ep,"Reference.ts has not been loaded"),Ep}function M4(n){return n.views.size===0}function sI(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return L(s!=null,"SyncTree gave us an op for an invalid query."),wR(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(wR(o,e,t,r));return s}}function lN(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=vp(t,i?r:null),u=!1;a?u=!0:r instanceof ae?(a=rI(t,r),u=!1):(a=ae.EMPTY_NODE,u=!1);let l=kp(new _r(a,u,!1),new _r(r,i,!1));return new DE(e,l)}return o}function R4(n,e,t,r,i,s){let o=lN(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),T4(o,t),S4(o,t)}function N4(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=Vi(n);if(i==="default")for(let[u,l]of n.views.entries())o=o.concat(_R(l,t,r)),vR(l)&&(n.views.delete(u),l.query._queryParams.loadsAllData()||s.push(l.query));else{let u=n.views.get(i);u&&(o=o.concat(_R(u,t,r)),vR(u)&&(n.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!Vi(n)&&s.push(new(x4())(e._repo,e._path)),{removed:s,events:o}}function dN(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function ki(n,e){let t=null;for(let r of n.views.values())t=t||b4(r,e);return t}function hN(n,e){if(e._queryParams.loadsAllData())return Fp(n);{let r=e._queryIdentifier;return n.views.get(r)}}function fN(n,e){return hN(n,e)!=null}function Vi(n){return Fp(n)!=null}function Fp(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Cp;function P4(n){L(!Cp,"__referenceConstructor has already been defined"),Cp=n}function k4(){return L(Cp,"Reference.ts has not been loaded"),Cp}var O4=1,Dp=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Qt(null),this.pendingWriteTree_=f4(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function oI(n,e,t,r,i){return t4(n.pendingWriteTree_,e,t,r,i),i?ka(n,new Aa(eI(),e,t)):[]}function F4(n,e,t,r){n4(n.pendingWriteTree_,e,t,r);let i=Qt.fromObject(t);return ka(n,new Cl(eI(),e,i))}function Ni(n,e,t=!1){let r=r4(n.pendingWriteTree_,e);if(i4(n.pendingWriteTree_,e)){let s=new Qt(null);return r.snap!=null?s=s.set(xe(),!0):wt(r.children,o=>{s=s.set(new Me(o),!0)}),ka(n,new gE(r.path,s,t))}else return[]}function Pl(n,e,t){return ka(n,new Aa(tI(),e,t))}function V4(n,e,t){let r=Qt.fromObject(t);return ka(n,new Cl(tI(),e,r))}function L4(n,e){return ka(n,new mp(tI(),e))}function j4(n,e,t){let r=aI(n,t);if(r){let i=uI(r),s=i.path,o=i.queryId,a=Kt(s,e),u=new mp(nI(o),a);return cI(n,s,u)}else return[]}function bp(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||fN(o,e))){let u=N4(o,e,t,r);M4(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=u.removed;if(a=u.events,!i){let d=l.findIndex(g=>g._queryParams.loadsAllData())!==-1,f=n.syncPointTree_.findOnPath(s,(g,y)=>Vi(y));if(d&&!f){let g=n.syncPointTree_.subtree(s);if(!g.isEmpty()){let y=$4(g);for(let _=0;_<y.length;++_){let D=y[_],S=D.query,k=yN(n,D);n.listenProvider_.startListening(gl(S),bl(n,S),k.hashFn,k.onComplete)}}}!f&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(gl(e),null):l.forEach(g=>{let y=n.queryToTagMap.get(Lp(g));n.listenProvider_.stopListening(gl(g),y)}))}H4(n,l)}return a}function pN(n,e,t,r){let i=aI(n,r);if(i!=null){let s=uI(i),o=s.path,a=s.queryId,u=Kt(o,e),l=new Aa(nI(a),u,t);return cI(n,o,l)}else return[]}function U4(n,e,t,r){let i=aI(n,r);if(i){let s=uI(i),o=s.path,a=s.queryId,u=Kt(o,e),l=Qt.fromObject(t),d=new Cl(nI(a),u,l);return cI(n,o,d)}else return[]}function bE(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(g,y)=>{let _=Kt(g,i);s=s||ki(y,_),o=o||Vi(y)});let a=n.syncPointTree_.get(i);a?(o=o||Vi(a),s=s||ki(a,xe())):(a=new Ip,n.syncPointTree_=n.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=ae.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((y,_)=>{let D=ki(_,xe());D&&(s=s.updateImmediateChild(y,D))}));let l=fN(a,e);if(!l&&!e._queryParams.loadsAllData()){let g=Lp(e);L(!n.queryToTagMap.has(g),"View does not exist, but we have a tag");let y=q4();n.queryToTagMap.set(g,y),n.tagToQueryMap.set(y,g)}let d=Op(n.pendingWriteTree_,i),f=R4(a,e,t,d,s,u);if(!l&&!o&&!r){let g=hN(a,e);f=f.concat(G4(n,e,g))}return f}function Vp(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let u=Kt(o,e),l=ki(a,u);if(l)return l});return iN(i,e,s,t,!0)}function B4(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let f=Kt(l,t);r=r||ki(d,f)});let i=n.syncPointTree_.get(t);i?r=r||ki(i,xe()):(i=new Ip,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new _r(r,!0,!1):null,a=Op(n.pendingWriteTree_,e._path),u=lN(i,e,a,s?o.getNode():ae.EMPTY_NODE,s);return D4(u)}function ka(n,e){return gN(e,n.syncPointTree_,null,Op(n.pendingWriteTree_,xe()))}function gN(n,e,t,r){if(pe(n.path))return mN(n,e,t,r);{let i=e.get(xe());t==null&&i!=null&&(t=ki(i,xe()));let s=[],o=fe(n.path),a=n.operationForChild(o),u=e.children.get(o);if(u&&a){let l=t?t.getImmediateChild(o):null,d=sN(r,o);s=s.concat(gN(a,u,l,d))}return i&&(s=s.concat(sI(i,n,r,t))),s}}function mN(n,e,t,r){let i=e.get(xe());t==null&&i!=null&&(t=ki(i,xe()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=t?t.getImmediateChild(o):null,l=sN(r,o),d=n.operationForChild(o);d&&(s=s.concat(mN(d,a,u,l)))}),i&&(s=s.concat(sI(i,n,r,t))),s}function yN(n,e){let t=e.query,r=bl(n,t);return{hashFn:()=>(C4(e)||ae.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?j4(n,t._path,r):L4(n,t._path);{let s=tG(i,t);return bp(n,t,null,s)}}}}function bl(n,e){let t=Lp(e);return n.queryToTagMap.get(t)}function Lp(n){return n._path.toString()+"$"+n._queryIdentifier}function aI(n,e){return n.tagToQueryMap.get(e)}function uI(n){let e=n.indexOf("$");return L(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Me(n.substr(0,e))}}function cI(n,e,t){let r=n.syncPointTree_.get(e);L(r,"Missing sync point for query tag that we're tracking");let i=Op(n.pendingWriteTree_,e);return sI(r,t,i,null)}function $4(n){return n.fold((e,t,r)=>{if(t&&Vi(t))return[Fp(t)];{let i=[];return t&&(i=dN(t)),wt(r,(s,o)=>{i=i.concat(o)}),i}})}function gl(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(k4())(n._repo,n._path):n}function H4(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=Lp(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function q4(){return O4++}function G4(n,e,t){let r=e._path,i=bl(n,e),s=yN(n,t),o=n.listenProvider_.startListening(gl(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)L(!Vi(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((l,d,f)=>{if(!pe(l)&&d&&Vi(d))return[Fp(d).query];{let g=[];return d&&(g=g.concat(dN(d).map(y=>y.query))),wt(f,(y,_)=>{g=g.concat(_)}),g}});for(let l=0;l<u.length;++l){let d=u[l];n.listenProvider_.stopListening(gl(d),bl(n,d))}}return o}var TE=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},SE=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=ze(this.path_,e);return new n(this.syncTree_,t)}node(){return Vp(this.syncTree_,this.path_)}},z4=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},ER=function(n,e,t){if(!n||typeof n!="object")return n;if(L(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return W4(n[".sv"],e,t);if(typeof n[".sv"]=="object")return K4(n[".sv"],e);L(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},W4=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:L(!1,"Unexpected server value: "+n)}},K4=function(n,e,t){n.hasOwnProperty("increment")||L(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&L(!1,"Unexpected increment value: "+r);let i=e.node();if(L(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},vN=function(n,e,t,r){return dI(e,new SE(t,n),r)},lI=function(n,e,t){return dI(n,new TE(e),t)};function dI(n,e,t){let r=n.getPriority().val(),i=ER(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=ER(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new ba(a,Ke(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new ba(i))),o.forEachChild(Ue,(a,u)=>{let l=dI(u,e.getImmediateChild(a),t);l!==u&&(s=s.updateImmediateChild(a,l))}),s}}var Tl=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function jp(n,e){let t=e instanceof Me?e:new Me(e),r=n,i=fe(t);for(;i!==null;){let s=ci(r.node.children,i)||{children:{},childCount:0};r=new Tl(i,r,s),t=Ve(t),i=fe(t)}return r}function Hs(n){return n.node.value}function hI(n,e){n.node.value=e,AE(n)}function _N(n){return n.node.childCount>0}function Q4(n){return Hs(n)===void 0&&!_N(n)}function Up(n,e){wt(n.node.children,(t,r)=>{e(new Tl(t,n,r))})}function wN(n,e,t,r){t&&!r&&e(n),Up(n,i=>{wN(i,e,!0,r)}),t&&r&&e(n)}function Y4(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function kl(n){return new Me(n.parent===null?n.name:kl(n.parent)+"/"+n.name)}function AE(n){n.parent!==null&&Z4(n.parent,n.name,n)}function Z4(n,e,t){let r=Q4(t),i=wn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,AE(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,AE(n))}var J4=/[\[\].#$\/\u0000-\u001F\u007F]/,X4=/[\[\].#$\u0000-\u001F\u007F]/,jw=10*1024*1024,Bp=function(n){return typeof n=="string"&&n.length!==0&&!J4.test(n)},EN=function(n){return typeof n=="string"&&n.length!==0&&!X4.test(n)},ez=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),EN(n)},Sl=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Np(n)||n&&typeof n=="object"&&wn(n,".sv")},wr=function(n,e,t,r){r&&e===void 0||Ol(en(n,"value"),e,t)},Ol=function(n,e,t){let r=t instanceof Me?new Jw(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Vs(r));if(typeof e=="function")throw new Error(n+"contains a function "+Vs(r)+" with contents = "+e.toString());if(Np(e))throw new Error(n+"contains "+e.toString()+" "+Vs(r));if(typeof e=="string"&&e.length>jw/3&&Qu(e)>jw)throw new Error(n+"contains a string greater than "+jw+" utf8 bytes "+Vs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(wt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Bp(o)))throw new Error(n+" contains an invalid key ("+o+") "+Vs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);MG(r,o),Ol(n,a,r),RG(r)}),i&&s)throw new Error(n+' contains ".value" child '+Vs(r)+" in addition to actual children.")}},tz=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=yl(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Bp(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(xG);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&xn(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},IN=function(n,e,t,r){if(r&&e===void 0)return;let i=en(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];wt(e,(o,a)=>{let u=new Me(o);if(Ol(i,a,ze(t,u)),QE(u)===".priority"&&!Sl(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),tz(i,s)},fI=function(n,e,t){if(!(t&&e===void 0)){if(Np(e))throw new Error(en(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Sl(e))throw new Error(en(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Fl=function(n,e,t,r){if(!(r&&t===void 0)&&!Bp(t))throw new Error(en(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Oa=function(n,e,t,r){if(!(r&&t===void 0)&&!EN(t))throw new Error(en(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},nz=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Oa(n,e,t,r)},pn=function(n,e){if(fe(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},CN=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Bp(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!ez(t))throw new Error(en(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var xE=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function $p(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!YE(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function DN(n,e,t){$p(n,t),bN(n,r=>YE(r,e))}function gn(n,e,t){$p(n,t),bN(n,r=>xn(r,e)||xn(e,r))}function bN(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(rz(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function rz(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();js&&_t("event: "+t.toString()),Na(r)}}}var TN="repo_interrupt",iz=25,ME=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new xE,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=gp(),this.transactionQueueTree_=new Tl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function sz(n,e,t){if(n.stats_=KE(n.repoInfo_),n.forceRestClient_||sG())n.server_=new cE(n.repoInfo_,(r,i,s,o)=>{IR(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>CR(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ot(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new ZE(n.repoInfo_,e,(r,i,s,o)=>{IR(n,r,i,s,o)},r=>{CR(n,r)},r=>{oz(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=aG(n.repoInfo_,()=>new pE(n.stats_,n.server_)),n.infoData_=new lE,n.infoSyncTree_=new Dp({startListening:(r,i,s,o)=>{let a=[],u=n.infoData_.getNode(r._path);return u.isEmpty()||(a=Pl(n.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),pI(n,"connected",!1),n.serverSyncTree_=new Dp({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,u)=>{let l=o(a,u);gn(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function SN(n){let t=n.infoData_.getNode(new Me(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Vl(n){return z4({timestamp:SN(n)})}function IR(n,e,t,r,i){n.dataUpdateCount++;let s=new Me(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let u=Ku(t,l=>Ke(l));o=U4(n.serverSyncTree_,s,u,i)}else{let u=Ke(t);o=pN(n.serverSyncTree_,s,u,i)}else if(r){let u=Ku(t,l=>Ke(l));o=V4(n.serverSyncTree_,s,u)}else{let u=Ke(t);o=Pl(n.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Ma(n,s)),gn(n.eventQueue_,a,o)}function CR(n,e){pI(n,"connected",e),e===!1&&cz(n)}function oz(n,e){wt(e,(t,r)=>{pI(n,t,r)})}function pI(n,e,t){let r=new Me("/.info/"+e),i=Ke(t);n.infoData_.updateSnapshot(r,i);let s=Pl(n.infoSyncTree_,r,i);gn(n.eventQueue_,r,s)}function Hp(n){return n.nextWriteId_++}function az(n,e,t){let r=B4(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=Ke(i).withIndex(e._queryParams.getIndex());bE(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=Pl(n.serverSyncTree_,e._path,s);else{let a=bl(n.serverSyncTree_,e);o=pN(n.serverSyncTree_,e._path,s,a)}return gn(n.eventQueue_,e._path,o),bp(n.serverSyncTree_,e,t,null,!0),s},i=>(Fa(n,"get for query "+ot(e)+" failed: "+i),Promise.reject(new Error(i))))}function gI(n,e,t,r,i){Fa(n,"set",{path:e.toString(),value:t,priority:r});let s=Vl(n),o=Ke(t,r),a=Vp(n.serverSyncTree_,e),u=lI(o,a,s),l=Hp(n),d=oI(n.serverSyncTree_,e,u,l,!0);$p(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(g,y)=>{let _=g==="ok";_||Lt("set at "+e+" failed: "+g);let D=Ni(n.serverSyncTree_,l,!_);gn(n.eventQueue_,e,D),Li(n,i,g,y)});let f=yI(n,e);Ma(n,f),gn(n.eventQueue_,f,[])}function uz(n,e,t,r){Fa(n,"update",{path:e.toString(),value:t});let i=!0,s=Vl(n),o={};if(wt(t,(a,u)=>{i=!1,o[a]=vN(ze(e,a),Ke(u),n.serverSyncTree_,s)}),i)_t("update() called with empty data.  Don't do anything."),Li(n,r,"ok",void 0);else{let a=Hp(n),u=F4(n.serverSyncTree_,e,o,a);$p(n.eventQueue_,u),n.server_.merge(e.toString(),t,(l,d)=>{let f=l==="ok";f||Lt("update at "+e+" failed: "+l);let g=Ni(n.serverSyncTree_,a,!f),y=g.length>0?Ma(n,e):e;gn(n.eventQueue_,y,g),Li(n,r,l,d)}),wt(t,l=>{let d=yI(n,ze(e,l));Ma(n,d)}),gn(n.eventQueue_,e,[])}}function cz(n){Fa(n,"onDisconnectEvents");let e=Vl(n),t=gp();hE(n.onDisconnect_,xe(),(i,s)=>{let o=vN(i,s,n.serverSyncTree_,e);Pa(t,i,o)});let r=[];hE(t,xe(),(i,s)=>{r=r.concat(Pl(n.serverSyncTree_,i,s));let o=yI(n,i);Ma(n,o)}),n.onDisconnect_=gp(),gn(n.eventQueue_,xe(),r)}function lz(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&dE(n.onDisconnect_,e),Li(n,t,r,i)})}function DR(n,e,t,r){let i=Ke(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Pa(n.onDisconnect_,e,i),Li(n,r,s,o)})}function dz(n,e,t,r,i){let s=Ke(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Pa(n.onDisconnect_,e,s),Li(n,i,o,a)})}function hz(n,e,t,r){if(Xd(t)){_t("onDisconnect().update() called with empty data.  Don't do anything."),Li(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&wt(t,(o,a)=>{let u=Ke(a);Pa(n.onDisconnect_,ze(e,o),u)}),Li(n,r,i,s)})}function fz(n,e,t){let r;fe(e._path)===".info"?r=bE(n.infoSyncTree_,e,t):r=bE(n.serverSyncTree_,e,t),DN(n.eventQueue_,e._path,r)}function RE(n,e,t){let r;fe(e._path)===".info"?r=bp(n.infoSyncTree_,e,t):r=bp(n.serverSyncTree_,e,t),DN(n.eventQueue_,e._path,r)}function AN(n){n.persistentConnection_&&n.persistentConnection_.interrupt(TN)}function pz(n){n.persistentConnection_&&n.persistentConnection_.resume(TN)}function Fa(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),_t(t,...e)}function Li(n,e,t,r){e&&Na(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function gz(n,e,t,r,i,s){Fa(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:SR(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=mI(n,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Ol("transaction failed: Data returned ",u,o.path),o.status=0;let l=jp(n.transactionQueueTree_,e),d=Hs(l)||[];d.push(o),hI(l,d);let f;typeof u=="object"&&u!==null&&wn(u,".priority")?(f=ci(u,".priority"),L(Sl(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(Vp(n.serverSyncTree_,e)||ae.EMPTY_NODE).getPriority().val();let g=Vl(n),y=Ke(u,f),_=lI(y,a,g);o.currentOutputSnapshotRaw=y,o.currentOutputSnapshotResolved=_,o.currentWriteId=Hp(n);let D=oI(n.serverSyncTree_,e,_,o.currentWriteId,o.applyLocally);gn(n.eventQueue_,e,D),qp(n,n.transactionQueueTree_)}}function mI(n,e,t){return Vp(n.serverSyncTree_,e,t)||ae.EMPTY_NODE}function qp(n,e=n.transactionQueueTree_){if(e||Gp(n,e),Hs(e)){let t=MN(n,e);L(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&mz(n,kl(e),t)}else _N(e)&&Up(e,t=>{qp(n,t)})}function mz(n,e,t){let r=t.map(l=>l.currentWriteId),i=mI(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];L(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let f=Kt(e,d.path);s=s.updateChild(f,d.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;n.server_.put(u.toString(),a,l=>{Fa(n,"transaction put response",{path:u.toString(),status:l});let d=[];if(l==="ok"){let f=[];for(let g=0;g<t.length;g++)t[g].status=2,d=d.concat(Ni(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&f.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();Gp(n,jp(n.transactionQueueTree_,e)),qp(n,n.transactionQueueTree_),gn(n.eventQueue_,e,d);for(let g=0;g<f.length;g++)Na(f[g])}else{if(l==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{Lt("transaction at "+u.toString()+" failed: "+l);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=l}Ma(n,e)}},o)}function Ma(n,e){let t=xN(n,e),r=kl(t),i=MN(n,t);return yz(n,i,r),r}function yz(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],l=Kt(t,u.path),d=!1,f;if(L(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)d=!0,f=u.abortReason,i=i.concat(Ni(n.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=iz)d=!0,f="maxretry",i=i.concat(Ni(n.serverSyncTree_,u.currentWriteId,!0));else{let g=mI(n,u.path,o);u.currentInputSnapshot=g;let y=e[a].update(g.val());if(y!==void 0){Ol("transaction failed: Data returned ",y,u.path);let _=Ke(y);typeof y=="object"&&y!=null&&wn(y,".priority")||(_=_.updatePriority(g.getPriority()));let S=u.currentWriteId,k=Vl(n),U=lI(_,g,k);u.currentOutputSnapshotRaw=_,u.currentOutputSnapshotResolved=U,u.currentWriteId=Hp(n),o.splice(o.indexOf(S),1),i=i.concat(oI(n.serverSyncTree_,u.path,U,u.currentWriteId,u.applyLocally)),i=i.concat(Ni(n.serverSyncTree_,S,!0))}else d=!0,f="nodata",i=i.concat(Ni(n.serverSyncTree_,u.currentWriteId,!0))}gn(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}Gp(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)Na(r[a]);qp(n,n.transactionQueueTree_)}function xN(n,e){let t,r=n.transactionQueueTree_;for(t=fe(e);t!==null&&Hs(r)===void 0;)r=jp(r,t),e=Ve(e),t=fe(e);return r}function MN(n,e){let t=[];return RN(n,e,t),t.sort((r,i)=>r.order-i.order),t}function RN(n,e,t){let r=Hs(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Up(e,i=>{RN(n,i,t)})}function Gp(n,e){let t=Hs(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,hI(e,t.length>0?t:void 0)}Up(e,r=>{Gp(n,r)})}function yI(n,e){let t=kl(xN(n,e)),r=jp(n.transactionQueueTree_,e);return Y4(r,i=>{Uw(n,i)}),Uw(n,r),wN(r,i=>{Uw(n,i)}),t}function Uw(n,e){let t=Hs(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(L(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(L(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Ni(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?hI(e,void 0):t.length=s+1,gn(n.eventQueue_,kl(e),i);for(let o=0;o<r.length;o++)Na(r[o])}}function vz(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function _z(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Lt(`Invalid query segment '${t}' in query '${n}'`)}return e}var NE=function(n,e){let t=wz(n),r=t.namespace;t.domain==="firebase.com"&&vr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&vr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Yq();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new ap(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Me(t.pathString)}},wz=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",u=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let f=n.indexOf("?");f===-1&&(f=n.length),e=n.substring(0,Math.min(d,f)),d<f&&(i=vz(n.substring(d,f)));let g=_z(n.substring(Math.min(n.length,f)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(l+1),10)):l=e.length;let y=e.slice(0,l);if(y.toLowerCase()==="localhost")t="localhost";else if(y.split(".").length<=2)t=y;else{let _=e.indexOf(".");r=e.substring(0,_).toLowerCase(),t=e.substring(_+1),s=r}"ns"in g&&(s=g.ns)}return{host:e,port:u,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var bR="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Ez=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=bR.charAt(t%64),t=Math.floor(t/64);L(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=bR.charAt(e[i]);return L(o.length===20,"nextPushId: Length should be 20."),o}}();var Tp=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ot(this.snapshot.exportVal())}},Sp=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Al=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return L(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Ap=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new mt;return lz(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){pn("OnDisconnect.remove",this._path);let e=new mt;return DR(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){pn("OnDisconnect.set",this._path),wr("OnDisconnect.set",e,this._path,!1);let t=new mt;return DR(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){pn("OnDisconnect.setWithPriority",this._path),wr("OnDisconnect.setWithPriority",e,this._path,!1),fI("OnDisconnect.setWithPriority",t,!1);let r=new mt;return dz(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){pn("OnDisconnect.update",this._path),IN("OnDisconnect.update",e,this._path,!1);let t=new mt;return hz(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var Yt=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return pe(this._path)?null:QE(this._path)}get ref(){return new mn(this._repo,this._path)}get _queryIdentifier(){let e=dR(this._queryParams),t=WE(e);return t==="{}"?"default":t}get _queryObject(){return dR(this._queryParams)}isEqual(e){if(e=ye(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=YE(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+AG(this._path)}};function zp(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Ui(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===yr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Oi)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Wr)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===Ue){if(e!=null&&!Sl(e)||t!=null&&!Sl(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(L(n.getIndex()instanceof vl||n.getIndex()===XE,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Wp(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var mn=class n extends Yt{constructor(e,t){super(e,t,new Il,!1)}get parent(){let e=KR(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Ra=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new Me(e),r=ji(this.ref,e);return new n(this._node.getChild(t),r,Ue)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,ji(this.ref,r),Ue)))}hasChild(e){let t=new Me(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function vI(n,e){return n=ye(n),n._checkNotDeleted("ref"),e!==void 0?ji(n._root,e):n._root}function _I(n,e){n=ye(n),n._checkNotDeleted("refFromURL");let t=NE(e,n._repo.repoInfo_.nodeAdmin);CN("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&vr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),vI(n,t.path.toString())}function ji(n,e){return n=ye(n),fe(n._path)===null?nz("child","path",e,!1):Oa("child","path",e,!1),new mn(n._repo,ze(n._path,e))}function NN(n,e){n=ye(n),pn("push",n._path),wr("push",e,n._path,!0);let t=SN(n._repo),r=Ez(t),i=ji(n,r),s=ji(n,r),o;return e!=null?o=Kp(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function PN(n){return pn("remove",n._path),Kp(n,null)}function Kp(n,e){n=ye(n),pn("set",n._path),wr("set",e,n._path,!1);let t=new mt;return gI(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function kN(n,e){n=ye(n),pn("setPriority",n._path),fI("setPriority",e,!1);let t=new mt;return gI(n._repo,ze(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function ON(n,e,t){if(pn("setWithPriority",n._path),wr("setWithPriority",e,n._path,!1),fI("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new mt;return gI(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function FN(n,e){IN("update",e,n._path,!1);let t=new mt;return uz(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function VN(n){n=ye(n);let e=new Al(()=>{}),t=new xl(e);return az(n._repo,n,t).then(r=>new Ra(r,new mn(n._repo,n._path),n._queryParams.getIndex()))}var xl=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new Tp("value",this,new Ra(e.snapshotNode,new mn(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Sp(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},xp=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Sp(this,e,t):null}createEvent(e,t){L(e.childName!=null,"Child events should have a childName.");let r=ji(new mn(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Tp(e.type,this,new Ra(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Ll(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=t,l=(d,f)=>{RE(n._repo,n,a),u(d,f)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new Al(t,s||void 0),a=e==="value"?new xl(o):new xp(e,o);return fz(n._repo,n,a),()=>RE(n._repo,n,a)}function Qp(n,e,t,r){return Ll(n,"value",e,t,r)}function wI(n,e,t,r){return Ll(n,"child_added",e,t,r)}function EI(n,e,t,r){return Ll(n,"child_changed",e,t,r)}function II(n,e,t,r){return Ll(n,"child_moved",e,t,r)}function CI(n,e,t,r){return Ll(n,"child_removed",e,t,r)}function DI(n,e,t){let r=null,i=t?new Al(t):null;e==="value"?r=new xl(i):e&&(r=new xp(e,i)),RE(n._repo,n,r)}var yn=class{},Mp=class extends yn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){wr("endAt",this._value,e._path,!0);let t=uE(e._queryParams,this._value,this._key);if(Wp(t),Ui(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Yt(e._repo,e._path,t,e._orderByCalled)}};function LN(n,e){return Fl("endAt","key",e,!0),new Mp(n,e)}var PE=class extends yn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){wr("endBefore",this._value,e._path,!1);let t=WG(e._queryParams,this._value,this._key);if(Wp(t),Ui(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Yt(e._repo,e._path,t,e._orderByCalled)}};function jN(n,e){return Fl("endBefore","key",e,!0),new PE(n,e)}var Rp=class extends yn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){wr("startAt",this._value,e._path,!0);let t=aE(e._queryParams,this._value,this._key);if(Wp(t),Ui(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Yt(e._repo,e._path,t,e._orderByCalled)}};function UN(n=null,e){return Fl("startAt","key",e,!0),new Rp(n,e)}var kE=class extends yn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){wr("startAfter",this._value,e._path,!1);let t=zG(e._queryParams,this._value,this._key);if(Wp(t),Ui(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Yt(e._repo,e._path,t,e._orderByCalled)}};function BN(n,e){return Fl("startAfter","key",e,!0),new kE(n,e)}var OE=class extends yn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Yt(e._repo,e._path,qG(e._queryParams,this._limit),e._orderByCalled)}};function $N(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new OE(n)}var FE=class extends yn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Yt(e._repo,e._path,GG(e._queryParams,this._limit),e._orderByCalled)}};function HN(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new FE(n)}var VE=class extends yn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){zp(e,"orderByChild");let t=new Me(this._path);if(pe(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new vl(t),i=Pp(e._queryParams,r);return Ui(i),new Yt(e._repo,e._path,i,!0)}};function qN(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Oa("orderByChild","path",n,!1),new VE(n)}var LE=class extends yn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){zp(e,"orderByKey");let t=Pp(e._queryParams,yr);return Ui(t),new Yt(e._repo,e._path,t,!0)}};function GN(){return new LE}var jE=class extends yn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){zp(e,"orderByPriority");let t=Pp(e._queryParams,Ue);return Ui(t),new Yt(e._repo,e._path,t,!0)}};function zN(){return new jE}var UE=class extends yn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){zp(e,"orderByValue");let t=Pp(e._queryParams,XE);return Ui(t),new Yt(e._repo,e._path,t,!0)}};function WN(){return new UE}var BE=class extends yn{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(wr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Mp(this._value,this._key)._apply(new Rp(this._value,this._key)._apply(e))}};function KN(n,e){return Fl("equalTo","key",e,!0),new BE(n,e)}function Rn(n,...e){let t=ye(n);for(let r of e)t=r._apply(t);return t}A4(mn);P4(mn);var Iz="FIREBASE_DATABASE_EMULATOR_HOST",$E={},Cz=!1;function Dz(n,e,t,r){n.repoInfo_=new ap(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function bI(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||vr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_t("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=NE(s,i),a=o.repoInfo,u,l;typeof process<"u"&&process.env&&(l=process.env[Iz]),l?(u=!0,s=`http://${l}?ns=${a.namespace}`,o=NE(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let d=i&&u?new hl(hl.OWNER):new zw(n.name,n.options,e);CN("Invalid Firebase Database URL",o),pe(o.path)||vr("Database URL must point to the root of a Firebase Database (not including a child path).");let f=Tz(a,n,d,new Gw(n.name,t));return new HE(f,n)}function bz(n,e){let t=$E[e];(!t||t[n.key]!==n)&&vr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),AN(n),delete t[n.key]}function Tz(n,e,t,r){let i=$E[e.name];i||(i={},$E[e.name]=i);let s=i[n.toURLString()];return s&&vr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new ME(n,Cz,t,r),i[n.toURLString()]=s,s}var HE=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(sz(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new mn(this._repo,xe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(bz(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&vr("Cannot call "+e+" on a deleted database.")}};function QN(){WR.IS_TRANSPORT_INITIALIZED&&Lt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function YN(){QN(),ml.forceDisallow()}function ZN(){QN(),Ea.forceDisallow(),ml.forceAllow()}function JN(n,e,t,r={}){n=ye(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&vr("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&vr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new hl(hl.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Yd(r.mockUserToken,n.app.options.projectId);s=new hl(o)}Dz(i,e,t,s)}function XN(n){n=ye(n),n._checkNotDeleted("goOffline"),AN(n._repo)}function eP(n){n=ye(n),n._checkNotDeleted("goOnline"),pz(n._repo)}function tP(n,e){xR(n,e)}function Sz(n){zE(th),fs(new un("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return bI(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),Vn(KM,QM,n),Vn(KM,QM,"esm2017")}var Az={".sv":"timestamp"};function nP(){return Az}function rP(n){return{".sv":{increment:n}}}var qE=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function iP(n,e,t){var r;if(n=ye(n),pn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new mt,o=(u,l,d)=>{let f=null;u?s.reject(u):(f=new Ra(d,new mn(n._repo,n._path),Ue),s.resolve(new qE(l,f)))},a=Qp(n,()=>{});return gz(n._repo,n._path,e,o,a,i),s.promise}ZE.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};ZE.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};Sz();var xz="@firebase/database-compat",Mz="1.0.5";var Rz=new li("@firebase/database-compat"),sP=function(n){let e="FIREBASE WARNING: "+n;Rz.warn(e)};var Nz=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(en(n,e)+"must be a boolean.")},Pz=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(en(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var TI=class{constructor(e){this._delegate=e}cancel(e){ne("OnDisconnect.cancel",0,1,arguments.length),ft("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){ne("OnDisconnect.remove",0,1,arguments.length),ft("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){ne("OnDisconnect.set",1,2,arguments.length),ft("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ne("OnDisconnect.setWithPriority",2,3,arguments.length),ft("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(ne("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,sP("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ft("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var SI=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ne("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var qs=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return ne("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ne("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ne("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ne("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ne("DataSnapshot.child",0,1,arguments.length),e=String(e),Oa("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return ne("DataSnapshot.hasChild",1,1,arguments.length),Oa("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ne("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ne("DataSnapshot.forEach",1,1,arguments.length),ft("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return ne("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ne("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ne("DataSnapshot.ref",0,0,arguments.length),new Kr(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Yp=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;ne("Query.on",2,4,arguments.length),ft("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new qs(this.database,l),d)};a.userCallback=t,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Qp(this._delegate,a,u),t;case"child_added":return wI(this._delegate,a,u),t;case"child_removed":return CI(this._delegate,a,u),t;case"child_changed":return EI(this._delegate,a,u),t;case"child_moved":return II(this._delegate,a,u),t;default:throw new Error(en("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(ne("Query.off",0,3,arguments.length),Pz("Query.off",e,!0),ft("Query.off","callback",t,!0),sy("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,DI(this._delegate,e,i)}else DI(this._delegate,e)}get(){return VN(this._delegate).then(e=>new qs(this.database,e))}once(e,t,r,i){ne("Query.once",1,4,arguments.length),ft("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new mt,a=(l,d)=>{let f=new qs(this.database,l);t&&t.call(s.context,f,d),o.resolve(f)};a.userCallback=t,a.context=s.context;let u=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Qp(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":wI(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":CI(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":EI(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":II(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(en("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ne("Query.limitToFirst",1,1,arguments.length),new n(this.database,Rn(this._delegate,$N(e)))}limitToLast(e){return ne("Query.limitToLast",1,1,arguments.length),new n(this.database,Rn(this._delegate,HN(e)))}orderByChild(e){return ne("Query.orderByChild",1,1,arguments.length),new n(this.database,Rn(this._delegate,qN(e)))}orderByKey(){return ne("Query.orderByKey",0,0,arguments.length),new n(this.database,Rn(this._delegate,GN()))}orderByPriority(){return ne("Query.orderByPriority",0,0,arguments.length),new n(this.database,Rn(this._delegate,zN()))}orderByValue(){return ne("Query.orderByValue",0,0,arguments.length),new n(this.database,Rn(this._delegate,WN()))}startAt(e=null,t){return ne("Query.startAt",0,2,arguments.length),new n(this.database,Rn(this._delegate,UN(e,t)))}startAfter(e=null,t){return ne("Query.startAfter",0,2,arguments.length),new n(this.database,Rn(this._delegate,BN(e,t)))}endAt(e=null,t){return ne("Query.endAt",0,2,arguments.length),new n(this.database,Rn(this._delegate,LN(e,t)))}endBefore(e=null,t){return ne("Query.endBefore",0,2,arguments.length),new n(this.database,Rn(this._delegate,jN(e,t)))}equalTo(e,t){return ne("Query.equalTo",1,2,arguments.length),new n(this.database,Rn(this._delegate,KN(e,t)))}toString(){return ne("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ne("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ne("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,ft(e,"cancel",i.cancel,!0),i.context=r,sy(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(en(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Kr(this.database,new mn(this._delegate._repo,this._delegate._path))}},Kr=class n extends Yp{constructor(e,t){super(e,new Yt(t._repo,t._path,new Il,!1)),this.database=e,this._delegate=t}getKey(){return ne("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ne("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,ji(this._delegate,e))}getParent(){ne("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return ne("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){ne("Reference.set",1,2,arguments.length),ft("Reference.set","onComplete",t,!0);let r=Kp(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(ne("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,sP("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}pn("Reference.update",this._delegate._path),ft("Reference.update","onComplete",t,!0);let r=FN(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ne("Reference.setWithPriority",2,3,arguments.length),ft("Reference.setWithPriority","onComplete",r,!0);let i=ON(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ne("Reference.remove",0,1,arguments.length),ft("Reference.remove","onComplete",e,!0);let t=PN(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){ne("Reference.transaction",1,3,arguments.length),ft("Reference.transaction","transactionUpdate",e,!1),ft("Reference.transaction","onComplete",t,!0),Nz("Reference.transaction","applyLocally",r,!0);let i=iP(this._delegate,e,{applyLocally:r}).then(s=>new SI(s.committed,new qs(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){ne("Reference.setPriority",1,2,arguments.length),ft("Reference.setPriority","onComplete",t,!0);let r=kN(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){ne("Reference.push",0,2,arguments.length),ft("Reference.push","onComplete",t,!0);let r=NN(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return pn("Reference.onDisconnect",this._delegate._path),new TI(new Ap(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Gs=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:YN,forceLongPolling:ZN}}useEmulator(e,t,r={}){JN(this._delegate,e,t,r)}ref(e){if(ne("database.ref",0,1,arguments.length),e instanceof Kr){let t=_I(this._delegate,e.toString());return new Kr(this,t)}else{let t=vI(this._delegate,e);return new Kr(this,t)}}refFromURL(e){ne("database.refFromURL",1,1,arguments.length);let r=_I(this._delegate,e);return new Kr(this,r)}goOffline(){return ne("database.goOffline",0,0,arguments.length),XN(this._delegate)}goOnline(){return ne("database.goOnline",0,0,arguments.length),eP(this._delegate)}};Gs.ServerValue={TIMESTAMP:nP(),increment:n=>rP(n)};function kz({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){zE(t);let a=new oy("database-standalone"),u=new eh("auth-internal",a);u.setComponent(new un("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new eh("app-check-internal",a),l.setComponent(new un("app-check-internal",()=>i,"PRIVATE"))),{instance:new Gs(bI(n,u,l,e,o),n),namespace:s}}var Oz=Object.freeze({__proto__:null,initStandalone:kz});var Fz=Gs.ServerValue;function Vz(n){n.INTERNAL.registerComponent(new un("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Gs(i,r)},"PUBLIC").setServiceProps({Reference:Kr,Query:Yp,Database:Gs,DataSnapshot:qs,enableLogging:tP,INTERNAL:Oz,ServerValue:Fz}).setMultipleInstances(!0)),n.registerVersion(xz,Mz)}Vz(yt);function jl(n,e,t="on",r=vs){return new de(i=>{let s=null;return s=n[t](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),t==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),t==="on"?{unsubscribe(){s!=null&&n.off(e,s)}}:{unsubscribe(){}}}).pipe(Q(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),nc())}function Lz(n){return typeof n=="string"}function jz(n){return typeof n.exportVal=="function"}function lP(n){return n==null}function dP(n){return typeof n.set=="function"}function oP(n,e){return dP(e)?e:n.ref(e)}function hP(n,e){if(Lz(n))return e.stringCase();if(dP(n))return e.firebaseCase();if(jz(n))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof n}`)}function fP(n){return(lP(n)||n.length===0)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function pP(n,e,t){e=fP(e);let r=e.map(i=>jl(n,i,"on",t));return Fo(...r)}function Uz(n,e,t){let r=pP(n,e).pipe(ir((i,s)=>[...i,s],[]));return $z(n,r,t)}function Bz(n,e){return jl(n,"value","on",e).pipe(Q(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}function $z(n,e,t){return Bz(n,t).pipe(xy(e),Q(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),Sy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),Q(i=>i.actions))}function aP(n,e){return function(r,i){return hP(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function Hz(n){return function(t){return t?hP(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function qz(n,e,t){return jl(n,"value","once",t).pipe(Ge(r=>{let i=[Z(r)];return e.forEach(s=>i.push(jl(n,s,"on",t))),Fo(...i).pipe(ir(zz,[]))}),Xu())}function gP(n,e){let t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function Gz(n,e){if(lP(e))return 0;{let t=gP(n,e);return t===-1?n.length:t+1}}function zz(n,e){let{payload:t,prevKey:r,key:i}=e,s=gP(n,i),o=Gz(n,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let l={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,n=[...n,l],!1})}return n;case"child_added":if(s>-1)(n[s-1]?.key||null)!==r&&(n=n.filter(u=>u.payload.key!==t.key),n.splice(o,0,e));else{if(r==null)return[e,...n];n=n.slice(),n.splice(o,0,e)}return n;case"child_removed":return n.filter(a=>a.payload.key!==t.key);case"child_changed":return n.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=n.splice(s,1)[0];return n=n.slice(),n.splice(o,0,a),n}return n;default:return n}}function uP(n,e,t){return e=fP(e),qz(n,e,t)}function Wz(n,e){let t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:aP(r,"update"),set:aP(r,"set"),push:i=>r.push(i),remove:Hz(r),snapshotChanges(i){return uP(n,i,t).pipe(nt)},stateChanges(i){return pP(n,i,t).pipe(nt)},auditTrail(i){return Uz(n,i,t).pipe(nt)},valueChanges(i,s){return uP(n,i,t).pipe(Q(a=>a.map(u=>s&&s.idField?Ae(q({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),nt)}}}function cP(n,e){return function(){return jl(n,"value","on",e)}}function Kz(n,e){return{query:n,snapshotChanges(){return cP(n,e.schedulers.outsideAngular)().pipe(nt)},update(t){return n.ref.update(t)},set(t){return n.ref.set(t)},remove(){return n.ref.remove()},valueChanges(){return cP(n,e.schedulers.outsideAngular)().pipe(nt,Q(r=>r.payload.exists()?r.payload.val():null))}}}var Qz=new z("angularfire2.realtimeDatabaseURL"),Yz=new z("angularfire2.database.use-emulator"),AI=(()=>{class n{schedulers;database;constructor(t,r,i,s,o,a,u,l,d,f,g,y,_,D,S){this.schedulers=a;let k=u,U=Fs(t,o,r);l&&ol(U,o,d,g,y,_,f,D),this.database=va(`${U.name}.database.${i}`,"AngularFireDatabase",U.name,()=>{let F=o.runOutsideAngular(()=>U.database(i||void 0));return k&&F.useEmulator(...k),F},[k])}list(t,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>oP(this.database,t)),s=i;return r&&(s=r(i)),Wz(s,this)}object(t){let r=this.schedulers.ngZone.runOutsideAngular(()=>oP(this.database,t));return Kz(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||n)(V(Mi),V(Ri,8),V(Qz,8),V(Vt),V(Te),V(ya),V(Yz,8),V(_a,8),V(el,8),V(tl,8),V(nl,8),V(rl,8),V(il,8),V(sl,8),V(zr,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),mP=(()=>{class n{constructor(){yt.registerVersion("angularfire",Ai.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Wt({type:n});static \u0275inj=zt({providers:[AI]})}return n})();var Zp=(()=>{let e=class e{constructor(r){this.db=r,this.dbPath="/expenses",this.expensesRef=r.list(this.dbPath),console.log(this.expensesRef)}getAllExpenses(){return this.expensesRef}getExpense(r){return this.db.object(`${this.dbPath}/${r}`)}addExpense(r){return this.expensesRef.push(r)}updateExpense(r,i){return this.expensesRef.update(r,i)}deleteExpense(r){return this.expensesRef.remove(r)}};e.\u0275fac=function(i){return new(i||e)(V(AI))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Jz(n,e){if(n&1){let t=lx();je(0,"div",4)(1,"div",5)(2,"h5",6),tt(3),Fe(),je(4,"h2",7),tt(5),Fe(),je(6,"p",8),tt(7),Fe(),je(8,"div",9)(9,"button",10),Kn("click",function(){let i=Wv(t).$implicit,s=I_();return Kv(s.editExpense(i.key))}),tt(10,"Edit"),Fe(),je(11,"button",11),Kn("click",function(){let i=Wv(t).$implicit,s=I_();return Kv(s.removeExpense(i.key))}),tt(12,"remove"),Fe()()()()}if(n&2){let t=e.$implicit;Wn(3),Af(t.title),Wn(2),Tc("",t.price,"$ "),Wn(2),Af(t.description)}}var vP=(()=>{let e=class e{constructor(r,i){this.expenseService=r,this.router=i,this.expenses=[],this.totalExpense=0,this.expenseKey=""}ngOnChanges(r){this.getAllExpenses(),console.log(r)}ngOnInit(){this.getAllExpenses()}getAllExpenses(){this.expenseService.getAllExpenses().snapshotChanges().subscribe({next:r=>{r.forEach(i=>{let s=i.payload.toJSON();this.totalExpense+=parseInt(s.price),this.expenses.push({key:i.key||"",title:s.title,price:s.price,description:s.description})})}})}editExpense(r){this.router.navigate(["/expense-form",r])}removeExpense(r){window.confirm("Are you sure?")&&this.expenseService.deleteExpense(r).then(()=>{let i=this.expenses.findIndex(s=>s.key===r);i>-1&&(this.totalExpense-=parseInt(this.expenses[i].price),this.expenses.splice(i,1))}).catch(i=>{console.error("Error removing expense:",i)})}};e.\u0275fac=function(i){return new(i||e)(Ee(Zp),Ee(fn))},e.\u0275cmp=_i({type:e,selectors:[["app-expense"]],standalone:!0,features:[lr,Ci],decls:9,vars:1,consts:[[1,"d-flex","mb-4","justify-content-between","align-items-center"],["type","button","routerLink","/expense-form",1,"btn","btn-primary"],[1,"fw-bold"],[1,"text-success"],[1,"card","mt-3"],[1,"card-body"],[1,"card-title"],[1,"fw-bold","text-success"],[1,"card-description"],[1,"d-flex","gap-2"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"]],template:function(i,s){i&1&&(je(0,"div",0)(1,"button",1),tt(2,"Add Expense"),Fe(),je(3,"h5",2),tt(4,"total expense: "),je(5,"strong",3),tt(6),Fe()()(),ux(7,Jz,13,3,"div",4,ax)),i&2&&(Wn(6),Tc("",s.totalExpense,"$"),Wn(),cx(s.expenses))},dependencies:[xM,IM]});let n=e;return n})();var SP=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(Ee(Rs),Ee(Ei))},e.\u0275dir=cn({type:e});let n=e;return n})(),Xz=(()=>{let e=class e extends SP{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Cc(e)))(s||e)}})(),e.\u0275dir=cn({type:e,features:[Ii]});let n=e;return n})(),AP=new z("");var e9={provide:AP,useExisting:ta(()=>sg),multi:!0};function t9(){let n=qr()?qr().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var n9=new z(""),sg=(()=>{let e=class e extends SP{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!t9())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(Ee(Rs),Ee(Ei),Ee(n9,8))},e.\u0275dir=cn({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Kn("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[xf([e9]),Ii]});let n=e;return n})();function $i(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function xP(n){return n!=null&&typeof n.length=="number"}var MP=new z(""),RP=new z(""),r9=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,La=class{static min(e){return i9(e)}static max(e){return s9(e)}static required(e){return o9(e)}static requiredTrue(e){return a9(e)}static email(e){return u9(e)}static minLength(e){return c9(e)}static maxLength(e){return l9(e)}static pattern(e){return d9(e)}static nullValidator(e){return NP(e)}static compose(e){return LP(e)}static composeAsync(e){return UP(e)}};function i9(n){return e=>{if($i(e.value)||$i(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function s9(n){return e=>{if($i(e.value)||$i(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function o9(n){return $i(n.value)?{required:!0}:null}function a9(n){return n.value===!0?null:{required:!0}}function u9(n){return $i(n.value)||r9.test(n.value)?null:{email:!0}}function c9(n){return e=>$i(e.value)||!xP(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function l9(n){return e=>xP(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function d9(n){if(!n)return NP;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if($i(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function NP(n){return null}function PP(n){return n!=null}function kP(n){return Ns(n)?be(n):n}function OP(n){let e={};return n.forEach(t=>{e=t!=null?q(q({},e),t):e}),Object.keys(e).length===0?null:e}function FP(n,e){return e.map(t=>t(n))}function h9(n){return!n.validate}function VP(n){return n.map(e=>h9(e)?e:t=>e.validate(t))}function LP(n){if(!n)return null;let e=n.filter(PP);return e.length==0?null:function(t){return OP(FP(t,e))}}function jP(n){return n!=null?LP(VP(n)):null}function UP(n){if(!n)return null;let e=n.filter(PP);return e.length==0?null:function(t){let r=FP(t,e).map(kP);return Cy(r).pipe(Q(OP))}}function BP(n){return n!=null?UP(VP(n)):null}function _P(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function $P(n){return n._rawValidators}function HP(n){return n._rawAsyncValidators}function xI(n){return n?Array.isArray(n)?n:[n]:[]}function Xp(n,e){return Array.isArray(n)?n.includes(e):n===e}function wP(n,e){let t=xI(e);return xI(n).forEach(i=>{Xp(t,i)||t.push(i)}),t}function EP(n,e){return xI(e).filter(t=>!Xp(n,t))}var eg=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=jP(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=BP(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},ja=class extends eg{get formDirective(){return null}get path(){return null}},$l=class extends eg{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},tg=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},f9={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},hee=Ae(q({},f9),{"[class.ng-submitted]":"isSubmitted"}),qP=(()=>{let e=class e extends tg{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Ee($l,2))},e.\u0275dir=cn({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Tf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Ii]});let n=e;return n})(),GP=(()=>{let e=class e extends tg{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Ee(ja,10))},e.\u0275dir=cn({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Tf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Ii]});let n=e;return n})();var Ul="VALID",Jp="INVALID",Va="PENDING",Bl="DISABLED";function NI(n){return(og(n)?n.validators:n)||null}function p9(n){return Array.isArray(n)?jP(n):n||null}function PI(n,e){return(og(e)?e.asyncValidators:n)||null}function g9(n){return Array.isArray(n)?BP(n):n||null}function og(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function zP(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new ee(1e3,"");if(!r[t])throw new ee(1001,"")}function WP(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new ee(1002,"")})}var Ua=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Ul}get invalid(){return this.status===Jp}get pending(){return this.status==Va}get disabled(){return this.status===Bl}get enabled(){return this.status!==Bl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(wP(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(wP(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(EP(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(EP(e,this._rawAsyncValidators))}hasValidator(e){return Xp(this._rawValidators,e)}hasAsyncValidator(e){return Xp(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Va,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Bl,this.errors=null,this._forEachChild(r=>{r.disable(Ae(q({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Ae(q({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ul,this._forEachChild(r=>{r.enable(Ae(q({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Ae(q({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ul||this.status===Va)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Bl:Ul}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Va,this._hasOwnPendingAsyncValidator=!0;let t=kP(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Pt,this.statusChanges=new Pt}_calculateStatus(){return this._allControlsDisabled()?Bl:this.errors?Jp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Va)?Va:this._anyControlsHaveStatus(Jp)?Jp:Ul}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){og(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=p9(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=g9(this._rawAsyncValidators)}},ng=class extends Ua{constructor(e,t,r){super(NI(t),PI(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){WP(this,!0,e),Object.keys(e).forEach(r=>{zP(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var MI=class extends ng{};var KP=new z("CallSetDisabledState",{providedIn:"root",factory:()=>kI}),kI="always";function m9(n,e){return[...e.path,n]}function IP(n,e,t=kI){OI(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),v9(n,e),w9(n,e),_9(n,e),y9(n,e)}function CP(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),ig(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function rg(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function y9(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function OI(n,e){let t=$P(n);e.validator!==null?n.setValidators(_P(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=HP(n);e.asyncValidator!==null?n.setAsyncValidators(_P(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();rg(e._rawValidators,i),rg(e._rawAsyncValidators,i)}function ig(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=$P(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=HP(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return rg(e._rawValidators,r),rg(e._rawAsyncValidators,r),t}function v9(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&QP(n,e)})}function _9(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&QP(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function QP(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function w9(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function E9(n,e){n==null,OI(n,e)}function I9(n,e){return ig(n,e)}function C9(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function D9(n){return Object.getPrototypeOf(n.constructor)===Xz}function b9(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function T9(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===sg?t=s:D9(s)?r=s:i=s}),i||r||t||null}function S9(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function DP(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function bP(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Bi=class extends Ua{constructor(e=null,t,r){super(NI(t),PI(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),og(t)&&(t.nonNullable||t.initialValueIsDefault)&&(bP(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){DP(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){DP(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){bP(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var A9=n=>n instanceof Bi;var YP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=cn({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let n=e;return n})();var ZP=new z("");var x9={provide:ja,useExisting:ta(()=>FI)},FI=(()=>{let e=class e extends ja{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Pt,this._setValidators(r),this._setAsyncValidators(i)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ig(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let i=this.form.get(r.path);return IP(i,r,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),i}getControl(r){return this.form.get(r.path)}removeControl(r){CP(r.control||null,r,!1),S9(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,i){this.form.get(r.path).setValue(i)}onSubmit(r){return this.submitted=!0,b9(this.form,this.directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_updateDomValue(){this.directives.forEach(r=>{let i=r.control,s=this.form.get(r.path);i!==s&&(CP(i||null,r),A9(s)&&(IP(s,r,this.callSetDisabledState),r.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let i=this.form.get(r.path);E9(i,r),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let i=this.form.get(r.path);i&&I9(i,r)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){OI(this.form,this),this._oldForm&&ig(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(Ee(MP,10),Ee(RP,10),Ee(KP,8))},e.\u0275dir=cn({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&Kn("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:[Ot.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[xf([x9]),Ii,lr]});let n=e;return n})();var M9={provide:$l,useExisting:ta(()=>VI)},VI=(()=>{let e=class e extends $l{set isDisabled(r){}constructor(r,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new Pt,this._ngModelWarningSent=!1,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=T9(this,o)}ngOnChanges(r){this._added||this._setUpControl(),C9(r,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}get path(){return m9(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(Ee(ja,13),Ee(MP,10),Ee(RP,10),Ee(AP,10),Ee(ZP,8))},e.\u0275dir=cn({type:e,selectors:[["","formControlName",""]],inputs:{name:[Ot.None,"formControlName","name"],isDisabled:[Ot.None,"disabled","isDisabled"],model:[Ot.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[xf([M9]),Ii,lr]});let n=e;return n})();var R9=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Wt({type:e}),e.\u0275inj=zt({});let n=e;return n})(),RI=class extends Ua{constructor(e,t,r){super(NI(t),PI(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){WP(this,!1,e),e.forEach((r,i)=>{zP(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function TP(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var JP=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let r=new e;return r.useNonNullable=!0,r}group(r,i=null){let s=this._reduceControls(r),o={};return TP(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new ng(s,o)}record(r,i=null){let s=this._reduceControls(r);return new MI(s,i)}control(r,i,s){let o={};return this.useNonNullable?(TP(i)?o=i:(o.validators=i,o.asyncValidators=s),new Bi(r,Ae(q({},o),{nonNullable:!0}))):new Bi(r,i,s)}array(r,i,s){let o=r.map(a=>this._createControl(a));return new RI(o,i,s)}_reduceControls(r){let i={};return Object.keys(r).forEach(s=>{i[s]=this._createControl(r[s])}),i}_createControl(r){if(r instanceof Bi)return r;if(r instanceof Ua)return r;if(Array.isArray(r)){let i=r[0],s=r.length>1?r[1]:null,o=r.length>2?r[2]:null;return this.control(i,s,o)}else return this.control(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var XP=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:ZP,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:KP,useValue:r.callSetDisabledState??kI}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Wt({type:e}),e.\u0275inj=zt({imports:[R9]});let n=e;return n})();function P9(n,e){n&1&&(je(0,"p",7),tt(1," this field is required "),Fe())}function k9(n,e){n&1&&(je(0,"p",7),tt(1," this field must be a number "),Fe())}function O9(n,e){n&1&&(je(0,"p",7),tt(1," this field is required "),Fe())}var LI=(()=>{let e=class e{constructor(r,i,s,o){this.fb=r,this.expenseService=i,this.router=s,this.activatedRoute=o,this.expenseForm=this.fb.group({price:new Bi("",[La.required,La.pattern("[0-9]+")]),title:new Bi("",[La.required]),description:new Bi("")})}ngOnInit(){this.activatedRoute.params.subscribe({next:r=>{this.expenseKey=r.id,this.getExpense(this.expenseKey)}})}onSubmit(){this.expenseForm.valid?(this.expenseKey==null?this.expenseService.addExpense(this.expenseForm.value):this.expenseService.updateExpense(this.expenseKey,this.expenseForm.value),this.router.navigate(["/"])):this.expenseForm.markAllAsTouched()}getExpense(r){this.expenseService.getExpense(r).snapshotChanges().subscribe({next:i=>{let s=i.payload.toJSON();this.expenseForm.setValue(s)}})}updateExpense(r,i){this.expenseService.updateExpense(r,i)}};e.\u0275fac=function(i){return new(i||e)(Ee(JP),Ee(Zp),Ee(fn),Ee(pr))},e.\u0275cmp=_i({type:e,selectors:[["app-expense-form"]],standalone:!0,features:[Ci],decls:22,vars:4,consts:[[1,"row"],[1,"col-md-6"],[1,"mb-2"],[3,"submit","formGroup"],[1,"mb-3"],["for","price",1,"form-label"],["type","text","id","price","placeholder","price","formControlName","price",1,"form-control"],[1,"text-danger"],["for","title",1,"form-label"],["type","text","id","title","placeholder","title","formControlName","title",1,"form-control"],["for","description",1,"form-label"],["id","description","rows","3","formControlName","description",1,"form-control"],["type","submit",1,"btn","btn-primary"]],template:function(i,s){if(i&1&&(je(0,"div",0)(1,"div",1)(2,"h4",2),tt(3,"Expense Form"),Fe(),je(4,"form",3),Kn("submit",function(){return s.onSubmit()}),je(5,"div",4)(6,"label",5),tt(7,"price"),Fe(),dr(8,"input",6),Xo(9,P9,2,0,"p",7)(10,k9,2,0,"p",7),Fe(),je(11,"div",4)(12,"label",8),tt(13,"title"),Fe(),dr(14,"input",9),Xo(15,O9,2,0,"p",7),Fe(),je(16,"div",4)(17,"label",10),tt(18,"description"),Fe(),dr(19,"textarea",11),Fe(),je(20,"button",12),tt(21,"update expense "),Fe()()()()),i&2){let o,a,u;Wn(4),E_("formGroup",s.expenseForm),Wn(5),Sf(9,(o=s.expenseForm.get("price"))!=null&&o.hasError("required")&&((o=s.expenseForm.get("price"))!=null&&o.touched)?9:-1),Wn(),Sf(10,(a=s.expenseForm.get("price"))!=null&&a.hasError("pattern")&&((a=s.expenseForm.get("price"))!=null&&a.touched)?10:-1),Wn(5),Sf(15,(u=s.expenseForm.get("title"))!=null&&u.hasError("required")&&((u=s.expenseForm.get("title"))!=null&&u.touched)?15:-1)}},dependencies:[M_,XP,YP,sg,qP,GP,FI,VI]});let n=e;return n})();var ek=[{path:"",component:vP},{path:"expense-form",component:LI},{path:"expense-form/:id",component:LI}];var tk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},nk={};var Hi,jI;(function(){var n;function e(I,v){function E(){}E.prototype=v.prototype,I.D=v.prototype,I.prototype=new E,I.prototype.constructor=I,I.C=function(C,b,A){for(var w=Array(arguments.length-2),Rr=2;Rr<arguments.length;Rr++)w[Rr-2]=arguments[Rr];return v.prototype[b].apply(C,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,v,E){E||(E=0);var C=Array(16);if(typeof v=="string")for(var b=0;16>b;++b)C[b]=v.charCodeAt(E++)|v.charCodeAt(E++)<<8|v.charCodeAt(E++)<<16|v.charCodeAt(E++)<<24;else for(b=0;16>b;++b)C[b]=v[E++]|v[E++]<<8|v[E++]<<16|v[E++]<<24;v=I.g[0],E=I.g[1],b=I.g[2];var A=I.g[3],w=v+(A^E&(b^A))+C[0]+3614090360&4294967295;v=E+(w<<7&4294967295|w>>>25),w=A+(b^v&(E^b))+C[1]+3905402710&4294967295,A=v+(w<<12&4294967295|w>>>20),w=b+(E^A&(v^E))+C[2]+606105819&4294967295,b=A+(w<<17&4294967295|w>>>15),w=E+(v^b&(A^v))+C[3]+3250441966&4294967295,E=b+(w<<22&4294967295|w>>>10),w=v+(A^E&(b^A))+C[4]+4118548399&4294967295,v=E+(w<<7&4294967295|w>>>25),w=A+(b^v&(E^b))+C[5]+1200080426&4294967295,A=v+(w<<12&4294967295|w>>>20),w=b+(E^A&(v^E))+C[6]+2821735955&4294967295,b=A+(w<<17&4294967295|w>>>15),w=E+(v^b&(A^v))+C[7]+4249261313&4294967295,E=b+(w<<22&4294967295|w>>>10),w=v+(A^E&(b^A))+C[8]+1770035416&4294967295,v=E+(w<<7&4294967295|w>>>25),w=A+(b^v&(E^b))+C[9]+2336552879&4294967295,A=v+(w<<12&4294967295|w>>>20),w=b+(E^A&(v^E))+C[10]+4294925233&4294967295,b=A+(w<<17&4294967295|w>>>15),w=E+(v^b&(A^v))+C[11]+2304563134&4294967295,E=b+(w<<22&4294967295|w>>>10),w=v+(A^E&(b^A))+C[12]+1804603682&4294967295,v=E+(w<<7&4294967295|w>>>25),w=A+(b^v&(E^b))+C[13]+4254626195&4294967295,A=v+(w<<12&4294967295|w>>>20),w=b+(E^A&(v^E))+C[14]+2792965006&4294967295,b=A+(w<<17&4294967295|w>>>15),w=E+(v^b&(A^v))+C[15]+1236535329&4294967295,E=b+(w<<22&4294967295|w>>>10),w=v+(b^A&(E^b))+C[1]+4129170786&4294967295,v=E+(w<<5&4294967295|w>>>27),w=A+(E^b&(v^E))+C[6]+3225465664&4294967295,A=v+(w<<9&4294967295|w>>>23),w=b+(v^E&(A^v))+C[11]+643717713&4294967295,b=A+(w<<14&4294967295|w>>>18),w=E+(A^v&(b^A))+C[0]+3921069994&4294967295,E=b+(w<<20&4294967295|w>>>12),w=v+(b^A&(E^b))+C[5]+3593408605&4294967295,v=E+(w<<5&4294967295|w>>>27),w=A+(E^b&(v^E))+C[10]+38016083&4294967295,A=v+(w<<9&4294967295|w>>>23),w=b+(v^E&(A^v))+C[15]+3634488961&4294967295,b=A+(w<<14&4294967295|w>>>18),w=E+(A^v&(b^A))+C[4]+3889429448&4294967295,E=b+(w<<20&4294967295|w>>>12),w=v+(b^A&(E^b))+C[9]+568446438&4294967295,v=E+(w<<5&4294967295|w>>>27),w=A+(E^b&(v^E))+C[14]+3275163606&4294967295,A=v+(w<<9&4294967295|w>>>23),w=b+(v^E&(A^v))+C[3]+4107603335&4294967295,b=A+(w<<14&4294967295|w>>>18),w=E+(A^v&(b^A))+C[8]+1163531501&4294967295,E=b+(w<<20&4294967295|w>>>12),w=v+(b^A&(E^b))+C[13]+2850285829&4294967295,v=E+(w<<5&4294967295|w>>>27),w=A+(E^b&(v^E))+C[2]+4243563512&4294967295,A=v+(w<<9&4294967295|w>>>23),w=b+(v^E&(A^v))+C[7]+1735328473&4294967295,b=A+(w<<14&4294967295|w>>>18),w=E+(A^v&(b^A))+C[12]+2368359562&4294967295,E=b+(w<<20&4294967295|w>>>12),w=v+(E^b^A)+C[5]+4294588738&4294967295,v=E+(w<<4&4294967295|w>>>28),w=A+(v^E^b)+C[8]+2272392833&4294967295,A=v+(w<<11&4294967295|w>>>21),w=b+(A^v^E)+C[11]+1839030562&4294967295,b=A+(w<<16&4294967295|w>>>16),w=E+(b^A^v)+C[14]+4259657740&4294967295,E=b+(w<<23&4294967295|w>>>9),w=v+(E^b^A)+C[1]+2763975236&4294967295,v=E+(w<<4&4294967295|w>>>28),w=A+(v^E^b)+C[4]+1272893353&4294967295,A=v+(w<<11&4294967295|w>>>21),w=b+(A^v^E)+C[7]+4139469664&4294967295,b=A+(w<<16&4294967295|w>>>16),w=E+(b^A^v)+C[10]+3200236656&4294967295,E=b+(w<<23&4294967295|w>>>9),w=v+(E^b^A)+C[13]+681279174&4294967295,v=E+(w<<4&4294967295|w>>>28),w=A+(v^E^b)+C[0]+3936430074&4294967295,A=v+(w<<11&4294967295|w>>>21),w=b+(A^v^E)+C[3]+3572445317&4294967295,b=A+(w<<16&4294967295|w>>>16),w=E+(b^A^v)+C[6]+76029189&4294967295,E=b+(w<<23&4294967295|w>>>9),w=v+(E^b^A)+C[9]+3654602809&4294967295,v=E+(w<<4&4294967295|w>>>28),w=A+(v^E^b)+C[12]+3873151461&4294967295,A=v+(w<<11&4294967295|w>>>21),w=b+(A^v^E)+C[15]+530742520&4294967295,b=A+(w<<16&4294967295|w>>>16),w=E+(b^A^v)+C[2]+3299628645&4294967295,E=b+(w<<23&4294967295|w>>>9),w=v+(b^(E|~A))+C[0]+4096336452&4294967295,v=E+(w<<6&4294967295|w>>>26),w=A+(E^(v|~b))+C[7]+1126891415&4294967295,A=v+(w<<10&4294967295|w>>>22),w=b+(v^(A|~E))+C[14]+2878612391&4294967295,b=A+(w<<15&4294967295|w>>>17),w=E+(A^(b|~v))+C[5]+4237533241&4294967295,E=b+(w<<21&4294967295|w>>>11),w=v+(b^(E|~A))+C[12]+1700485571&4294967295,v=E+(w<<6&4294967295|w>>>26),w=A+(E^(v|~b))+C[3]+2399980690&4294967295,A=v+(w<<10&4294967295|w>>>22),w=b+(v^(A|~E))+C[10]+4293915773&4294967295,b=A+(w<<15&4294967295|w>>>17),w=E+(A^(b|~v))+C[1]+2240044497&4294967295,E=b+(w<<21&4294967295|w>>>11),w=v+(b^(E|~A))+C[8]+1873313359&4294967295,v=E+(w<<6&4294967295|w>>>26),w=A+(E^(v|~b))+C[15]+4264355552&4294967295,A=v+(w<<10&4294967295|w>>>22),w=b+(v^(A|~E))+C[6]+2734768916&4294967295,b=A+(w<<15&4294967295|w>>>17),w=E+(A^(b|~v))+C[13]+1309151649&4294967295,E=b+(w<<21&4294967295|w>>>11),w=v+(b^(E|~A))+C[4]+4149444226&4294967295,v=E+(w<<6&4294967295|w>>>26),w=A+(E^(v|~b))+C[11]+3174756917&4294967295,A=v+(w<<10&4294967295|w>>>22),w=b+(v^(A|~E))+C[2]+718787259&4294967295,b=A+(w<<15&4294967295|w>>>17),w=E+(A^(b|~v))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(b+(w<<21&4294967295|w>>>11))&4294967295,I.g[2]=I.g[2]+b&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.u=function(I,v){v===void 0&&(v=I.length);for(var E=v-this.blockSize,C=this.B,b=this.h,A=0;A<v;){if(b==0)for(;A<=E;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<v;)if(C[b++]=I.charCodeAt(A++),b==this.blockSize){i(this,C),b=0;break}}else for(;A<v;)if(C[b++]=I[A++],b==this.blockSize){i(this,C),b=0;break}}this.h=b,this.o+=v},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;var E=8*this.o;for(v=I.length-8;v<I.length;++v)I[v]=E&255,E/=256;for(this.u(I),I=Array(16),v=E=0;4>v;++v)for(var C=0;32>C;C+=8)I[E++]=this.g[v]>>>C&255;return I};function s(I,v){var E=a;return Object.prototype.hasOwnProperty.call(E,I)?E[I]:E[I]=v(I)}function o(I,v){this.h=v;for(var E=[],C=!0,b=I.length-1;0<=b;b--){var A=I[b]|0;C&&A==v||(E[b]=A,C=!1)}this.g=E}var a={};function u(I){return-128<=I&&128>I?s(I,function(v){return new o([v|0],0>v?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return f;if(0>I)return S(l(-I));for(var v=[],E=1,C=0;I>=E;C++)v[C]=I/E|0,E*=4294967296;return new o(v,0)}function d(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return S(d(I.substring(1),v));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(v,8)),C=f,b=0;b<I.length;b+=8){var A=Math.min(8,I.length-b),w=parseInt(I.substring(b,b+A),v);8>A?(A=l(Math.pow(v,A)),C=C.j(A).add(l(w))):(C=C.j(E),C=C.add(l(w)))}return C}var f=u(0),g=u(1),y=u(16777216);n=o.prototype,n.m=function(){if(D(this))return-S(this).m();for(var I=0,v=1,E=0;E<this.g.length;E++){var C=this.i(E);I+=(0<=C?C:4294967296+C)*v,v*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(_(this))return"0";if(D(this))return"-"+S(this).toString(I);for(var v=l(Math.pow(I,6)),E=this,C="";;){var b=W(E,v).g;E=k(E,b.j(v));var A=((0<E.g.length?E.g[0]:E.h)>>>0).toString(I);if(E=b,_(E))return A+C;for(;6>A.length;)A="0"+A;C=A+C}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function _(I){if(I.h!=0)return!1;for(var v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function D(I){return I.h==-1}n.l=function(I){return I=k(this,I),D(I)?-1:_(I)?0:1};function S(I){for(var v=I.g.length,E=[],C=0;C<v;C++)E[C]=~I.g[C];return new o(E,~I.h).add(g)}n.abs=function(){return D(this)?S(this):this},n.add=function(I){for(var v=Math.max(this.g.length,I.g.length),E=[],C=0,b=0;b<=v;b++){var A=C+(this.i(b)&65535)+(I.i(b)&65535),w=(A>>>16)+(this.i(b)>>>16)+(I.i(b)>>>16);C=w>>>16,A&=65535,w&=65535,E[b]=w<<16|A}return new o(E,E[E.length-1]&-2147483648?-1:0)};function k(I,v){return I.add(S(v))}n.j=function(I){if(_(this)||_(I))return f;if(D(this))return D(I)?S(this).j(S(I)):S(S(this).j(I));if(D(I))return S(this.j(S(I)));if(0>this.l(y)&&0>I.l(y))return l(this.m()*I.m());for(var v=this.g.length+I.g.length,E=[],C=0;C<2*v;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var b=0;b<I.g.length;b++){var A=this.i(C)>>>16,w=this.i(C)&65535,Rr=I.i(b)>>>16,Au=I.i(b)&65535;E[2*C+2*b]+=w*Au,U(E,2*C+2*b),E[2*C+2*b+1]+=A*Au,U(E,2*C+2*b+1),E[2*C+2*b+1]+=w*Rr,U(E,2*C+2*b+1),E[2*C+2*b+2]+=A*Rr,U(E,2*C+2*b+2)}for(C=0;C<v;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=v;C<2*v;C++)E[C]=0;return new o(E,0)};function U(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function F(I,v){this.g=I,this.h=v}function W(I,v){if(_(v))throw Error("division by zero");if(_(I))return new F(f,f);if(D(I))return v=W(S(I),v),new F(S(v.g),S(v.h));if(D(v))return v=W(I,S(v)),new F(S(v.g),v.h);if(30<I.g.length){if(D(I)||D(v))throw Error("slowDivide_ only works with positive integers.");for(var E=g,C=v;0>=C.l(I);)E=te(E),C=te(C);var b=X(E,1),A=X(C,1);for(C=X(C,2),E=X(E,2);!_(C);){var w=A.add(C);0>=w.l(I)&&(b=b.add(E),A=w),C=X(C,1),E=X(E,1)}return v=k(I,b.j(v)),new F(b,v)}for(b=f;0<=I.l(v);){for(E=Math.max(1,Math.floor(I.m()/v.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),A=l(E),w=A.j(v);D(w)||0<w.l(I);)E-=C,A=l(E),w=A.j(v);_(A)&&(A=g),b=b.add(A),I=k(I,w)}return new F(b,I)}n.A=function(I){return W(this,I).h},n.and=function(I){for(var v=Math.max(this.g.length,I.g.length),E=[],C=0;C<v;C++)E[C]=this.i(C)&I.i(C);return new o(E,this.h&I.h)},n.or=function(I){for(var v=Math.max(this.g.length,I.g.length),E=[],C=0;C<v;C++)E[C]=this.i(C)|I.i(C);return new o(E,this.h|I.h)},n.xor=function(I){for(var v=Math.max(this.g.length,I.g.length),E=[],C=0;C<v;C++)E[C]=this.i(C)^I.i(C);return new o(E,this.h^I.h)};function te(I){for(var v=I.g.length+1,E=[],C=0;C<v;C++)E[C]=I.i(C)<<1|I.i(C-1)>>>31;return new o(E,I.h)}function X(I,v){var E=v>>5;v%=32;for(var C=I.g.length-E,b=[],A=0;A<C;A++)b[A]=0<v?I.i(A+E)>>>v|I.i(A+E+1)<<32-v:I.i(A+E);return new o(b,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,jI=nk.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,Hi=nk.Integer=o}).apply(typeof tk<"u"?tk:typeof self<"u"?self:typeof window<"u"?window:{});var ag=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Qr={};var UI,BI,Ba,$I,Hl,ug,HI,qI,GI;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,h,p){return c==Array.prototype||c==Object.prototype||(c[h]=p.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof ag=="object"&&ag];for(var h=0;h<c.length;++h){var p=c[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(c,h){if(h)e:{var p=r;c=c.split(".");for(var m=0;m<c.length-1;m++){var T=c[m];if(!(T in p))break e;p=p[T]}c=c[c.length-1],m=p[c],h=h(m),h!=m&&h!=null&&e(p,c,{configurable:!0,writable:!0,value:h})}}function s(c,h){c instanceof String&&(c+="");var p=0,m=!1,T={next:function(){if(!m&&p<c.length){var M=p++;return{value:h(M,c[M]),done:!1}}return m=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(c){return c||function(){return s(this,function(h,p){return p})}});var o=o||{},a=this||self;function u(c){var h=typeof c;return h=h!="object"?h:c?Array.isArray(c)?"array":h:"null",h=="array"||h=="object"&&typeof c.length=="number"}function l(c){var h=typeof c;return h=="object"&&c!=null||h=="function"}function d(c,h,p){return c.call.apply(c.bind,arguments)}function f(c,h,p){if(!c)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,m),c.apply(h,T)}}return function(){return c.apply(h,arguments)}}function g(c,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function y(c,h){var p=Array.prototype.slice.call(arguments,1);return function(){var m=p.slice();return m.push.apply(m,arguments),c.apply(this,m)}}function _(c,h){function p(){}p.prototype=h.prototype,c.aa=h.prototype,c.prototype=new p,c.prototype.constructor=c,c.Qb=function(m,T,M){for(var j=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)j[Pe-2]=arguments[Pe];return h.prototype[T].apply(m,j)}}function D(c){let h=c.length;if(0<h){let p=Array(h);for(let m=0;m<h;m++)p[m]=c[m];return p}return[]}function S(c,h){for(let p=1;p<arguments.length;p++){let m=arguments[p];if(u(m)){let T=c.length||0,M=m.length||0;c.length=T+M;for(let j=0;j<M;j++)c[T+j]=m[j]}else c.push(m)}}class k{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function U(c){return/^[\s\xa0]*$/.test(c)}function F(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function W(c){return W[" "](c),c}W[" "]=function(){};var te=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function X(c,h,p){for(let m in c)h.call(p,c[m],m,c)}function I(c,h){for(let p in c)h.call(void 0,c[p],p,c)}function v(c){let h={};for(let p in c)h[p]=c[p];return h}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(c,h){let p,m;for(let T=1;T<arguments.length;T++){m=arguments[T];for(p in m)c[p]=m[p];for(let M=0;M<E.length;M++)p=E[M],Object.prototype.hasOwnProperty.call(m,p)&&(c[p]=m[p])}}function b(c){var h=1;c=c.split(":");let p=[];for(;0<h&&c.length;)p.push(c.shift()),h--;return c.length&&p.push(c.join(":")),p}function A(c){a.setTimeout(()=>{throw c},0)}function w(){var c=Mm;let h=null;return c.g&&(h=c.g,c.g=c.g.next,c.g||(c.h=null),h.next=null),h}class Rr{constructor(){this.h=this.g=null}add(h,p){let m=Au.get();m.set(h,p),this.h?this.h.next=m:this.g=m,this.h=m}}var Au=new k(()=>new UF,c=>c.reset());class UF{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let xu,Mu=!1,Mm=new Rr,$b=()=>{let c=a.Promise.resolve(void 0);xu=()=>{c.then(BF)}};var BF=()=>{for(var c;c=w();){try{c.h.call(c.g)}catch(p){A(p)}var h=Au;h.j(c),100>h.h&&(h.h++,c.next=h.g,h.g=c)}Mu=!1};function si(){this.s=this.s,this.C=this.C}si.prototype.s=!1,si.prototype.ma=function(){this.s||(this.s=!0,this.N())},si.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function xt(c,h){this.type=c,this.g=this.target=h,this.defaultPrevented=!1}xt.prototype.h=function(){this.defaultPrevented=!0};var $F=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,h=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return c}();function Ru(c,h){if(xt.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var p=this.type=c.type,m=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=h,h=c.relatedTarget){if(te){e:{try{W(h.nodeName);var T=!0;break e}catch{}T=!1}T||(h=null)}}else p=="mouseover"?h=c.fromElement:p=="mouseout"&&(h=c.toElement);this.relatedTarget=h,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:HF[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Ru.aa.h.call(this)}}_(Ru,xt);var HF={2:"touch",3:"pen",4:"mouse"};Ru.prototype.h=function(){Ru.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Nu="closure_listenable_"+(1e6*Math.random()|0),qF=0;function GF(c,h,p,m,T){this.listener=c,this.proxy=null,this.src=h,this.type=p,this.capture=!!m,this.ha=T,this.key=++qF,this.da=this.fa=!1}function Rd(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Nd(c){this.src=c,this.g={},this.h=0}Nd.prototype.add=function(c,h,p,m,T){var M=c.toString();c=this.g[M],c||(c=this.g[M]=[],this.h++);var j=Nm(c,h,m,T);return-1<j?(h=c[j],p||(h.fa=!1)):(h=new GF(h,this.src,M,!!m,T),h.fa=p,c.push(h)),h};function Rm(c,h){var p=h.type;if(p in c.g){var m=c.g[p],T=Array.prototype.indexOf.call(m,h,void 0),M;(M=0<=T)&&Array.prototype.splice.call(m,T,1),M&&(Rd(h),c.g[p].length==0&&(delete c.g[p],c.h--))}}function Nm(c,h,p,m){for(var T=0;T<c.length;++T){var M=c[T];if(!M.da&&M.listener==h&&M.capture==!!p&&M.ha==m)return T}return-1}var Pm="closure_lm_"+(1e6*Math.random()|0),km={};function Hb(c,h,p,m,T){if(m&&m.once)return Gb(c,h,p,m,T);if(Array.isArray(h)){for(var M=0;M<h.length;M++)Hb(c,h[M],p,m,T);return null}return p=Lm(p),c&&c[Nu]?c.K(h,p,l(m)?!!m.capture:!!m,T):qb(c,h,p,!1,m,T)}function qb(c,h,p,m,T,M){if(!h)throw Error("Invalid event type");var j=l(T)?!!T.capture:!!T,Pe=Fm(c);if(Pe||(c[Pm]=Pe=new Nd(c)),p=Pe.add(h,p,m,j,M),p.proxy)return p;if(m=zF(),p.proxy=m,m.src=c,m.listener=p,c.addEventListener)$F||(T=j),T===void 0&&(T=!1),c.addEventListener(h.toString(),m,T);else if(c.attachEvent)c.attachEvent(Wb(h.toString()),m);else if(c.addListener&&c.removeListener)c.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return p}function zF(){function c(p){return h.call(c.src,c.listener,p)}let h=WF;return c}function Gb(c,h,p,m,T){if(Array.isArray(h)){for(var M=0;M<h.length;M++)Gb(c,h[M],p,m,T);return null}return p=Lm(p),c&&c[Nu]?c.L(h,p,l(m)?!!m.capture:!!m,T):qb(c,h,p,!0,m,T)}function zb(c,h,p,m,T){if(Array.isArray(h))for(var M=0;M<h.length;M++)zb(c,h[M],p,m,T);else m=l(m)?!!m.capture:!!m,p=Lm(p),c&&c[Nu]?(c=c.i,h=String(h).toString(),h in c.g&&(M=c.g[h],p=Nm(M,p,m,T),-1<p&&(Rd(M[p]),Array.prototype.splice.call(M,p,1),M.length==0&&(delete c.g[h],c.h--)))):c&&(c=Fm(c))&&(h=c.g[h.toString()],c=-1,h&&(c=Nm(h,p,m,T)),(p=-1<c?h[c]:null)&&Om(p))}function Om(c){if(typeof c!="number"&&c&&!c.da){var h=c.src;if(h&&h[Nu])Rm(h.i,c);else{var p=c.type,m=c.proxy;h.removeEventListener?h.removeEventListener(p,m,c.capture):h.detachEvent?h.detachEvent(Wb(p),m):h.addListener&&h.removeListener&&h.removeListener(m),(p=Fm(h))?(Rm(p,c),p.h==0&&(p.src=null,h[Pm]=null)):Rd(c)}}}function Wb(c){return c in km?km[c]:km[c]="on"+c}function WF(c,h){if(c.da)c=!0;else{h=new Ru(h,this);var p=c.listener,m=c.ha||c.src;c.fa&&Om(c),c=p.call(m,h)}return c}function Fm(c){return c=c[Pm],c instanceof Nd?c:null}var Vm="__closure_events_fn_"+(1e9*Math.random()>>>0);function Lm(c){return typeof c=="function"?c:(c[Vm]||(c[Vm]=function(h){return c.handleEvent(h)}),c[Vm])}function Mt(){si.call(this),this.i=new Nd(this),this.M=this,this.F=null}_(Mt,si),Mt.prototype[Nu]=!0,Mt.prototype.removeEventListener=function(c,h,p,m){zb(this,c,h,p,m)};function Bt(c,h){var p,m=c.F;if(m)for(p=[];m;m=m.F)p.push(m);if(c=c.M,m=h.type||h,typeof h=="string")h=new xt(h,c);else if(h instanceof xt)h.target=h.target||c;else{var T=h;h=new xt(m,c),C(h,T)}if(T=!0,p)for(var M=p.length-1;0<=M;M--){var j=h.g=p[M];T=Pd(j,m,!0,h)&&T}if(j=h.g=c,T=Pd(j,m,!0,h)&&T,T=Pd(j,m,!1,h)&&T,p)for(M=0;M<p.length;M++)j=h.g=p[M],T=Pd(j,m,!1,h)&&T}Mt.prototype.N=function(){if(Mt.aa.N.call(this),this.i){var c=this.i,h;for(h in c.g){for(var p=c.g[h],m=0;m<p.length;m++)Rd(p[m]);delete c.g[h],c.h--}}this.F=null},Mt.prototype.K=function(c,h,p,m){return this.i.add(String(c),h,!1,p,m)},Mt.prototype.L=function(c,h,p,m){return this.i.add(String(c),h,!0,p,m)};function Pd(c,h,p,m){if(h=c.i.g[String(h)],!h)return!0;h=h.concat();for(var T=!0,M=0;M<h.length;++M){var j=h[M];if(j&&!j.da&&j.capture==p){var Pe=j.listener,Ct=j.ha||j.src;j.fa&&Rm(c.i,j),T=Pe.call(Ct,m)!==!1&&T}}return T&&!m.defaultPrevented}function Kb(c,h,p){if(typeof c=="function")p&&(c=g(c,p));else if(c&&typeof c.handleEvent=="function")c=g(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(c,h||0)}function Qb(c){c.g=Kb(()=>{c.g=null,c.i&&(c.i=!1,Qb(c))},c.l);let h=c.h;c.h=null,c.m.apply(null,h)}class KF extends si{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Qb(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pu(c){si.call(this),this.h=c,this.g={}}_(Pu,si);var Yb=[];function Zb(c){X(c.g,function(h,p){this.g.hasOwnProperty(p)&&Om(h)},c),c.g={}}Pu.prototype.N=function(){Pu.aa.N.call(this),Zb(this)},Pu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jm=a.JSON.stringify,QF=a.JSON.parse,YF=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Um(){}Um.prototype.h=null;function Jb(c){return c.h||(c.h=c.i())}function Xb(){}var ku={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Bm(){xt.call(this,"d")}_(Bm,xt);function $m(){xt.call(this,"c")}_($m,xt);var cs={},eT=null;function kd(){return eT=eT||new Mt}cs.La="serverreachability";function tT(c){xt.call(this,cs.La,c)}_(tT,xt);function Ou(c){let h=kd();Bt(h,new tT(h))}cs.STAT_EVENT="statevent";function nT(c,h){xt.call(this,cs.STAT_EVENT,c),this.stat=h}_(nT,xt);function $t(c){let h=kd();Bt(h,new nT(h,c))}cs.Ma="timingevent";function rT(c,h){xt.call(this,cs.Ma,c),this.size=h}_(rT,xt);function Fu(c,h){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},h)}function Vu(){this.g=!0}Vu.prototype.xa=function(){this.g=!1};function ZF(c,h,p,m,T,M){c.info(function(){if(c.g)if(M)for(var j="",Pe=M.split("&"),Ct=0;Ct<Pe.length;Ct++){var Se=Pe[Ct].split("=");if(1<Se.length){var Rt=Se[0];Se=Se[1];var Nt=Rt.split("_");j=2<=Nt.length&&Nt[1]=="type"?j+(Rt+"="+Se+"&"):j+(Rt+"=redacted&")}}else j=null;else j=M;return"XMLHTTP REQ ("+m+") [attempt "+T+"]: "+h+`
`+p+`
`+j})}function JF(c,h,p,m,T,M,j){c.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+T+"]: "+h+`
`+p+`
`+M+" "+j})}function _o(c,h,p,m){c.info(function(){return"XMLHTTP TEXT ("+h+"): "+eV(c,p)+(m?" "+m:"")})}function XF(c,h){c.info(function(){return"TIMEOUT: "+h})}Vu.prototype.info=function(){};function eV(c,h){if(!c.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(c=0;c<p.length;c++)if(Array.isArray(p[c])){var m=p[c];if(!(2>m.length)){var T=m[1];if(Array.isArray(T)&&!(1>T.length)){var M=T[0];if(M!="noop"&&M!="stop"&&M!="close")for(var j=1;j<T.length;j++)T[j]=""}}}}return jm(p)}catch{return h}}var Od={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},iT={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Hm;function Fd(){}_(Fd,Um),Fd.prototype.g=function(){return new XMLHttpRequest},Fd.prototype.i=function(){return{}},Hm=new Fd;function oi(c,h,p,m){this.j=c,this.i=h,this.l=p,this.R=m||1,this.U=new Pu(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new sT}function sT(){this.i=null,this.g="",this.h=!1}var oT={},qm={};function Gm(c,h,p){c.L=1,c.v=Ud(Nr(h)),c.m=p,c.P=!0,aT(c,null)}function aT(c,h){c.F=Date.now(),Vd(c),c.A=Nr(c.v);var p=c.A,m=c.R;Array.isArray(m)||(m=[String(m)]),ET(p.i,"t",m),c.C=0,p=c.j.J,c.h=new sT,c.g=jT(c.j,p?h:null,!c.m),0<c.O&&(c.M=new KF(g(c.Y,c,c.g),c.O)),h=c.U,p=c.g,m=c.ca;var T="readystatechange";Array.isArray(T)||(T&&(Yb[0]=T.toString()),T=Yb);for(var M=0;M<T.length;M++){var j=Hb(p,T[M],m||h.handleEvent,!1,h.h||h);if(!j)break;h.g[j.key]=j}h=c.H?v(c.H):{},c.m?(c.u||(c.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,h)):(c.u="GET",c.g.ea(c.A,c.u,null,h)),Ou(),ZF(c.i,c.u,c.A,c.l,c.R,c.m)}oi.prototype.ca=function(c){c=c.target;let h=this.M;h&&Pr(c)==3?h.j():this.Y(c)},oi.prototype.Y=function(c){try{if(c==this.g)e:{let Nt=Pr(this.g);var h=this.g.Ba();let Io=this.g.Z();if(!(3>Nt)&&(Nt!=3||this.g&&(this.h.h||this.g.oa()||AT(this.g)))){this.J||Nt!=4||h==7||(h==8||0>=Io?Ou(3):Ou(2)),zm(this);var p=this.g.Z();this.X=p;t:if(uT(this)){var m=AT(this.g);c="";var T=m.length,M=Pr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ls(this),Lu(this);var j="";break t}this.h.i=new a.TextDecoder}for(h=0;h<T;h++)this.h.h=!0,c+=this.h.i.decode(m[h],{stream:!(M&&h==T-1)});m.length=0,this.h.g+=c,this.C=0,j=this.h.g}else j=this.g.oa();if(this.o=p==200,JF(this.i,this.u,this.A,this.l,this.R,Nt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Pe,Ct=this.g;if((Pe=Ct.g?Ct.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Pe)){var Se=Pe;break t}}Se=null}if(p=Se)_o(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wm(this,p);else{this.o=!1,this.s=3,$t(12),ls(this),Lu(this);break e}}if(this.P){p=!0;let Fn;for(;!this.J&&this.C<j.length;)if(Fn=tV(this,j),Fn==qm){Nt==4&&(this.s=4,$t(14),p=!1),_o(this.i,this.l,null,"[Incomplete Response]");break}else if(Fn==oT){this.s=4,$t(15),_o(this.i,this.l,j,"[Invalid Chunk]"),p=!1;break}else _o(this.i,this.l,Fn,null),Wm(this,Fn);if(uT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Nt!=4||j.length!=0||this.h.h||(this.s=1,$t(16),p=!1),this.o=this.o&&p,!p)_o(this.i,this.l,j,"[Invalid Chunked Response]"),ls(this),Lu(this);else if(0<j.length&&!this.W){this.W=!0;var Rt=this.j;Rt.g==this&&Rt.ba&&!Rt.M&&(Rt.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),Xm(Rt),Rt.M=!0,$t(11))}}else _o(this.i,this.l,j,null),Wm(this,j);Nt==4&&ls(this),this.o&&!this.J&&(Nt==4?OT(this.j,this):(this.o=!1,Vd(this)))}else vV(this.g),p==400&&0<j.indexOf("Unknown SID")?(this.s=3,$t(12)):(this.s=0,$t(13)),ls(this),Lu(this)}}}catch{}finally{}};function uT(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function tV(c,h){var p=c.C,m=h.indexOf(`
`,p);return m==-1?qm:(p=Number(h.substring(p,m)),isNaN(p)?oT:(m+=1,m+p>h.length?qm:(h=h.slice(m,m+p),c.C=m+p,h)))}oi.prototype.cancel=function(){this.J=!0,ls(this)};function Vd(c){c.S=Date.now()+c.I,cT(c,c.I)}function cT(c,h){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Fu(g(c.ba,c),h)}function zm(c){c.B&&(a.clearTimeout(c.B),c.B=null)}oi.prototype.ba=function(){this.B=null;let c=Date.now();0<=c-this.S?(XF(this.i,this.A),this.L!=2&&(Ou(),$t(17)),ls(this),this.s=2,Lu(this)):cT(this,this.S-c)};function Lu(c){c.j.G==0||c.J||OT(c.j,c)}function ls(c){zm(c);var h=c.M;h&&typeof h.ma=="function"&&h.ma(),c.M=null,Zb(c.U),c.g&&(h=c.g,c.g=null,h.abort(),h.ma())}function Wm(c,h){try{var p=c.j;if(p.G!=0&&(p.g==c||Km(p.h,c))){if(!c.K&&Km(p.h,c)&&p.G==3){try{var m=p.Da.g.parse(h)}catch{m=null}if(Array.isArray(m)&&m.length==3){var T=m;if(T[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<c.F)Gd(p),Hd(p);else break e;Jm(p),$t(18)}}else p.za=T[1],0<p.za-p.T&&37500>T[2]&&p.F&&p.v==0&&!p.C&&(p.C=Fu(g(p.Za,p),6e3));if(1>=hT(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else hs(p,11)}else if((c.K||p.g==c)&&Gd(p),!U(h))for(T=p.Da.g.parse(h),h=0;h<T.length;h++){let Se=T[h];if(p.T=Se[0],Se=Se[1],p.G==2)if(Se[0]=="c"){p.K=Se[1],p.ia=Se[2];let Rt=Se[3];Rt!=null&&(p.la=Rt,p.j.info("VER="+p.la));let Nt=Se[4];Nt!=null&&(p.Aa=Nt,p.j.info("SVER="+p.Aa));let Io=Se[5];Io!=null&&typeof Io=="number"&&0<Io&&(m=1.5*Io,p.L=m,p.j.info("backChannelRequestTimeoutMs_="+m)),m=p;let Fn=c.g;if(Fn){let Wd=Fn.g?Fn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wd){var M=m.h;M.g||Wd.indexOf("spdy")==-1&&Wd.indexOf("quic")==-1&&Wd.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Qm(M,M.h),M.h=null))}if(m.D){let ey=Fn.g?Fn.g.getResponseHeader("X-HTTP-Session-Id"):null;ey&&(m.ya=ey,$e(m.I,m.D,ey))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-c.F,p.j.info("Handshake RTT: "+p.R+"ms")),m=p;var j=c;if(m.qa=LT(m,m.J?m.ia:null,m.W),j.K){fT(m.h,j);var Pe=j,Ct=m.L;Ct&&(Pe.I=Ct),Pe.B&&(zm(Pe),Vd(Pe)),m.g=j}else PT(m);0<p.i.length&&qd(p)}else Se[0]!="stop"&&Se[0]!="close"||hs(p,7);else p.G==3&&(Se[0]=="stop"||Se[0]=="close"?Se[0]=="stop"?hs(p,7):Zm(p):Se[0]!="noop"&&p.l&&p.l.ta(Se),p.v=0)}}Ou(4)}catch{}}var nV=class{constructor(c,h){this.g=c,this.map=h}};function lT(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function dT(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function hT(c){return c.h?1:c.g?c.g.size:0}function Km(c,h){return c.h?c.h==h:c.g?c.g.has(h):!1}function Qm(c,h){c.g?c.g.add(h):c.h=h}function fT(c,h){c.h&&c.h==h?c.h=null:c.g&&c.g.has(h)&&c.g.delete(h)}lT.prototype.cancel=function(){if(this.i=pT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function pT(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let h=c.i;for(let p of c.g.values())h=h.concat(p.D);return h}return D(c.i)}function rV(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var h=[],p=c.length,m=0;m<p;m++)h.push(c[m]);return h}h=[],p=0;for(m in c)h[p++]=c[m];return h}function iV(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var h=[];c=c.length;for(var p=0;p<c;p++)h.push(p);return h}h=[],p=0;for(let m in c)h[p++]=m;return h}}}function gT(c,h){if(c.forEach&&typeof c.forEach=="function")c.forEach(h,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,h,void 0);else for(var p=iV(c),m=rV(c),T=m.length,M=0;M<T;M++)h.call(void 0,m[M],p&&p[M],c)}var mT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sV(c,h){if(c){c=c.split("&");for(var p=0;p<c.length;p++){var m=c[p].indexOf("="),T=null;if(0<=m){var M=c[p].substring(0,m);T=c[p].substring(m+1)}else M=c[p];h(M,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function ds(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof ds){this.h=c.h,Ld(this,c.j),this.o=c.o,this.g=c.g,jd(this,c.s),this.l=c.l;var h=c.i,p=new Bu;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),yT(this,p),this.m=c.m}else c&&(h=String(c).match(mT))?(this.h=!1,Ld(this,h[1]||"",!0),this.o=ju(h[2]||""),this.g=ju(h[3]||"",!0),jd(this,h[4]),this.l=ju(h[5]||"",!0),yT(this,h[6]||"",!0),this.m=ju(h[7]||"")):(this.h=!1,this.i=new Bu(null,this.h))}ds.prototype.toString=function(){var c=[],h=this.j;h&&c.push(Uu(h,vT,!0),":");var p=this.g;return(p||h=="file")&&(c.push("//"),(h=this.o)&&c.push(Uu(h,vT,!0),"@"),c.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&c.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&c.push("/"),c.push(Uu(p,p.charAt(0)=="/"?uV:aV,!0))),(p=this.i.toString())&&c.push("?",p),(p=this.m)&&c.push("#",Uu(p,lV)),c.join("")};function Nr(c){return new ds(c)}function Ld(c,h,p){c.j=p?ju(h,!0):h,c.j&&(c.j=c.j.replace(/:$/,""))}function jd(c,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);c.s=h}else c.s=null}function yT(c,h,p){h instanceof Bu?(c.i=h,dV(c.i,c.h)):(p||(h=Uu(h,cV)),c.i=new Bu(h,c.h))}function $e(c,h,p){c.i.set(h,p)}function Ud(c){return $e(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function ju(c,h){return c?h?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Uu(c,h,p){return typeof c=="string"?(c=encodeURI(c).replace(h,oV),p&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function oV(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var vT=/[#\/\?@]/g,aV=/[#\?:]/g,uV=/[#\?]/g,cV=/[#\?@]/g,lV=/#/g;function Bu(c,h){this.h=this.g=null,this.i=c||null,this.j=!!h}function ai(c){c.g||(c.g=new Map,c.h=0,c.i&&sV(c.i,function(h,p){c.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=Bu.prototype,n.add=function(c,h){ai(this),this.i=null,c=wo(this,c);var p=this.g.get(c);return p||this.g.set(c,p=[]),p.push(h),this.h+=1,this};function _T(c,h){ai(c),h=wo(c,h),c.g.has(h)&&(c.i=null,c.h-=c.g.get(h).length,c.g.delete(h))}function wT(c,h){return ai(c),h=wo(c,h),c.g.has(h)}n.forEach=function(c,h){ai(this),this.g.forEach(function(p,m){p.forEach(function(T){c.call(h,T,m,this)},this)},this)},n.na=function(){ai(this);let c=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let m=0;m<h.length;m++){let T=c[m];for(let M=0;M<T.length;M++)p.push(h[m])}return p},n.V=function(c){ai(this);let h=[];if(typeof c=="string")wT(this,c)&&(h=h.concat(this.g.get(wo(this,c))));else{c=Array.from(this.g.values());for(let p=0;p<c.length;p++)h=h.concat(c[p])}return h},n.set=function(c,h){return ai(this),this.i=null,c=wo(this,c),wT(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[h]),this.h+=1,this},n.get=function(c,h){return c?(c=this.V(c),0<c.length?String(c[0]):h):h};function ET(c,h,p){_T(c,h),0<p.length&&(c.i=null,c.g.set(wo(c,h),D(p)),c.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var m=h[p];let M=encodeURIComponent(String(m)),j=this.V(m);for(m=0;m<j.length;m++){var T=M;j[m]!==""&&(T+="="+encodeURIComponent(String(j[m]))),c.push(T)}}return this.i=c.join("&")};function wo(c,h){return h=String(h),c.j&&(h=h.toLowerCase()),h}function dV(c,h){h&&!c.j&&(ai(c),c.i=null,c.g.forEach(function(p,m){var T=m.toLowerCase();m!=T&&(_T(this,m),ET(this,T,p))},c)),c.j=h}function hV(c,h){let p=new Vu;if(a.Image){let m=new Image;m.onload=y(ui,p,"TestLoadImage: loaded",!0,h,m),m.onerror=y(ui,p,"TestLoadImage: error",!1,h,m),m.onabort=y(ui,p,"TestLoadImage: abort",!1,h,m),m.ontimeout=y(ui,p,"TestLoadImage: timeout",!1,h,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=c}else h(!1)}function fV(c,h){let p=new Vu,m=new AbortController,T=setTimeout(()=>{m.abort(),ui(p,"TestPingServer: timeout",!1,h)},1e4);fetch(c,{signal:m.signal}).then(M=>{clearTimeout(T),M.ok?ui(p,"TestPingServer: ok",!0,h):ui(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(T),ui(p,"TestPingServer: error",!1,h)})}function ui(c,h,p,m,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),m(p)}catch{}}function pV(){this.g=new YF}function gV(c,h,p){let m=p||"";try{gT(c,function(T,M){let j=T;l(T)&&(j=jm(T)),h.push(m+M+"="+encodeURIComponent(j))})}catch(T){throw h.push(m+"type="+encodeURIComponent("_badmap")),T}}function $u(c){this.l=c.Ub||null,this.j=c.eb||!1}_($u,Um),$u.prototype.g=function(){return new Bd(this.l,this.j)},$u.prototype.i=function(c){return function(){return c}}({});function Bd(c,h){Mt.call(this),this.D=c,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Bd,Mt),n=Bd.prototype,n.open=function(c,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=h,this.readyState=1,qu(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(h.body=c),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Hu(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,qu(this)),this.g&&(this.readyState=3,qu(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;IT(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function IT(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var h=c.value?c.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!c.done}))&&(this.response=this.responseText+=h)}c.done?Hu(this):qu(this),this.readyState==3&&IT(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,Hu(this))},n.Qa=function(c){this.g&&(this.response=c,Hu(this))},n.ga=function(){this.g&&Hu(this)};function Hu(c){c.readyState=4,c.l=null,c.j=null,c.v=null,qu(c)}n.setRequestHeader=function(c,h){this.u.append(c,h)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,c.push(p[0]+": "+p[1]),p=h.next();return c.join(`\r
`)};function qu(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Bd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function CT(c){let h="";return X(c,function(p,m){h+=m,h+=":",h+=p,h+=`\r
`}),h}function Ym(c,h,p){e:{for(m in p){var m=!1;break e}m=!0}m||(p=CT(p),typeof c=="string"?p!=null&&encodeURIComponent(String(p)):$e(c,h,p))}function Ye(c){Mt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(Ye,Mt);var mV=/^https?$/i,yV=["POST","PUT"];n=Ye.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,h,p,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);h=h?h.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Hm.g(),this.v=this.o?Jb(this.o):Jb(Hm),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(c),!0),this.B=!1}catch(M){DT(this,M);return}if(c=p||"",p=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var T in m)p.set(T,m[T]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let M of m.keys())p.set(M,m.get(M));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(p.keys()).find(M=>M.toLowerCase()=="content-type"),T=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(yV,h,void 0))||m||T||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,j]of p)this.g.setRequestHeader(M,j);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ST(this),this.u=!0,this.g.send(c),this.u=!1}catch(M){DT(this,M)}};function DT(c,h){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=h,c.m=5,bT(c),$d(c)}function bT(c){c.A||(c.A=!0,Bt(c,"complete"),Bt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Bt(this,"complete"),Bt(this,"abort"),$d(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$d(this,!0)),Ye.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?TT(this):this.bb())},n.bb=function(){TT(this)};function TT(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Pr(c)!=4||c.Z()!=2)){if(c.u&&Pr(c)==4)Kb(c.Ea,0,c);else if(Bt(c,"readystatechange"),Pr(c)==4){c.h=!1;try{let j=c.Z();e:switch(j){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var m;if(m=j===0){var T=String(c.D).match(mT)[1]||null;!T&&a.self&&a.self.location&&(T=a.self.location.protocol.slice(0,-1)),m=!mV.test(T?T.toLowerCase():"")}p=m}if(p)Bt(c,"complete"),Bt(c,"success");else{c.m=6;try{var M=2<Pr(c)?c.g.statusText:""}catch{M=""}c.l=M+" ["+c.Z()+"]",bT(c)}}finally{$d(c)}}}}function $d(c,h){if(c.g){ST(c);let p=c.g,m=c.v[0]?()=>{}:null;c.g=null,c.v=null,h||Bt(c,"ready");try{p.onreadystatechange=m}catch{}}}function ST(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function Pr(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<Pr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var h=this.g.responseText;return c&&h.indexOf(c)==0&&(h=h.substring(c.length)),QF(h)}};function AT(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function vV(c){let h={};c=(c.g&&2<=Pr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<c.length;m++){if(U(c[m]))continue;var p=b(c[m]);let T=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let M=h[T]||[];h[T]=M,M.push(p)}I(h,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Gu(c,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[c]||h}function xT(c){this.Aa=0,this.i=[],this.j=new Vu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gu("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gu("baseRetryDelayMs",5e3,c),this.cb=Gu("retryDelaySeedMs",1e4,c),this.Wa=Gu("forwardChannelMaxRetries",2,c),this.wa=Gu("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new lT(c&&c.concurrentRequestLimit),this.Da=new pV,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=xT.prototype,n.la=8,n.G=1,n.connect=function(c,h,p,m){$t(0),this.W=c,this.H=h||{},p&&m!==void 0&&(this.H.OSID=p,this.H.OAID=m),this.F=this.X,this.I=LT(this,null,this.W),qd(this)};function Zm(c){if(MT(c),c.G==3){var h=c.U++,p=Nr(c.I);if($e(p,"SID",c.K),$e(p,"RID",h),$e(p,"TYPE","terminate"),zu(c,p),h=new oi(c,c.j,h),h.L=2,h.v=Ud(Nr(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=jT(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Vd(h)}VT(c)}function Hd(c){c.g&&(Xm(c),c.g.cancel(),c.g=null)}function MT(c){Hd(c),c.u&&(a.clearTimeout(c.u),c.u=null),Gd(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function qd(c){if(!dT(c.h)&&!c.s){c.s=!0;var h=c.Ga;xu||$b(),Mu||(xu(),Mu=!0),Mm.add(h,c),c.B=0}}function _V(c,h){return hT(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=h.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Fu(g(c.Ga,c,h),FT(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;let T=new oi(this,this.j,c),M=this.o;if(this.S&&(M?(M=v(M),C(M,this.S)):M=this.S),this.m!==null||this.O||(T.H=M,M=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var m=this.i[p];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(h+=m,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=NT(this,T,h),p=Nr(this.I),$e(p,"RID",c),$e(p,"CVER",22),this.D&&$e(p,"X-HTTP-Session-Id",this.D),zu(this,p),M&&(this.O?h="headers="+encodeURIComponent(String(CT(M)))+"&"+h:this.m&&Ym(p,this.m,M)),Qm(this.h,T),this.Ua&&$e(p,"TYPE","init"),this.P?($e(p,"$req",h),$e(p,"SID","null"),T.T=!0,Gm(T,p,null)):Gm(T,p,h),this.G=2}}else this.G==3&&(c?RT(this,c):this.i.length==0||dT(this.h)||RT(this))};function RT(c,h){var p;h?p=h.l:p=c.U++;let m=Nr(c.I);$e(m,"SID",c.K),$e(m,"RID",p),$e(m,"AID",c.T),zu(c,m),c.m&&c.o&&Ym(m,c.m,c.o),p=new oi(c,c.j,p,c.B+1),c.m===null&&(p.H=c.o),h&&(c.i=h.D.concat(c.i)),h=NT(c,p,1e3),p.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Qm(c.h,p),Gm(p,m,h)}function zu(c,h){c.H&&X(c.H,function(p,m){$e(h,m,p)}),c.l&&gT({},function(p,m){$e(h,m,p)})}function NT(c,h,p){p=Math.min(c.i.length,p);var m=c.l?g(c.l.Na,c.l,c):null;e:{var T=c.i;let M=-1;for(;;){let j=["count="+p];M==-1?0<p?(M=T[0].g,j.push("ofs="+M)):M=0:j.push("ofs="+M);let Pe=!0;for(let Ct=0;Ct<p;Ct++){let Se=T[Ct].g,Rt=T[Ct].map;if(Se-=M,0>Se)M=Math.max(0,T[Ct].g-100),Pe=!1;else try{gV(Rt,j,"req"+Se+"_")}catch{m&&m(Rt)}}if(Pe){m=j.join("&");break e}}}return c=c.i.splice(0,p),h.D=c,m}function PT(c){if(!c.g&&!c.u){c.Y=1;var h=c.Fa;xu||$b(),Mu||(xu(),Mu=!0),Mm.add(h,c),c.v=0}}function Jm(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Fu(g(c.Fa,c),FT(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,kT(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Fu(g(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,$t(10),Hd(this),kT(this))};function Xm(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function kT(c){c.g=new oi(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var h=Nr(c.qa);$e(h,"RID","rpc"),$e(h,"SID",c.K),$e(h,"AID",c.T),$e(h,"CI",c.F?"0":"1"),!c.F&&c.ja&&$e(h,"TO",c.ja),$e(h,"TYPE","xmlhttp"),zu(c,h),c.m&&c.o&&Ym(h,c.m,c.o),c.L&&(c.g.I=c.L);var p=c.g;c=c.ia,p.L=1,p.v=Ud(Nr(h)),p.m=null,p.P=!0,aT(p,c)}n.Za=function(){this.C!=null&&(this.C=null,Hd(this),Jm(this),$t(19))};function Gd(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function OT(c,h){var p=null;if(c.g==h){Gd(c),Xm(c),c.g=null;var m=2}else if(Km(c.h,h))p=h.D,fT(c.h,h),m=1;else return;if(c.G!=0){if(h.o)if(m==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var T=c.B;m=kd(),Bt(m,new rT(m,p)),qd(c)}else PT(c);else if(T=h.s,T==3||T==0&&0<h.X||!(m==1&&_V(c,h)||m==2&&Jm(c)))switch(p&&0<p.length&&(h=c.h,h.i=h.i.concat(p)),T){case 1:hs(c,5);break;case 4:hs(c,10);break;case 3:hs(c,6);break;default:hs(c,2)}}}function FT(c,h){let p=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(p*=2),p*h}function hs(c,h){if(c.j.info("Error code "+h),h==2){var p=g(c.fb,c),m=c.Xa;let T=!m;m=new ds(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ld(m,"https"),Ud(m),T?hV(m.toString(),p):fV(m.toString(),p)}else $t(2);c.G=0,c.l&&c.l.sa(h),VT(c),MT(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),$t(2)):(this.j.info("Failed to ping google.com"),$t(1))};function VT(c){if(c.G=0,c.ka=[],c.l){let h=pT(c.h);(h.length!=0||c.i.length!=0)&&(S(c.ka,h),S(c.ka,c.i),c.h.i.length=0,D(c.i),c.i.length=0),c.l.ra()}}function LT(c,h,p){var m=p instanceof ds?Nr(p):new ds(p);if(m.g!="")h&&(m.g=h+"."+m.g),jd(m,m.s);else{var T=a.location;m=T.protocol,h=h?h+"."+T.hostname:T.hostname,T=+T.port;var M=new ds(null);m&&Ld(M,m),h&&(M.g=h),T&&jd(M,T),p&&(M.l=p),m=M}return p=c.D,h=c.ya,p&&h&&$e(m,p,h),$e(m,"VER",c.la),zu(c,m),m}function jT(c,h,p){if(h&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=c.Ca&&!c.pa?new Ye(new $u({eb:p})):new Ye(c.pa),h.Ha(c.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function UT(){}n=UT.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function zd(){}zd.prototype.g=function(c,h){return new an(c,h)};function an(c,h){Mt.call(this),this.g=new xT(h),this.l=c,this.h=h&&h.messageUrlParams||null,c=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(c?c["X-WebChannel-Content-Type"]=h.messageContentType:c={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(c?c["X-WebChannel-Client-Profile"]=h.va:c={"X-WebChannel-Client-Profile":h.va}),this.g.S=c,(c=h&&h.Sb)&&!U(c)&&(this.g.m=c),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!U(h)&&(this.g.D=h,c=this.h,c!==null&&h in c&&(c=this.h,h in c&&delete c[h])),this.j=new Eo(this)}_(an,Mt),an.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){Zm(this.g)},an.prototype.o=function(c){var h=this.g;if(typeof c=="string"){var p={};p.__data__=c,c=p}else this.u&&(p={},p.__data__=jm(c),c=p);h.i.push(new nV(h.Ya++,c)),h.G==3&&qd(h)},an.prototype.N=function(){this.g.l=null,delete this.j,Zm(this.g),delete this.g,an.aa.N.call(this)};function BT(c){Bm.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var h=c.__sm__;if(h){e:{for(let p in h){c=p;break e}c=void 0}(this.i=c)&&(c=this.i,h=h!==null&&c in h?h[c]:void 0),this.data=h}else this.data=c}_(BT,Bm);function $T(){$m.call(this),this.status=1}_($T,$m);function Eo(c){this.g=c}_(Eo,UT),Eo.prototype.ua=function(){Bt(this.g,"a")},Eo.prototype.ta=function(c){Bt(this.g,new BT(c))},Eo.prototype.sa=function(c){Bt(this.g,new $T)},Eo.prototype.ra=function(){Bt(this.g,"b")},zd.prototype.createWebChannel=zd.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,GI=Qr.createWebChannelTransport=function(){return new zd},qI=Qr.getStatEventTarget=function(){return kd()},HI=Qr.Event=cs,ug=Qr.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Od.NO_ERROR=0,Od.TIMEOUT=8,Od.HTTP_ERROR=6,Hl=Qr.ErrorCode=Od,iT.COMPLETE="complete",$I=Qr.EventType=iT,Xb.EventType=ku,ku.OPEN="a",ku.CLOSE="b",ku.ERROR="c",ku.MESSAGE="d",Mt.prototype.listen=Mt.prototype.K,Ba=Qr.WebChannel=Xb,BI=Qr.FetchXmlHttpFactory=$u,Ye.prototype.listenOnce=Ye.prototype.L,Ye.prototype.getLastError=Ye.prototype.Ka,Ye.prototype.getLastErrorCode=Ye.prototype.Ba,Ye.prototype.getStatus=Ye.prototype.Z,Ye.prototype.getResponseJson=Ye.prototype.Oa,Ye.prototype.getResponseText=Ye.prototype.oa,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Ha,UI=Qr.XhrIo=Ye}).apply(typeof ag<"u"?ag:typeof self<"u"?self:typeof window<"u"?window:{});var rk="@firebase/firestore";var lt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};lt.UNAUTHENTICATED=new lt(null),lt.GOOGLE_CREDENTIALS=new lt("google-credentials-uid"),lt.FIRST_PARTY=new lt("first-party-uid"),lt.MOCK_USER=new lt("mock-user");var vu="10.12.1";var Yi=new li("@firebase/firestore");function za(){return Yi.logLevel}function rO(n){Yi.setLogLevel(n)}function O(n,...e){if(Yi.logLevel<=En.DEBUG){let t=e.map(KD);Yi.debug(`Firestore (${vu}): ${n}`,...t)}}function rt(n,...e){if(Yi.logLevel<=En.ERROR){let t=e.map(KD);Yi.error(`Firestore (${vu}): ${n}`,...t)}}function Pn(n,...e){if(Yi.logLevel<=En.WARN){let t=e.map(KD);Yi.warn(`Firestore (${vu}): ${n}`,...t)}}function KD(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function G(n="Unexpected state"){let e=`FIRESTORE (${vu}) INTERNAL ASSERTION FAILED: `+n;throw rt(e),new Error(e)}function K(n,e){n||G()}function iO(n,e){n||G()}function $(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends QT{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var dt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var _g=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},YI=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(lt.UNAUTHENTICATED))}shutdown(){}},ZI=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},JI=class{constructor(e){this.t=e,this.currentUser=lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new dt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new dt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>N(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new dt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(K(typeof r.accessToken=="string"),new _g(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return K(e===null||typeof e=="string"),new lt(e)}},XI=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=lt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},eC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new XI(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},tC=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},nC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,O("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(K(typeof t.token=="string"),this.R=t.token,new tC(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function F9(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var wg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=F9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ue(n,e){return n<e?-1:n>e?1:0}function tu(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function sO(n){return n+"\0"}var Qe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new P(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ue(this.nanoseconds,e.nanoseconds):ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var J=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Qe(0,0))}static max(){return new n(new Qe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Eg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&G(),r===void 0?r=e.length-t:r>e.length-t&&G(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Ce=class n extends Eg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},V9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,it=class n extends Eg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return V9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new P(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new P(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new P(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ce.fromString(e))}static fromName(e){return new n(Ce.fromString(e).popFirst(5))}static empty(){return new n(Ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ce(e.slice()))}};var nu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function rC(n){return n.fields.find(e=>e.kind===2)}function Ws(n){return n.fields.filter(e=>e.kind!==2)}nu.UNKNOWN_ID=-1;var Ja=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var td=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,kn.min())}};function oO(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=J.fromTimestamp(r===1e9?new Qe(t+1,0):new Qe(t,r));return new kn(i,B.empty(),e)}function aO(n){return new kn(n.readTime,n.key,-1)}var kn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(J.min(),B.empty(),-1)}static max(){return new n(J.max(),B.empty(),-1)}};function QD(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:ue(n.largestBatchId,e.largestBatchId))}var uO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ig=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function os(n){return N(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==uO)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var x=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&G(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let l=u;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var Cg=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new dt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Xs(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=YD(r.target.error);this.V.reject(new Xs(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new Xs(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(O("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new sC(t)}},Zi=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Wu())===12.2&&rt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return O("SimpleDb","Removing database:",e),Ks(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Zd())return!1;if(n.C())return!0;let e=Wu(),t=n.S(e),r=0<t&&t<10,i=cO(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return N(this,null,function*(){return this.db||(O("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new Xs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new P(R.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new P(R.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Xs(e,o))},i.onupgradeneeded=s=>{O("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{O("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return N(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Cg.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),x.reject(l))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,l=u.name!=="FirebaseError"&&o<3;if(O("SimpleDb","Transaction failed with error:",u.message,"Retrying:",l),this.close(),!l)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function cO(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var iC=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ks(this.B.delete())}},Xs=class extends P{constructor(e,t){super(R.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function as(n){return n.name==="IndexedDbTransactionError"}var sC=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(O("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(O("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ks(r)}add(e){return O("SimpleDb","ADD",this.store.name,e,e),Ks(this.store.add(e))}get(e){return Ks(this.store.get(e)).next(t=>(t===void 0&&(t=null),O("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return O("SimpleDb","DELETE",this.store.name,e),Ks(this.store.delete(e))}count(){return O("SimpleDb","COUNT",this.store.name),Ks(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new x((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new x((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){O("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new x((r,i)=>{t.onerror=s=>{let o=YD(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new x((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new iC(a),l=t(a.primaryKey,a.value,u);if(l instanceof x){let d=l.catch(f=>(u.done(),x.reject(f)));r.push(d)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>x.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Ks(n){return new x((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=YD(r.target.error);t(i)}})}var ik=!1;function YD(n){let e=Zi.S(Wu());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ik||(ik=!0,setTimeout(()=>{throw r},0)),r}}return n}var oC=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){O("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>N(this,null,function*(){this.task=null;try{O("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){as(t)?O("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield os(t)}yield this.X(6e4)}))}},aC=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return N(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return x.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return O("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(O("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=aO(s);QD(o,r)>0&&(r=o)}),new kn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var vn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Cd(n){return n==null}function nd(n){return n===0&&1/n==-1/0}function lO(n){return typeof n=="number"&&Number.isInteger(n)&&!nd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Zt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=sk(e)),e=L9(n.get(t),e);return sk(e)}function L9(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function sk(n){return n+""}function Er(n){let e=n.length;if(K(e>=2),e===2)return K(n.charAt(0)===""&&n.charAt(1)===""),Ce.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&G(),n.charAt(o+1)){case"":let a=n.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:G()}s=o+2}return new Ce(r)}var ok=["userId","batchId"];function fg(n,e){return[n,Zt(e)]}function dO(n,e,t){return[n,Zt(e),t]}var j9={},U9=["prefixPath","collectionGroup","readTime","documentId"],B9=["prefixPath","collectionGroup","documentId"],$9=["collectionGroup","readTime","prefixPath","documentId"],H9=["canonicalId","targetId"],q9=["targetId","path"],G9=["path","targetId"],z9=["collectionId","parent"],W9=["indexId","uid"],K9=["uid","sequenceNumber"],Q9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Y9=["indexId","uid","orderedDocumentKey"],Z9=["userId","collectionPath","documentId"],J9=["userId","collectionPath","largestBatchId"],X9=["userId","collectionGroup","largestBatchId"],hO=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],eW=[...hO,"documentOverlays"],fO=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],pO=fO,gO=[...pO,"indexConfiguration","indexState","indexEntries"],tW=gO;var rd=class extends Ig{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function It(n,e){let t=$(n);return Zi.F(t._e,e)}function ak(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ho(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function mO(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var qe=class n{constructor(e,t){this.comparator=e,this.root=t||Cr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Cr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Za(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Za(this.root,e,this.comparator,!1)}getReverseIterator(){return new Za(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Za(this.root,e,this.comparator,!0)}},Za=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Cr=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw G();let e=this.left.check();if(e!==this.right.check())throw G();return e+(this.isRed()?0:1)}};Cr.EMPTY=null,Cr.RED=!0,Cr.BLACK=!1;Cr.EMPTY=new class{constructor(){this.size=0}get key(){throw G()}get value(){throw G()}get color(){throw G()}get left(){throw G()}get right(){throw G()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Cr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Le=class n{constructor(e){this.comparator=e,this.data=new qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Dg(this.data.getIterator())}getIteratorFrom(e){return new Dg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Dg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function $a(n){return n.hasNext()?n.getNext():void 0}var _n=class n{constructor(e){this.fields=e,e.sort(it.comparator)}static empty(){return new n([])}unionWith(e){let t=new Le(it.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tu(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var bg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function yO(){return typeof atob<"u"}var Et=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new bg("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Et.EMPTY_BYTE_STRING=new Et("");var nW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Jr(n){if(K(!!n),typeof n=="string"){let e=0,t=nW.exec(n);if(K(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Je(n.seconds),nanos:Je(n.nanos)}}function Je(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ji(n){return typeof n=="string"?Et.fromBase64String(n):Et.fromUint8Array(n)}function gm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function ZD(n){let e=n.mapValue.fields.__previous_value__;return gm(e)?ZD(e):e}function id(n){let e=Jr(n.mapValue.fields.__local_write_time__.timestampValue);return new Qe(e.seconds,e.nanos)}var uC=class{constructor(e,t,r,i,s,o,a,u,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}},Xi=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ki={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},pg={nullValue:"NULL_VALUE"};function eo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?gm(n)?4:vO(n)?9007199254740991:10:G()}function Tr(n,e){if(n===e)return!0;let t=eo(n);if(t!==eo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return id(n).isEqual(id(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Jr(i.timestampValue),a=Jr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Ji(i.bytesValue).isEqual(Ji(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Je(i.geoPointValue.latitude)===Je(s.geoPointValue.latitude)&&Je(i.geoPointValue.longitude)===Je(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Je(i.integerValue)===Je(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Je(i.doubleValue),a=Je(s.doubleValue);return o===a?nd(o)===nd(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return tu(n.arrayValue.values||[],e.arrayValue.values||[],Tr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(ak(o)!==ak(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!Tr(o[u],a[u])))return!1;return!0}(n,e);default:return G()}}function sd(n,e){return(n.values||[]).find(t=>Tr(t,e))!==void 0}function es(n,e){if(n===e)return 0;let t=eo(n),r=eo(e);if(t!==r)return ue(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ue(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Je(s.integerValue||s.doubleValue),u=Je(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return uk(n.timestampValue,e.timestampValue);case 4:return uk(id(n),id(e));case 5:return ue(n.stringValue,e.stringValue);case 6:return function(s,o){let a=Ji(s),u=Ji(o);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){let d=ue(a[l],u[l]);if(d!==0)return d}return ue(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ue(Je(s.latitude),Je(o.latitude));return a!==0?a:ue(Je(s.longitude),Je(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let l=0;l<a.length&&l<u.length;++l){let d=es(a[l],u[l]);if(d)return d}return ue(a.length,u.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Ki.mapValue&&o===Ki.mapValue)return 0;if(s===Ki.mapValue)return 1;if(o===Ki.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),l=o.fields||{},d=Object.keys(l);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){let g=ue(u[f],d[f]);if(g!==0)return g;let y=es(a[u[f]],l[d[f]]);if(y!==0)return y}return ue(u.length,d.length)}(n.mapValue,e.mapValue);default:throw G()}}function uk(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ue(n,e);let t=Jr(n),r=Jr(e),i=ue(t.seconds,r.seconds);return i!==0?i:ue(t.nanos,r.nanos)}function ru(n){return cC(n)}function cC(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Jr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ji(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=cC(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${cC(t.fields[o])}`;return i+"}"}(n.mapValue):G()}function to(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function lC(n){return!!n&&"integerValue"in n}function od(n){return!!n&&"arrayValue"in n}function ck(n){return!!n&&"nullValue"in n}function lk(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function gg(n){return!!n&&"mapValue"in n}function Yl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ho(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Yl(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Yl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function vO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function rW(n){return"nullValue"in n?pg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?to(Xi.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:G()}function iW(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?to(Xi.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Ki:G()}function dk(n,e){let t=es(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function hk(n,e){let t=es(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Ut=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!gg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yl(t)}setAll(e){let t=it.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Yl(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());gg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];gg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ho(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Yl(this.value))}};function _O(n){let e=[];return ho(n.fields,(t,r)=>{let i=new it([t]);if(gg(r)){let s=_O(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new _n(e)}var ht=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,J.min(),J.min(),J.min(),Ut.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,J.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,J.min(),J.min(),Ut.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,J.min(),J.min(),Ut.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Sr=class{constructor(e,t){this.position=e,this.inclusive=t}};function fk(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=B.comparator(B.fromName(o.referenceValue),t.key):r=es(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function pk(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Tr(n.position[t],e.position[t]))return!1;return!0}var no=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function sW(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Tg=class{},_e=class n extends Tg{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new fC(e,t,r):t==="array-contains"?new mC(e,r):t==="in"?new Sg(e,r):t==="not-in"?new yC(e,r):t==="array-contains-any"?new vC(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new pC(e,r):new gC(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(es(t,this.value)):t!==null&&eo(this.value)===eo(t)&&this.matchesComparison(es(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return G()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ne=class n extends Tg{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return iu(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function iu(n){return n.op==="and"}function dC(n){return n.op==="or"}function JD(n){return wO(n)&&iu(n)}function wO(n){for(let e of n.filters)if(e instanceof Ne)return!1;return!0}function hC(n){if(n instanceof _e)return n.field.canonicalString()+n.op.toString()+ru(n.value);if(JD(n))return n.filters.map(e=>hC(e)).join(",");{let e=n.filters.map(t=>hC(t)).join(",");return`${n.op}(${e})`}}function EO(n,e){return n instanceof _e?function(r,i){return i instanceof _e&&r.op===i.op&&r.field.isEqual(i.field)&&Tr(r.value,i.value)}(n,e):n instanceof Ne?function(r,i){return i instanceof Ne&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&EO(o,i.filters[a]),!0):!1}(n,e):void G()}function IO(n,e){let t=n.filters.concat(e);return Ne.create(t,n.op)}function CO(n){return n instanceof _e?function(t){return`${t.field.canonicalString()} ${t.op} ${ru(t.value)}`}(n):n instanceof Ne?function(t){return t.op.toString()+" {"+t.getFilters().map(CO).join(" ,")+"}"}(n):"Filter"}var fC=class extends _e{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},pC=class extends _e{constructor(e,t){super(e,"in",t),this.keys=DO("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},gC=class extends _e{constructor(e,t){super(e,"not-in",t),this.keys=DO("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function DO(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var mC=class extends _e{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return od(t)&&sd(t.arrayValue,this.value)}},Sg=class extends _e{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&sd(this.value.arrayValue,t)}},yC=class extends _e{constructor(e,t){super(e,"not-in",t)}matches(e){if(sd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!sd(this.value.arrayValue,t)}},vC=class extends _e{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!od(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>sd(this.value.arrayValue,r))}};var _C=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function wC(n,e=null,t=[],r=[],i=null,s=null,o=null){return new _C(n,e,t,r,i,s,o)}function ro(n){let e=$(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>hC(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Cd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ru(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ru(r)).join(",")),e.ue=t}return e.ue}function Dd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!sW(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!EO(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!pk(n.startAt,e.startAt)&&pk(n.endAt,e.endAt)}function Ag(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function xg(n,e){return n.filters.filter(t=>t instanceof _e&&t.field.isEqual(e))}function gk(n,e,t){let r=pg,i=!0;for(let s of xg(n,e)){let o=pg,a=!0;switch(s.op){case"<":case"<=":o=rW(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=pg}dk({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];dk({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function mk(n,e,t){let r=Ki,i=!0;for(let s of xg(n,e)){let o=Ki,a=!0;switch(s.op){case">=":case">":o=iW(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ki}hk({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];hk({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var Jn=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function bO(n,e,t,r,i,s,o,a){return new Jn(n,e,t,r,i,s,o,a)}function _u(n){return new Jn(n)}function yk(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function XD(n){return n.collectionGroup!==null}function Xa(n){let e=$(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Le(it.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new no(s,r))}),t.has(it.keyField().canonicalString())||e.ce.push(new no(it.keyField(),r))}return e.ce}function Jt(n){let e=$(n);return e.le||(e.le=oW(e,Xa(n))),e.le}function oW(n,e){if(n.limitType==="F")return wC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new no(i.field,s)});let t=n.endAt?new Sr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Sr(n.startAt.position,n.startAt.inclusive):null;return wC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function EC(n,e){let t=n.filters.concat([e]);return new Jn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Mg(n,e,t){return new Jn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function bd(n,e){return Dd(Jt(n),Jt(e))&&n.limitType===e.limitType}function TO(n){return`${ro(Jt(n))}|lt:${n.limitType}`}function Wa(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>CO(i)).join(", ")}]`),Cd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ru(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ru(i)).join(",")),`Target(${r})`}(Jt(n))}; limitType=${n.limitType})`}function Td(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):B.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Xa(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let l=fk(o,a,u);return o.inclusive?l<=0:l<0}(r.startAt,Xa(r),i)||r.endAt&&!function(o,a,u){let l=fk(o,a,u);return o.inclusive?l>=0:l>0}(r.endAt,Xa(r),i))}(n,e)}function SO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function AO(n){return(e,t)=>{let r=!1;for(let i of Xa(n)){let s=aW(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function aW(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(s,o,a){let u=o.data.field(s),l=a.data.field(s);return u!==null&&l!==null?es(u,l):G()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return G()}}var Ar=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ho(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return mO(this.inner)}size(){return this.innerSize}};var uW=new qe(B.comparator);function on(){return uW}var xO=new qe(B.comparator);function Kl(...n){let e=xO;for(let t of n)e=e.insert(t.key,t);return e}function MO(n){let e=xO;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ir(){return Zl()}function RO(){return Zl()}function Zl(){return new Ar(n=>n.toString(),(n,e)=>n.isEqual(e))}var cW=new qe(B.comparator),lW=new Le(B.comparator);function ce(...n){let e=lW;for(let t of n)e=e.add(t);return e}var dW=new Le(ue);function eb(){return dW}function NO(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nd(e)?"-0":e}}function PO(n){return{integerValue:""+n}}function kO(n,e){return lO(e)?PO(e):NO(n,e)}var su=class{constructor(){this._=void 0}};function hW(n,e,t){return n instanceof ts?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&gm(s)&&(s=ZD(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Xr?FO(n,e):n instanceof ei?VO(n,e):function(i,s){let o=OO(i,s),a=vk(o)+vk(i.Pe);return lC(o)&&lC(i.Pe)?PO(a):NO(i.serializer,a)}(n,e)}function fW(n,e,t){return n instanceof Xr?FO(n,e):n instanceof ei?VO(n,e):t}function OO(n,e){return n instanceof ns?function(r){return lC(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var ts=class extends su{},Xr=class extends su{constructor(e){super(),this.elements=e}};function FO(n,e){let t=LO(e);for(let r of n.elements)t.some(i=>Tr(i,r))||t.push(r);return{arrayValue:{values:t}}}var ei=class extends su{constructor(e){super(),this.elements=e}};function VO(n,e){let t=LO(e);for(let r of n.elements)t=t.filter(i=>!Tr(i,r));return{arrayValue:{values:t}}}var ns=class extends su{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function vk(n){return Je(n.integerValue||n.doubleValue)}function LO(n){return od(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var io=class{constructor(e,t){this.field=e,this.transform=t}};function pW(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Xr&&i instanceof Xr||r instanceof ei&&i instanceof ei?tu(r.elements,i.elements,Tr):r instanceof ns&&i instanceof ns?Tr(r.Pe,i.Pe):r instanceof ts&&i instanceof ts}(n.transform,e.transform)}var IC=class{constructor(e,t){this.version=e,this.transformResults=t}},Xe=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function mg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ou=class{};function jO(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new is(n.key,Xe.none()):new rs(n.key,n.data,Xe.none());{let t=n.data,r=Ut.empty(),i=new Le(it.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Xn(n.key,r,new _n(i.toArray()),Xe.none())}}function gW(n,e,t){n instanceof rs?function(i,s,o){let a=i.value.clone(),u=wk(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Xn?function(i,s,o){if(!mg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=wk(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(UO(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Jl(n,e,t,r){return n instanceof rs?function(s,o,a,u){if(!mg(s.precondition,o))return a;let l=s.value.clone(),d=Ek(s.fieldTransforms,u,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Xn?function(s,o,a,u){if(!mg(s.precondition,o))return a;let l=Ek(s.fieldTransforms,u,o),d=o.data;return d.setAll(UO(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(s,o,a){return mg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function mW(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=OO(r.transform,i||null);s!=null&&(t===null&&(t=Ut.empty()),t.set(r.field,s))}return t||null}function _k(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&tu(r,i,(s,o)=>pW(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var rs=class extends ou{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Xn=class extends ou{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function UO(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function wk(n,e,t){let r=new Map;K(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,fW(o,a,t[i]))}return r}function Ek(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,hW(s,o,e))}return r}var is=class extends ou{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ad=class extends ou{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var ud=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&gW(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Jl(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Jl(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=RO();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let u=jO(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(J.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ce())}isEqual(e){return this.batchId===e.batchId&&tu(this.mutations,e.mutations,(t,r)=>_k(t,r))&&tu(this.baseMutations,e.baseMutations,(t,r)=>_k(t,r))}},CC=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){K(e.mutations.length===r.length);let i=function(){return cW}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var cd=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var DC=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ut,Ie;function BO(n){switch(n){default:return G();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function $O(n){if(n===void 0)return rt("GRPC error has no .code"),R.UNKNOWN;switch(n){case ut.OK:return R.OK;case ut.CANCELLED:return R.CANCELLED;case ut.UNKNOWN:return R.UNKNOWN;case ut.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ut.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ut.INTERNAL:return R.INTERNAL;case ut.UNAVAILABLE:return R.UNAVAILABLE;case ut.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ut.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ut.NOT_FOUND:return R.NOT_FOUND;case ut.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ut.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ut.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ut.ABORTED:return R.ABORTED;case ut.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ut.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ut.DATA_LOSS:return R.DATA_LOSS;default:return G()}}(Ie=ut||(ut={}))[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";var Ik=null;function HO(){return new TextEncoder}var yW=new Hi([4294967295,4294967295],0);function Ck(n){let e=HO().encode(n),t=new jI;return t.update(e),new Uint8Array(t.digest())}function Dk(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Hi([t,r],0),new Hi([i,s],0)]}var bC=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Js(`Invalid padding: ${t}`);if(r<0)throw new Js(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Js(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Js(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Hi.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Hi.fromNumber(r)));return i.compare(yW)===1&&(i=new Hi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Ck(e),[r,i]=Dk(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=Ck(e),[r,i]=Dk(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Js=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ld=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,dd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(J.min(),i,new qe(ue),on(),ce())}},dd=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ce(),ce(),ce())}};var eu=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Rg=class{constructor(e,t){this.targetId=e,this.me=t}},Ng=class{constructor(e,t,r=Et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Pg=class{constructor(){this.fe=0,this.ge=Tk(),this.pe=Et.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=ce(),t=ce(),r=ce();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:G()}}),new dd(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=Tk()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,K(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},TC=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=on(),this.qe=bk(),this.Qe=new qe(ue)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:G()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Ag(s))if(r===0){let o=new B(s.path);this.Ue(t,o,ht.newNoDocument(o,J.min()))}else K(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}Ik?.et(function(d,f,g,y,_){var D,S,k,U,F,W;let te={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},X=f.unchangedNames;return X&&(te.bloomFilter={applied:_===0,hashCount:(D=X?.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(U=(k=(S=X?.bits)===null||S===void 0?void 0:S.bitmap)===null||k===void 0?void 0:k.length)!==null&&U!==void 0?U:0,padding:(W=(F=X?.bits)===null||F===void 0?void 0:F.padding)!==null&&W!==void 0?W:0,mightContain:I=>{var v;return(v=y?.mightContain(I))!==null&&v!==void 0&&v}}),te}(o,e.me,this.Le.tt(),a,u))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=Ji(r).toUint8Array()}catch(u){if(u instanceof bg)return Pn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new bC(o,i,s)}catch(u){return Pn(u instanceof Js?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&Ag(a.target)){let u=new B(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,ht.newNoDocument(u,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=ce();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let l=this.Je(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new ld(e,t,this.Qe,this.ke,r);return this.ke=on(),this.qe=bk(),this.Qe=new qe(ue),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Pg,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Le(ue),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Pg),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function bk(){return new qe(B.comparator)}function Tk(){return new qe(B.comparator)}var vW={asc:"ASCENDING",desc:"DESCENDING"},_W={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wW={and:"AND",or:"OR"},SC=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function AC(n,e){return n.useProto3Json||Cd(e)?e:{value:e}}function au(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qO(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function EW(n,e){return au(n,e.toTimestamp())}function st(n){return K(!!n),J.fromTimestamp(function(t){let r=Jr(t);return new Qe(r.seconds,r.nanos)}(n))}function tb(n,e){return xC(n,e).canonicalString()}function xC(n,e){let t=function(i){return new Ce(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function GO(n){let e=Ce.fromString(n);return K(t1(e)),e}function hd(n,e){return tb(n.databaseId,e.path)}function Dr(n,e){let t=GO(e);if(t.get(1)!==n.databaseId.projectId)throw new P(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(KO(t))}function zO(n,e){return tb(n.databaseId,e)}function WO(n){let e=GO(n);return e.length===4?Ce.emptyPath():KO(e)}function MC(n){return new Ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function KO(n){return K(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Sk(n,e,t){return{name:hd(n,e),fields:t.value.mapValue.fields}}function QO(n,e,t){let r=Dr(n,e.name),i=st(e.updateTime),s=e.createTime?st(e.createTime):J.min(),o=new Ut({mapValue:{fields:e.fields}}),a=ht.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function IW(n,e){return"found"in e?function(r,i){K(!!i.found),i.found.name,i.found.updateTime;let s=Dr(r,i.found.name),o=st(i.found.updateTime),a=i.found.createTime?st(i.found.createTime):J.min(),u=new Ut({mapValue:{fields:i.found.fields}});return ht.newFoundDocument(s,o,a,u)}(n,e):"missing"in e?function(r,i){K(!!i.missing),K(!!i.readTime);let s=Dr(r,i.missing),o=st(i.readTime);return ht.newNoDocument(s,o)}(n,e):G()}function CW(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:G()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(K(d===void 0||typeof d=="string"),Et.fromBase64String(d||"")):(K(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Et.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?R.UNKNOWN:$O(l.code);return new P(d,l.message||"")}(o);t=new Ng(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Dr(n,r.document.name),s=st(r.document.updateTime),o=r.document.createTime?st(r.document.createTime):J.min(),a=new Ut({mapValue:{fields:r.document.fields}}),u=ht.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new eu(l,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Dr(n,r.document),s=r.readTime?st(r.readTime):J.min(),o=ht.newNoDocument(i,s),a=r.removedTargetIds||[];t=new eu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Dr(n,r.document),s=r.removedTargetIds||[];t=new eu([],s,i,null)}else{if(!("filter"in e))return G();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new DC(i,s),a=r.targetId;t=new Rg(a,o)}}return t}function fd(n,e){let t;if(e instanceof rs)t={update:Sk(n,e.key,e.value)};else if(e instanceof is)t={delete:hd(n,e.key)};else if(e instanceof Xn)t={update:Sk(n,e.key,e.data),updateMask:xW(e.fieldMask)};else{if(!(e instanceof ad))return G();t={verify:hd(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof ts)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Xr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ei)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ns)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw G()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:EW(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:G()}(n,e.precondition)),t}function RC(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?Xe.updateTime(st(s.updateTime)):s.exists!==void 0?Xe.exists(s.exists):Xe.none()}(e.currentDocument):Xe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)K(a.setToServerValue==="REQUEST_TIME"),u=new ts;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];u=new Xr(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];u=new ei(d)}else"increment"in a?u=new ns(o,a.increment):G();let l=it.fromServerFormat(a.fieldPath);return new io(l,u)}(n,i)):[];if(e.update){e.update.name;let i=Dr(n,e.update.name),s=new Ut({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let l=u.fieldPaths||[];return new _n(l.map(d=>it.fromServerFormat(d)))}(e.updateMask);return new Xn(i,s,o,t,r)}return new rs(i,s,t,r)}if(e.delete){let i=Dr(n,e.delete);return new is(i,t)}if(e.verify){let i=Dr(n,e.verify);return new ad(i,t)}return G()}function DW(n,e){return n&&n.length>0?(K(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?st(i.updateTime):st(s);return o.isEqual(J.min())&&(o=st(s)),new IC(o,i.transformResults||[])}(t,e))):[]}function YO(n,e){return{documents:[zO(n,e.path)]}}function ZO(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=zO(n,i);let s=function(l){if(l.length!==0)return e1(Ne.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(g){return{field:Ka(g.field),direction:TW(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=AC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function JO(n){let e=WO(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){K(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(f){let g=XO(f);return g instanceof Ne&&JD(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(g=>function(_){return new no(Qa(_.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,Cd(g)?null:g}(t.limit));let u=null;t.startAt&&(u=function(f){let g=!!f.before,y=f.values||[];return new Sr(y,g)}(t.startAt));let l=null;return t.endAt&&(l=function(f){let g=!f.before,y=f.values||[];return new Sr(y,g)}(t.endAt)),bO(e,i,o,s,a,"F",u,l)}function bW(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return G()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function XO(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Qa(t.unaryFilter.field);return _e.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Qa(t.unaryFilter.field);return _e.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Qa(t.unaryFilter.field);return _e.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Qa(t.unaryFilter.field);return _e.create(o,"!=",{nullValue:"NULL_VALUE"});default:return G()}}(n):n.fieldFilter!==void 0?function(t){return _e.create(Qa(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return G()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ne.create(t.compositeFilter.filters.map(r=>XO(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return G()}}(t.compositeFilter.op))}(n):G()}function TW(n){return vW[n]}function SW(n){return _W[n]}function AW(n){return wW[n]}function Ka(n){return{fieldPath:n.canonicalString()}}function Qa(n){return it.fromServerFormat(n.fieldPath)}function e1(n){return n instanceof _e?function(t){if(t.op==="=="){if(lk(t.value))return{unaryFilter:{field:Ka(t.field),op:"IS_NAN"}};if(ck(t.value))return{unaryFilter:{field:Ka(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(lk(t.value))return{unaryFilter:{field:Ka(t.field),op:"IS_NOT_NAN"}};if(ck(t.value))return{unaryFilter:{field:Ka(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ka(t.field),op:SW(t.op),value:t.value}}}(n):n instanceof Ne?function(t){let r=t.getFilters().map(i=>e1(i));return r.length===1?r[0]:{compositeFilter:{op:AW(t.op),filters:r}}}(n):G()}function xW(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function t1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var uu=class n{constructor(e,t,r,i,s=J.min(),o=J.min(),a=Et.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var kg=class{constructor(e){this.ct=e}};function MW(n,e){let t;if(e.document)t=QO(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=B.fromSegments(e.noDocument.path),i=oo(e.noDocument.readTime);t=ht.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return G();{let r=B.fromSegments(e.unknownDocument.path),i=oo(e.unknownDocument.version);t=ht.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new Qe(i[0],i[1]);return J.fromTimestamp(s)}(e.readTime)),t}function Ak(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Og(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:hd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:au(s,o.version.toTimestamp()),createTime:au(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:so(e.version)};else{if(!e.isUnknownDocument())return G();r.unknownDocument={path:t.path.toArray(),version:so(e.version)}}return r}function Og(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function so(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function oo(n){let e=new Qe(n.seconds,n.nanoseconds);return J.fromTimestamp(e)}function Qs(n,e){let t=(e.baseMutations||[]).map(s=>RC(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>RC(n.ct,s)),i=Qe.fromMillis(e.localWriteTimeMs);return new ud(e.batchId,i,t,r)}function Ql(n){let e=oo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?oo(n.lastLimboFreeSnapshotVersion):J.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return K(s.documents.length===1),Jt(_u(WO(s.documents[0])))}(n.query):function(s){return Jt(JO(s))}(n.query),new uu(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Et.fromBase64String(n.resumeToken))}function n1(n,e){let t=so(e.snapshotVersion),r=so(e.lastLimboFreeSnapshotVersion),i;i=Ag(e.target)?YO(n.ct,e.target):ZO(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ro(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nb(n){let e=JO({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Mg(e,e.limit,"L"):e}function zI(n,e){return new cd(e.largestBatchId,RC(n.ct,e.overlayMutation))}function xk(n,e){let t=e.path.lastSegment();return[n,Zt(e.path.popLast()),t]}function Mk(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:so(r.readTime),documentKey:Zt(r.documentKey.path),largestBatchId:r.largestBatchId}}var NC=class{getBundleMetadata(e,t){return Rk(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:oo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return Rk(e).put(function(i){return{bundleId:i.id,createTime:so(st(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return Nk(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:nb(s.bundledQuery),readTime:oo(s.readTime)}}(r)})}saveNamedQuery(e,t){return Nk(e).put(function(i){return{name:i.name,readTime:so(st(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function Rk(n){return It(n,"bundles")}function Nk(n){return It(n,"namedQueries")}var Fg=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return ql(e).get(xk(this.userId,t)).next(r=>r?zI(this.serializer,r):null)}getOverlays(e,t){let r=Ir();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new cd(t,o);i.push(this.ht(e,a))}),x.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(Zt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(ql(e).j("collectionPathOverlayIndex",a))}),x.waitFor(s)}getOverlaysForCollection(e,t,r){let i=Ir(),s=Zt(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ql(e).U("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let l=zI(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=Ir(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ql(e).J({index:"collectionGroupOverlayIndex",range:a},(u,l,d)=>{let f=zI(this.serializer,l);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return ql(e).put(function(i,s,o){let[a,u,l]=xk(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:fd(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function ql(n){return It(n,"documentOverlays")}var Yr=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Je(e.integerValue));else if("doubleValue"in e){let r=Je(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),nd(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=Jr(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Ji(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?vO(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):G()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),B.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};Yr.bt=new Yr;function RW(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Pk(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=RW(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var PC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),r=Pk(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),r=Pk(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},kC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},OC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Ys=class{constructor(){this.Gt=new PC,this.zt=new kC(this.Gt),this.jt=new OC(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Zs=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function qi(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=kk(n.arrayValue,e.arrayValue),t!==0?t:(t=kk(n.directionalValue,e.directionalValue),t!==0?t:B.comparator(n.documentKey,e.documentKey)))}function kk(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Vg=class{constructor(e){this.Yt=new Le((t,r)=>it.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(K(e.collectionGroup===this.collectionId),this.en)return!1;let t=rC(e);if(t!==void 0&&!this.nn(t))return!1;let r=Ws(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.rn(a,u)||!this.sn(this.Zt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Le(it.comparator),t=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Ja(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ja(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ja(r.field,r.dir==="asc"?0:1)));return new nu(nu.UNKNOWN_ID,this.collectionId,t,td.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function r1(n){var e,t;if(K(n instanceof _e||n instanceof Ne),n instanceof _e){if(n instanceof Sg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>_e.create(n.field,"==",s)))||[];return Ne.create(i,"or")}return n}let r=n.filters.map(i=>r1(i));return Ne.create(r,n.op)}function NW(n){if(n.getFilters().length===0)return[];let e=LC(r1(n));return K(i1(e)),FC(e)||VC(e)?[e]:e.getFilters()}function FC(n){return n instanceof _e}function VC(n){return n instanceof Ne&&JD(n)}function i1(n){return FC(n)||VC(n)||function(t){if(t instanceof Ne&&dC(t)){for(let r of t.getFilters())if(!FC(r)&&!VC(r))return!1;return!0}return!1}(n)}function LC(n){if(K(n instanceof _e||n instanceof Ne),n instanceof _e)return n;if(n.filters.length===1)return LC(n.filters[0]);let e=n.filters.map(r=>LC(r)),t=Ne.create(e,n.op);return t=Lg(t),i1(t)?t:(K(t instanceof Ne),K(iu(t)),K(t.filters.length>1),t.filters.reduce((r,i)=>rb(r,i)))}function rb(n,e){let t;return K(n instanceof _e||n instanceof Ne),K(e instanceof _e||e instanceof Ne),t=n instanceof _e?e instanceof _e?function(i,s){return Ne.create([i,s],"and")}(n,e):Ok(n,e):e instanceof _e?Ok(e,n):function(i,s){if(K(i.filters.length>0&&s.filters.length>0),iu(i)&&iu(s))return IO(i,s.getFilters());let o=dC(i)?i:s,a=dC(i)?s:i,u=o.filters.map(l=>rb(l,a));return Ne.create(u,"or")}(n,e),Lg(t)}function Ok(n,e){if(iu(e))return IO(e,n.getFilters());{let t=e.filters.map(r=>rb(n,r));return Ne.create(t,"or")}}function Lg(n){if(K(n instanceof _e||n instanceof Ne),n instanceof _e)return n;let e=n.getFilters();if(e.length===1)return Lg(e[0]);if(wO(n))return n;let t=e.map(i=>Lg(i)),r=[];return t.forEach(i=>{i instanceof _e?r.push(i):i instanceof Ne&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ne.create(r,n.op)}var jC=class{constructor(){this._n=new pd}addToCollectionParentIndex(e,t){return this._n.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(kn.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(kn.min())}updateCollectionGroup(e,t,r){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},pd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Le(Ce.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Le(Ce.comparator)).toArray()}};var cg=new Uint8Array(0),UC=class{constructor(e,t){this.databaseId=t,this.an=new pd,this.un=new Ar(r=>ro(r),(r,i)=>Dd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:r,parent:Zt(i)};return Fk(e).put(s)}return x.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[sO(t),""],!1,!0);return Fk(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(Er(o.parent))}return r})}addFieldIndex(e,t){let r=Gl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=qa(e);return s.next(a=>{o.put(Mk(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=Gl(e),i=qa(e),s=Ha(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Gl(e),r=Ha(e),i=qa(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return x.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Vg(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=Ha(e),i=!0,s=new Map;return x.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ce(),a=[];return x.forEach(s,(u,l)=>{O("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(W=>`${W.fieldPath}:${W.kind}`).join(",")}`}(u)} to execute ${ro(t)}`);let d=function(F,W){let te=rC(W);if(te===void 0)return null;for(let X of xg(F,te.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null}(l,u),f=function(F,W){let te=new Map;for(let X of Ws(W))for(let I of xg(F,X.fieldPath))switch(I.op){case"==":case"in":te.set(X.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return te.set(X.fieldPath.canonicalString(),I.value),Array.from(te.values())}return null}(l,u),g=function(F,W){let te=[],X=!0;for(let I of Ws(W)){let v=I.kind===0?gk(F,I.fieldPath,F.startAt):mk(F,I.fieldPath,F.startAt);te.push(v.value),X&&(X=v.inclusive)}return new Sr(te,X)}(l,u),y=function(F,W){let te=[],X=!0;for(let I of Ws(W)){let v=I.kind===0?mk(F,I.fieldPath,F.endAt):gk(F,I.fieldPath,F.endAt);te.push(v.value),X&&(X=v.inclusive)}return new Sr(te,X)}(l,u),_=this.hn(u,l,g),D=this.hn(u,l,y),S=this.Pn(u,l,f),k=this.In(u.indexId,d,_,g.inclusive,D,y.inclusive,S);return x.forEach(k,U=>r.G(U,t.limit).next(F=>{F.forEach(W=>{let te=B.fromSegments(W.documentKey);o.has(te)||(o=o.add(te),a.push(te))})}))}).next(()=>a)}return x.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=NW(Ne.create(e.filters,"and")).map(r=>wC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){let u=(t!=null?t.length:1)*Math.max(r.length,s.length),l=u/(t!=null?t.length:1),d=[];for(let f=0;f<u;++f){let g=t?this.Tn(t[f/l]):cg,y=this.En(e,g,r[f%l],i),_=this.dn(e,g,s[f%l],o),D=a.map(S=>this.En(e,g,S,!0));d.push(...this.createRange(y,_,D))}return d}En(e,t,r,i){let s=new Zs(e,B.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){let s=new Zs(e,B.empty(),t,r);return i?s.Jt():s}ln(e,t){let r=new Vg(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return x.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let l=new Le(it.comparator),d=!1;for(let f of u.filters)for(let g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:l=l.add(g.field));for(let f of u.orderBy)f.field.isKeyField()||(l=l.add(f.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){let r=new Ys;for(let i of Ws(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Yr.bt.Pt(s,o)}return r.Wt()}Tn(e){let t=new Ys;return Yr.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let r=new Ys;return Yr.bt.Pt(to(this.databaseId,t),r.Ht(function(s){let o=Ws(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new Ys);let s=0;for(let o of Ws(e)){let a=r[s++];for(let u of i)if(this.Vn(t,o.fieldPath)&&od(a))i=this.mn(i,o,a);else{let l=u.Ht(o.kind);Yr.bt.Pt(a,l)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new Ys;u.seed(a.Wt()),Yr.bt.Pt(o,u.Ht(t.kind)),s.push(u)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof _e&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Gl(e),i=qa(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return x.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(d,f){let g=f?new td(f.sequenceNumber,new kn(oo(f.readTime),new B(Er(f.documentKey)),f.largestBatchId)):td.empty(),y=d.fields.map(([_,D])=>new Ja(it.fromServerFormat(_),D));return new nu(d.indexId,d.collectionGroup,y,g)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ue(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Gl(e),s=qa(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>x.forEach(a,u=>s.put(Mk(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return x.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?x.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),x.forEach(a,u=>this.pn(e,i,u).next(l=>{let d=this.yn(s,u);return l.isEqual(d)?x.resolve():this.wn(e,s,u,l,d)}))))})}Sn(e,t,r,i){return Ha(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return Ha(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){let i=Ha(e),s=new Le(qi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new Zs(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new Le(qi),i=this.An(t,e);if(i==null)return r;let s=rC(t);if(s!=null){let o=e.data.field(s.fieldPath);if(od(o))for(let a of o.arrayValue.values||[])r=r.add(new Zs(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new Zs(t.indexId,e.key,cg,i));return r}wn(e,t,r,i,s){O("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(u,l,d,f,g){let y=u.getIterator(),_=l.getIterator(),D=$a(y),S=$a(_);for(;D||S;){let k=!1,U=!1;if(D&&S){let F=d(D,S);F<0?U=!0:F>0&&(k=!0)}else D!=null?U=!0:k=!0;k?(f(S),S=$a(_)):U?(g(D),D=$a(y)):(D=$a(y),S=$a(_))}}(i,s,qi,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),x.waitFor(o)}gn(e){let t=1;return qa(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>qi(o,a)).filter((o,a,u)=>!a||qi(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=qi(o,e),u=qi(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&u<0)i.push(o),i.push(o.Jt());else if(u>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,cg,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,cg,[]];s.push(IDBKeyRange.bound(a,u))}return s}Dn(e,t){return qi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Vk)}getMinOffset(e,t){return x.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||G())).next(Vk)}};function Fk(n){return It(n,"collectionParents")}function Ha(n){return It(n,"indexEntries")}function Gl(n){return It(n,"indexConfiguration")}function qa(n){return It(n,"indexState")}function Vk(n){K(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;QD(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new kn(e.readTime,e.documentKey,t)}var Lk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Nn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function s1(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,u=r.J({range:o},(d,f,g)=>(a++,g.delete()));s.push(u.next(()=>{K(a===1)}));let l=[];for(let d of t.mutations){let f=dO(e,d.key.path,t.batchId);s.push(i.delete(f)),l.push(d.key)}return x.waitFor(s).next(()=>l)}function jg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw G();e=n.noDocument}return JSON.stringify(e).length}Nn.DEFAULT_COLLECTION_PERCENTILE=10,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nn.DEFAULT=new Nn(41943040,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nn.DISABLED=new Nn(-1,0,0);var Ug=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){K(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gi(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=Ya(e),o=Gi(e);return o.add({}).next(a=>{K(typeof a=="number");let u=new ud(a,t,r,i),l=function(y,_,D){let S=D.baseMutations.map(U=>fd(y.ct,U)),k=D.mutations.map(U=>fd(y.ct,U));return{userId:_,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:S,mutations:k}}(this.serializer,this.userId,u),d=[],f=new Le((g,y)=>ue(g.canonicalString(),y.canonicalString()));for(let g of i){let y=dO(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(o.put(l)),d.push(s.put(y,j9))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Cn[a]=u.keys()}),x.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return Gi(e).get(t).next(r=>r?(K(r.userId===this.userId),Qs(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?x.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Gi(e).J({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(K(a.batchId>=r),s=Qs(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Gi(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gi(e).U("userMutationsIndex",t).next(r=>r.map(i=>Qs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=fg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Ya(e).J({range:i},(o,a,u)=>{let[l,d,f]=o,g=Er(d);if(l===this.userId&&t.path.isEqual(g))return Gi(e).get(f).next(y=>{if(!y)throw G();K(y.userId===this.userId),s.push(Qs(this.serializer,y))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Le(ue),i=[];return t.forEach(s=>{let o=fg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Ya(e).J({range:a},(l,d,f)=>{let[g,y,_]=l,D=Er(y);g===this.userId&&s.path.isEqual(D)?r=r.add(_):f.done()});i.push(u)}),x.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=fg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Le(ue);return Ya(e).J({range:o},(u,l,d)=>{let[f,g,y]=u,_=Er(g);f===this.userId&&r.isPrefixOf(_)?_.length===i&&(a=a.add(y)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(Gi(e).get(s).next(o=>{if(o===null)throw G();K(o.userId===this.userId),r.push(Qs(this.serializer,o))}))}),x.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return s1(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),x.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return x.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ya(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=Er(s[1]);i.push(u)}else a.done()}).next(()=>{K(i.length===0)})})}containsKey(e,t){return o1(e,this.userId,t)}xn(e){return a1(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function o1(n,e,t){let r=fg(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Ya(n).J({range:s,H:!0},(a,u,l)=>{let[d,f,g]=a;d===e&&f===i&&(o=!0),l.done()}).next(()=>o)}function Gi(n){return It(n,"mutations")}function Ya(n){return It(n,"documentMutations")}function a1(n){return It(n,"mutationQueues")}var cu=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var BC=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let r=new cu(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>J.fromTimestamp(new Qe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ga(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(K(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return Ga(e).J((o,a)=>{let u=Ql(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>x.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Ga(e).J((r,i)=>{let s=Ql(i);t(s)})}Bn(e){return jk(e).get("targetGlobalKey").next(t=>(K(t!==null),t))}kn(e,t){return jk(e).put("targetGlobalKey",t)}qn(e,t){return Ga(e).put(n1(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=ro(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Ga(e).J({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let l=Ql(a);Dd(t,l.target)&&(s=l,u.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=zi(e);return t.forEach(o=>{let a=Zt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),x.waitFor(i)}removeMatchingKeys(e,t,r){let i=zi(e);return x.forEach(t,s=>{let o=Zt(s.path);return x.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=zi(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=zi(e),s=ce();return i.J({range:r,H:!0},(o,a,u)=>{let l=Er(o[1]),d=new B(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=Zt(t.path),i=IDBKeyRange.bound([r],[sO(r)],!1,!0),s=0;return zi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],u,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return Ga(e).get(t).next(r=>r?Ql(r):null)}};function Ga(n){return It(n,"targets")}function jk(n){return It(n,"targetGlobal")}function zi(n){return It(n,"targetDocuments")}function Uk([n,e],[t,r]){let i=ue(n,t);return i===0?ue(e,r):i}var $C=class{constructor(e){this.Kn=e,this.buffer=new Le(Uk),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Uk(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},HC=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){O("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>N(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){as(t)?O("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield os(t)}yield this.zn(3e5)}))}},qC=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return x.resolve(vn.oe);let r=new $C(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(Lk)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lk):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,u,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(l=Date.now(),za()<=En.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${f} documents in `+(l-u)+`ms
Total Duration: ${l-d}ms`),x.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}};function PW(n,e){return new qC(n,e)}var GC=class{constructor(e,t){this.db=e,this.garbageCollector=PW(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return lg(e,r)}removeReference(e,t,r){return lg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return lg(e,t)}er(e,t){return function(i,s){let o=!1;return a1(i).Y(a=>o1(i,a,s).next(u=>(u&&(o=!0),x.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=t){let u=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,J.min()),zi(e).delete(function(f){return[0,Zt(f.path)]}(o))))});i.push(u)}}).next(()=>x.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return lg(e,t)}Xn(e,t){let r=zi(e),i,s=vn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:l})=>{o===0?(s!==vn.oe&&t(new B(Er(i)),s),s=l,i=u):s=vn.oe}).next(()=>{s!==vn.oe&&t(new B(Er(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function lg(n,e){return zi(n).put(function(r,i){return{targetId:0,path:Zt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Bg=class{constructor(){this.changes=new Ar(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ht.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?x.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var zC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return zs(e).put(r)}removeEntry(e,t,r){return zs(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Og(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=ht.newInvalidDocument(t);return zs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(zl(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:ht.newInvalidDocument(t)};return zs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(zl(t))},(i,s)=>{r={document:this.nr(t,s),size:jg(s)}}).next(()=>r)}getEntries(e,t){let r=on();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=on(),i=new qe(B.comparator);return this.ir(e,t,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,jg(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return x.resolve();let i=new Le(Hk);t.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(zl(i.first()),zl(i.last())),o=i.getIterator(),a=o.getNext();return zs(e).J({index:"documentKeyIndex",range:s},(u,l,d)=>{let f=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&Hk(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(zl(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Og(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return zs(e).U(IDBKeyRange.bound(a,u,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=on();for(let f of l){let g=this.nr(B.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(Td(t,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=on(),o=$k(t,r),a=$k(t,kn.max());return zs(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,l,d)=>{let f=this.nr(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(f.key,f),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new WC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Bk(e).get("remoteDocumentGlobalKey").next(t=>(K(!!t),t))}tr(e,t){return Bk(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let r=MW(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(J.min())))return r}return ht.newInvalidDocument(e)}};function u1(n){return new zC(n)}var WC=class extends Bg{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Ar(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Le((s,o)=>ue(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=Ak(this.ar.serializer,o);i=i.add(s.path.popLast());let l=jg(u);r+=l-a.size,t.push(this.ar.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=Ak(this.ar.serializer,o.convertToNoDocument(J.min()));t.push(this.ar.addEntry(e,s,u))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),x.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function Bk(n){return It(n,"remoteDocumentGlobal")}function zs(n){return It(n,"remoteDocumentsV14")}function zl(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function $k(n,e){let t=e.documentKey.path.toArray();return[n,Og(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Hk(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ue(t[s],r[s]),i)return i;return i=ue(t.length,r.length),i||(i=ue(t[t.length-2],r[r.length-2]),i||ue(t[t.length-1],r[r.length-1]))}var KC=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var $g=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Jl(r.mutation,i,_n.empty(),Qe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ce()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ce()){let i=Ir();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Kl();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Ir();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ce()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=on(),o=Zl(),a=function(){return Zl()}();return t.forEach((u,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Xn)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),Jl(d.mutation,l,d.mutation.getFieldMask(),Qe.now())):o.set(l.key,_n.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var f;return a.set(l,new KC(d,(f=o.get(l))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Zl(),i=new qe((o,a)=>o-a),s=ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(u=>{let l=t.get(u);if(l===null)return;let d=r.get(u)||_n.empty();d=a.applyToLocalView(l,d),r.set(u,d);let f=(i.get(a.batchId)||ce()).add(u);i=i.insert(a.batchId,f)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),l=u.key,d=u.value,f=RO();d.forEach(g=>{if(!s.has(g)){let y=jO(t.get(g),r.get(g));y!==null&&f.set(g,y),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,f))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return B.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):XD(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):x.resolve(Ir()),a=-1,u=s;return o.next(l=>x.forEach(l,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?x.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{u=u.insert(d,g)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,ce())).next(d=>({batchId:a,changes:MO(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=Kl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Kl();return this.indexManager.getCollectionParents(e,s).next(a=>x.forEach(a,u=>{let l=function(f,g){return new Jn(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,ht.newInvalidDocument(d)))});let a=Kl();return o.forEach((u,l)=>{let d=s.get(u);d!==void 0&&Jl(d.mutation,l,_n.empty(),Qe.now()),Td(t,l)&&(a=a.insert(u,l))}),a})}};var QC=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return x.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:st(i.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:nb(i.bundledQuery),readTime:st(i.readTime)}}(t)),x.resolve()}};var YC=class{constructor(){this.overlays=new qe(B.comparator),this.hr=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Ir();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),x.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),x.resolve()}getOverlaysForCollection(e,t,r){let i=Ir(),s=t.length+1,o=new B(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return x.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new qe((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=Ir(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=Ir(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return x.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new cd(t,r));let s=this.hr.get(t);s===void 0&&(s=ce(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var gd=class{constructor(){this.Pr=new Le(ct.Ir),this.Tr=new Le(ct.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new ct(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new ct(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new B(new Ce([])),r=new ct(t,e),i=new ct(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new B(new Ce([])),r=new ct(t,e),i=new ct(t,e+1),s=ce();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new ct(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ct=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return B.comparator(e.key,t.key)||ue(e.pr,t.pr)}static Er(e,t){return ue(e.pr,t.pr)||B.comparator(e.key,t.key)}};var ZC=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Le(ct.Ir)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new ud(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new ct(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,t){return x.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return x.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ct(t,0),i=new ct(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),x.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Le(ue);return t.forEach(i=>{let s=new ct(i,0),o=new ct(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),x.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;B.isDocumentKey(s)||(s=s.child(""));let o=new ct(new B(s),0),a=new Le(ue);return this.wr.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.pr)),!0)},o),x.resolve(this.Dr(a))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){K(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return x.forEach(t.mutations,i=>{let s=new ct(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new ct(t,0),i=this.wr.firstAfterOrEqual(r);return x.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var JC=class{constructor(e){this.vr=e,this.docs=function(){return new qe(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return x.resolve(r?r.document.mutableCopy():ht.newInvalidDocument(t))}getEntries(e,t){let r=on();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ht.newInvalidDocument(i))}),x.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=on(),o=t.path,a=new B(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:l,value:{document:d}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||QD(aO(d),r)<=0||(i.has(d.key)||Td(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,t,r,i){G()}Fr(e,t){return x.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new XC(this)}getSize(e){return x.resolve(this.size)}},XC=class extends Bg{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),x.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var eD=class{constructor(e){this.persistence=e,this.Mr=new Ar(t=>ro(t),Dd),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.Or=0,this.Nr=new gd,this.targetCount=0,this.Lr=cu.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),x.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new cu(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.qn(t),x.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),x.waitFor(s).next(()=>i)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return x.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),x.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),x.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),x.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return x.resolve(r)}containsKey(e,t){return x.resolve(this.Nr.containsKey(t))}};var Hg=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new vn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new eD(this),this.indexManager=new jC,this.remoteDocumentCache=function(i){return new JC(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new kg(t),this.$r=new QC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new YC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new ZC(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new tD(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return x.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},tD=class extends Ig{constructor(e){super(),this.currentSequenceNumber=e}},qg=class n{constructor(e){this.persistence=e,this.zr=new gd,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw G()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),x.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),x.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Jr,r=>{let i=B.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,J.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return x.or([()=>x.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var nD=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new Cg("createOrUpgrade",t);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ok,{unique:!0}),u.createObjectStore("documentMutations")}(e),qk(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=x.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),qk(e)),o=o.next(()=>function(u){let l=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:J.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,l){return l.store("mutations").U().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ok,{unique:!0});let f=l.store("mutations"),g=d.map(y=>f.put(y));return x.waitFor(g)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let l=u.createObjectStore("documentOverlays",{keyPath:Z9});l.createIndex("collectionPathOverlayIndex",J9,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",X9,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let l=u.createObjectStore("remoteDocumentsV14",{keyPath:U9});l.createIndex("documentKeyIndex",B9),l.createIndex("collectionGroupIndex",$9)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:W9}).createIndex("sequenceNumberIndex",K9,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:Q9}).createIndex("documentKeyIndex",Y9,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=jg(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>x.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>x.forEach(a,u=>{K(u.userId===s.userId);let l=Qs(this.serializer,u);return s1(e,s.userId,l).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let u=new Ce(o),l=function(f){return[0,Zt(f)]}(u);s.push(t.get(l).next(d=>d?x.resolve():(f=>t.put({targetId:0,path:Zt(f),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>x.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:z9});let r=t.store("collectionParents"),i=new pd,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Zt(u)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let u=new Ce(o);return s(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,u],l)=>{let d=Er(a);return s(d.popLast())}))}ri(e){let t=e.store("targets");return t.J((r,i)=>{let s=Ql(i),o=n1(this.serializer,s);return t.put(o)})}ii(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),u=function(f){return f.document?new B(Ce.fromString(f.document.name).popFirst(5)):f.noDocument?B.fromSegments(f.noDocument.path):f.unknownDocument?B.fromSegments(f.unknownDocument.path):G()}(o).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>x.waitFor(i))}si(e,t){let r=t.store("mutations"),i=u1(this.serializer),s=new Hg(qg.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(u=>{var l;let d=(l=a.get(u.userId))!==null&&l!==void 0?l:ce();Qs(this.serializer,u).keys().forEach(f=>d=d.add(f)),a.set(u.userId,d)}),x.forEach(a,(u,l)=>{let d=new lt(l),f=Fg.lt(this.serializer,d),g=s.getIndexManager(d),y=Ug.lt(d,this.serializer,g,s.referenceDelegate);return new $g(i,y,f,g).recalculateAndSaveOverlaysForDocumentKeys(new rd(t,vn.oe),u).next()})})}};function qk(n){n.createObjectStore("targetDocuments",{keyPath:q9}).createIndex("documentTargetsIndex",G9,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",H9,{unique:!0}),n.createObjectStore("targetGlobal")}var WI="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rD=class n{constructor(e,t,r,i,s,o,a,u,l,d,f=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=d,this.ui=f,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=g=>Promise.resolve(),!n.D())throw new P(R.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new GC(this,i),this.Ti=t+"main",this.serializer=new kg(u),this.Ei=new Zi(this.Ti,this.ui,new nD(this.serializer)),this.Qr=new BC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=u1(this.serializer),this.$r=new NC,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&rt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(R.FAILED_PRECONDITION,WI);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new vn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>N(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>N(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>N(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>dg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(as(e))return O("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return O("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Wl(e).get("owner").next(t=>x.resolve(this.Si(t)))}bi(e){return dg(e).delete(this.clientId)}Di(){return N(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=It(t,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return x.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?x.resolve(!0):Wl(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new P(R.FAILED_PRECONDITION,WI);return!1}}return!(!this.networkEnabled||!this.inForeground)||dg(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&O("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return N(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new rd(e,vn.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>dg(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return Ug.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new UC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Fg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){O("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(u){return u===16?tW:u===15?gO:u===14?pO:u===13?fO:u===12?eW:u===11?hO:void G()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new rd(a,this.kr?this.kr.next():vn.oe),t==="readwrite-primary"?this.gi(o).next(u=>!!u||this.pi(o)).next(u=>{if(!u)throw rt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new P(R.FAILED_PRECONDITION,uO);return r(o)}).next(u=>this.wi(o).next(()=>u)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return Wl(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new P(R.FAILED_PRECONDITION,WI)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Wl(e).put("owner",t)}static D(){return Zi.D()}yi(e){let t=Wl(e);return t.get("owner").next(r=>this.Si(r)?(O("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):x.resolve())}Ci(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(rt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;ry()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return O("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return rt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){rt("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Wl(n){return It(n,"owner")}function dg(n){return It(n,"clientMetadata")}function ib(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var iD=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=ce(),i=ce();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var sD=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Gg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return ry()?8:cO(Wu())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new sD;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(za()<=En.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",Wa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),x.resolve()):(za()<=En.DEBUG&&O("QueryEngine","Query:",Wa(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(za()<=En.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",Wa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jt(t))):x.resolve())}ji(e,t){if(yk(t))return x.resolve(null);let r=Jt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Mg(t,null,"F"),r=Jt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ce(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.Zi(t,a);return this.Xi(t,l,o,u.readTime)?this.ji(e,Mg(t,null,"F")):this.es(e,l,t,u)}))})))}Hi(e,t,r,i){return yk(t)||i.isEqual(J.min())?x.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?x.resolve(null):(za()<=En.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wa(t)),this.es(e,o,t,oO(i,-1)).next(a=>a))})}Zi(e,t){let r=new Le(AO(e));return t.forEach((i,s)=>{Td(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return za()<=En.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",Wa(t)),this.zi.getDocumentsMatchingQuery(e,t,kn.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var oD=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new qe(ue),this.rs=new Ar(s=>ro(s),Dd),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $g(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function c1(n,e,t,r){return new oD(n,e,t,r)}function l1(n,e){return N(this,null,function*(){let t=$(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=ce();for(let l of i){o.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function kW(n,e){let t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,u,l,d){let f=l.batch,g=f.keys(),y=x.resolve();return g.forEach(_=>{y=y.next(()=>d.getEntry(u,_)).next(D=>{let S=l.docVersions.get(_);K(S!==null),D.version.compareTo(S)<0&&(f.applyToRemoteDocument(D,l),D.isValidDocument()&&(D.setReadTime(l.commitVersion),d.addEntry(D)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(u,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ce();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function d1(n){let e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function OW(n,e){let t=$(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let a=[];e.targetChanges.forEach((d,f)=>{let g=i.get(f);if(!g)return;a.push(t.Qr.removeMatchingKeys(s,d.removedDocuments,f).next(()=>t.Qr.addMatchingKeys(s,d.addedDocuments,f)));let y=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Et.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),i=i.insert(f,y),function(D,S,k){return D.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(g,y,d)&&a.push(t.Qr.updateTargetData(s,y))});let u=on(),l=ce();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(h1(s,o,e.documentUpdates).next(d=>{u=d.cs,l=d.ls})),!r.isEqual(J.min())){let d=t.Qr.getLastRemoteSnapshotVersion(s).next(f=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return x.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,l)).next(()=>u)}).then(s=>(t.ns=i,s))}function h1(n,e,t){let r=ce(),i=ce();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=on();return t.forEach((a,u)=>{let l=s.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(J.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):O("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{cs:o,ls:i}})}function FW(n,e){let t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function lu(n,e){let t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,x.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new uu(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function du(n,e,t){return N(this,null,function*(){let r=$(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!as(o))throw o;O("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function zg(n,e,t){let r=$(n),i=J.min(),s=ce();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,l,d){let f=$(u),g=f.rs.get(d);return g!==void 0?x.resolve(f.ns.get(g)):f.Qr.getTargetData(l,d)}(r,o,Jt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:J.min(),t?s:ce())).next(a=>(g1(r,SO(e),a),{documents:a,hs:s})))}function f1(n,e){let t=$(n),r=$(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function p1(n,e){let t=$(n),r=t.ss.get(e)||J.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,oO(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(g1(t,e,i),i))}function g1(n,e,t){let r=n.ss.get(e)||J.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}function VW(n,e,t,r){return N(this,null,function*(){let i=$(n),s=ce(),o=on();for(let l of t){let d=e.Ps(l.metadata.name);l.document&&(s=s.add(d));let f=e.Is(l);f.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(d,f)}let a=i.os.newChangeBuffer({trackRemovals:!0}),u=yield lu(i,function(d){return Jt(_u(Ce.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>h1(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.Qr.addMatchingKeys(l,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.cs,d.ls)).next(()=>d.cs)))})}function LW(r,i){return N(this,arguments,function*(n,e,t=ce()){let s=yield lu(n,Jt(nb(e.bundledQuery))),o=$(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=st(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(Et.EMPTY_BYTE_STRING,u);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,t,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function Gk(n,e){return`firestore_clients_${n}_${e}`}function zk(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function KI(n,e){return`firestore_targets_${n}_${e}`}var Wg=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new P(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(rt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Xl=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new P(r.error.code,r.error.message))),s?new n(e,r.state,i):(rt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Kg=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=eb();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=lO(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(rt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},aD=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(rt("SharedClientState",`Failed to parse online state: ${e}`),null)}},md=class{constructor(){this.activeTargetIds=eb()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},ed=class{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new qe(ue),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=Gk(this.persistenceKey,this.Vs),this.Ss=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new md),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Fs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return N(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(Gk(this.persistenceKey,r));if(i){let s=Kg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let r=this.xs(t);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(KI(this.persistenceKey,e));if(r){let i=Xl.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(KI(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return O("SharedClientState","READ",e,t),t}setItem(e,t){O("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){O("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(O("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void rt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>N(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let r=this.$s(t.key);return this.Us(r,null)}{let r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){let r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){let r=function(s){let o=vn.oe;if(s!=null)try{let a=JSON.parse(s);K(typeof a=="number"),o=a}catch(a){rt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==vn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){let r=this.Js(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){let i=new Wg(this.currentUser,e,t,r),s=zk(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=zk(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){let i=KI(this.persistenceKey,e),s=new Xl(e,t,r);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let r=this.$s(e);return Kg.Es(r,t)}Gs(e,t){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Wg.Es(new lt(s),i,t)}js(e,t){let r=this.Cs.exec(e),i=Number(r[1]);return Xl.Es(i,t)}xs(e){return aD.Es(e)}Js(e){return JSON.parse(e)}zs(e){return N(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);O("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=eb();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Qg=class{constructor(){this.no=new md,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new md,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var uD=class{io(e){}shutdown(){}};var Yg=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var hg=null;function QI(){return hg===null?hg=function(){return 268435456+Math.round(2147483648*Math.random())}():hg++,"0x"+hg.toString(16)}var jW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var cD=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var jt="WebChannelConnection",lD=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let a=QI(),u=this.vo(t,r.toUriEncodedString());O("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(t,u,l,i).then(d=>(O("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Pn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",u,"request:",i),d})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+vu}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=jW[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=QI();return new Promise((o,a)=>{let u=new UI;u.setWithCredentials(!0),u.listenOnce($I.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Hl.NO_ERROR:let d=u.getResponseJson();O(jt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Hl.TIMEOUT:O(jt,`RPC '${e}' ${s} timed out`),a(new P(R.DEADLINE_EXCEEDED,"Request time out"));break;case Hl.HTTP_ERROR:let f=u.getStatus();if(O(jt,`RPC '${e}' ${s} failed with status:`,f,"response text:",u.getResponseText()),f>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);let y=g?.error;if(y&&y.status&&y.message){let _=function(S){let k=S.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(k)>=0?k:R.UNKNOWN}(y.status);a(new P(_,y.message))}else a(new P(R.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new P(R.UNAVAILABLE,"Connection failed."));break;default:G()}}finally{O(jt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);O(jt,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",l,r,15)})}Oo(e,t,r){let i=QI(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=GI(),a=qI(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.xmlHttpFactory=new BI({})),this.Fo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let d=s.join("");O(jt,`Creating RPC '${e}' stream ${i}: ${d}`,u);let f=o.createWebChannel(d,u),g=!1,y=!1,_=new cD({lo:S=>{y?O(jt,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(O(jt,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),O(jt,`RPC '${e}' stream ${i} sending:`,S),f.send(S))},ho:()=>f.close()}),D=(S,k,U)=>{S.listen(k,F=>{try{U(F)}catch(W){setTimeout(()=>{throw W},0)}})};return D(f,Ba.EventType.OPEN,()=>{y||(O(jt,`RPC '${e}' stream ${i} transport opened.`),_.mo())}),D(f,Ba.EventType.CLOSE,()=>{y||(y=!0,O(jt,`RPC '${e}' stream ${i} transport closed`),_.po())}),D(f,Ba.EventType.ERROR,S=>{y||(y=!0,Pn(jt,`RPC '${e}' stream ${i} transport errored:`,S),_.po(new P(R.UNAVAILABLE,"The operation could not be completed")))}),D(f,Ba.EventType.MESSAGE,S=>{var k;if(!y){let U=S.data[0];K(!!U);let F=U,W=F.error||((k=F[0])===null||k===void 0?void 0:k.error);if(W){O(jt,`RPC '${e}' stream ${i} received error:`,W);let te=W.status,X=function(E){let C=ut[E];if(C!==void 0)return $O(C)}(te),I=W.message;X===void 0&&(X=R.INTERNAL,I="Unknown error status: "+te+" with message "+W.message),y=!0,_.po(new P(X,I)),f.close()}else O(jt,`RPC '${e}' stream ${i} received:`,U),_.yo(U)}}),D(a,HI.STAT_EVENT,S=>{S.stat===ug.PROXY?O(jt,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===ug.NOPROXY&&O(jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.fo()},0),_}};function m1(){return typeof window<"u"?window:null}function yg(){return typeof document<"u"?document:null}function Sd(n){return new SC(n,!0)}var yd=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var Zg=class{constructor(e,t,r,i,s,o,a,u){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new yd(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return N(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return N(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return N(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(rt(t.toString()),rt("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new P(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>N(this,null,function*(){this.state=0,this.start()}))}c_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},dD=class extends Zg{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=CW(this.serializer,e),r=function(s){if(!("targetChange"in s))return J.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?J.min():o.readTime?st(o.readTime):J.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=MC(this.serializer),t.addTarget=function(s,o){let a,u=o.target;if(a=Ag(u)?{documents:YO(s,u)}:{query:ZO(s,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=qO(s,o.resumeToken);let l=AC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(J.min())>0){a.readTime=au(s,o.snapshotVersion.toTimestamp());let l=AC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=bW(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=MC(this.serializer),t.removeTarget=e,this.i_(t)}},hD=class extends Zg{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(K(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=DW(e.writeResults,e.commitTime),r=st(e.commitTime);return this.listener.A_(r,t)}return K(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=MC(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>fd(this.serializer,r))};this.i_(t)}};var fD=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new P(R.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,xC(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(R.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,xC(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(R.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},pD=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(rt(t),this.y_=!1):O("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var gD=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>N(this,null,function*(){us(this)&&(O("RemoteStore","Restarting streams for network reachability change."),yield function(u){return N(this,null,function*(){let l=$(u);l.M_.add(4),yield wu(l),l.N_.set("Unknown"),l.M_.delete(4),yield Ad(l)})}(this))}))}),this.N_=new pD(r,i)}};function Ad(n){return N(this,null,function*(){if(us(n))for(let e of n.x_)yield e(!0)})}function wu(n){return N(this,null,function*(){for(let e of n.x_)yield e(!1)})}function mm(n,e){let t=$(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),ab(t)?ob(t):Iu(t).Xo()&&sb(t,e))}function hu(n,e){let t=$(n),r=Iu(t);t.F_.delete(e),r.Xo()&&y1(t,e),t.F_.size===0&&(r.Xo()?r.n_():us(t)&&t.N_.set("Unknown"))}function sb(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(J.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Iu(n).P_(e)}function y1(n,e){n.L_.xe(e),Iu(n).I_(e)}function ob(n){n.L_=new TC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Iu(n).start(),n.N_.w_()}function ab(n){return us(n)&&!Iu(n).Zo()&&n.F_.size>0}function us(n){return $(n).M_.size===0}function v1(n){n.L_=void 0}function UW(n){return N(this,null,function*(){n.N_.set("Online")})}function BW(n){return N(this,null,function*(){n.F_.forEach((e,t)=>{sb(n,e)})})}function $W(n,e){return N(this,null,function*(){v1(n),ab(n)?(n.N_.D_(e),ob(n)):n.N_.set("Unknown")})}function HW(n,e,t){return N(this,null,function*(){if(n.N_.set("Online"),e instanceof Ng&&e.state===2&&e.cause)try{yield function(i,s){return N(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(n,e)}catch(r){O("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Jg(n,r)}else if(e instanceof eu?n.L_.Ke(e):e instanceof Rg?n.L_.He(e):n.L_.We(e),!t.isEqual(J.min()))try{let r=yield d1(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let d=s.F_.get(l);d&&s.F_.set(l,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,l)=>{let d=s.F_.get(u);if(!d)return;s.F_.set(u,d.withResumeToken(Et.EMPTY_BYTE_STRING,d.snapshotVersion)),y1(s,u);let f=new uu(d.target,u,l,d.sequenceNumber);sb(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){O("RemoteStore","Failed to raise snapshot:",r),yield Jg(n,r)}})}function Jg(n,e,t){return N(this,null,function*(){if(!as(e))throw e;n.M_.add(1),yield wu(n),n.N_.set("Offline"),t||(t=()=>d1(n.localStore)),n.asyncQueue.enqueueRetryable(()=>N(this,null,function*(){O("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield Ad(n)}))})}function _1(n,e){return e().catch(t=>Jg(n,t,e))}function Eu(n){return N(this,null,function*(){let e=$(n),t=ss(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;qW(e);)try{let i=yield FW(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,GW(e,i)}catch(i){yield Jg(e,i)}w1(e)&&E1(e)})}function qW(n){return us(n)&&n.v_.length<10}function GW(n,e){n.v_.push(e);let t=ss(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function w1(n){return us(n)&&!ss(n).Zo()&&n.v_.length>0}function E1(n){ss(n).start()}function zW(n){return N(this,null,function*(){ss(n).V_()})}function WW(n){return N(this,null,function*(){let e=ss(n);for(let t of n.v_)e.d_(t.mutations)})}function KW(n,e,t){return N(this,null,function*(){let r=n.v_.shift(),i=CC.from(r,e,t);yield _1(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Eu(n)})}function QW(n,e){return N(this,null,function*(){e&&ss(n).E_&&(yield function(r,i){return N(this,null,function*(){if(function(o){return BO(o)&&o!==R.ABORTED}(i.code)){let s=r.v_.shift();ss(r).t_(),yield _1(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Eu(r)}})}(n,e)),w1(n)&&E1(n)})}function Wk(n,e){return N(this,null,function*(){let t=$(n);t.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");let r=us(t);t.M_.add(3),yield wu(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield Ad(t)})}function mD(n,e){return N(this,null,function*(){let t=$(n);e?(t.M_.delete(2),yield Ad(t)):e||(t.M_.add(2),yield wu(t),t.N_.set("Unknown"))})}function Iu(n){return n.B_||(n.B_=function(t,r,i){let s=$(t);return s.f_(),new dD(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:UW.bind(null,n),To:BW.bind(null,n),Ao:$W.bind(null,n),h_:HW.bind(null,n)}),n.x_.push(e=>N(this,null,function*(){e?(n.B_.t_(),ab(n)?ob(n):n.N_.set("Unknown")):(yield n.B_.stop(),v1(n))}))),n.B_}function ss(n){return n.k_||(n.k_=function(t,r,i){let s=$(t);return s.f_(),new hD(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:zW.bind(null,n),Ao:QW.bind(null,n),R_:WW.bind(null,n),A_:KW.bind(null,n)}),n.x_.push(e=>N(this,null,function*(){e?(n.k_.t_(),yield Eu(n)):(yield n.k_.stop(),n.v_.length>0&&(O("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var yD=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Cu(n,e){if(rt("AsyncQueue",`${e}: ${n}`),as(n))return new P(R.UNAVAILABLE,`${e}: ${n}`);throw n}var Xg=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=Kl(),this.sortedSet=new qe(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var em=class{constructor(){this.q_=new qe(B.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):G():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},fu=class n{constructor(e,t,r,i,s,o,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Xg.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var vD=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},_D=class{constructor(){this.queries=new Ar(e=>TO(e),bd),this.onlineState="Unknown",this.z_=new Set}};function ub(n,e){return N(this,null,function*(){let t=$(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new vD,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=Cu(o,`Initialization of query '${Wa(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&lb(t)})}function cb(n,e){return N(this,null,function*(){let t=$(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function YW(n,e){let t=$(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&lb(t)}function ZW(n,e,t){let r=$(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function lb(n){n.z_.forEach(e=>{e.next()})}var wD,Kk;(Kk=wD||(wD={})).J_="default",Kk.Cache="cache";var vd=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new fu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=fu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==wD.Cache}};var ED=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var tm=class{constructor(e){this.serializer=e}Ps(e){return Dr(this.serializer,e)}Is(e){return e.metadata.exists?QO(this.serializer,e.document,!1):ht.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return st(e)}},ID=class{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=I1(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let r=Ce.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,r=new tm(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||ce()).add(s);t.set(o,a)}}return t}complete(){return N(this,null,function*(){let e=yield VW(this.localStore,new tm(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let r of this.queries)yield LW(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function I1(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var nm=class{constructor(e){this.key=e}},rm=class{constructor(e){this.key=e}},im=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=ce(),this.mutatedKeys=ce(),this.Ia=AO(e),this.Ta=new Xg(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new em,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{let g=i.get(d),y=Td(this.query,f)?f:null,_=!!g&&this.mutatedKeys.has(g.key),D=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),S=!1;g&&y?g.data.isEqual(y.data)?_!==D&&(r.track({type:3,doc:y}),S=!0):this.Ra(g,y)||(r.track({type:2,doc:y}),S=!0,(u&&this.Ia(y,u)>0||l&&this.Ia(y,l)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),S=!0):g&&!y&&(r.track({type:1,doc:g}),S=!0,(u||l)&&(a=!0)),S&&(y?(o=o.add(y),s=D?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,f)=>function(y,_){let D=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return G()}};return D(y)-D(_)}(d.type,f.type)||this.Ia(d.doc,f.doc)),this.Va(r),i=i!=null&&i;let a=t&&!i?this.ma():[],u=this.Pa.size===0&&this.current&&!i?1:0,l=u!==this.ha;return this.ha=u,o.length!==0||l?{snapshot:new fu(this.query,e.Ta,s,o,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new em,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=ce(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new rm(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new nm(r))}),t}pa(e){this.la=e.hs,this.Pa=ce();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return fu.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},CD=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},DD=class{constructor(e){this.key=e,this.wa=!1}},bD=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Ar(a=>TO(a),bd),this.Da=new Map,this.Ca=new Set,this.va=new qe(B.comparator),this.Fa=new Map,this.Ma=new gd,this.xa={},this.Oa=new Map,this.Na=cu.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function JW(n,e,t=!0){return N(this,null,function*(){let r=ym(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield C1(r,e,t,!0),i})}function XW(n,e){return N(this,null,function*(){let t=ym(n);yield C1(t,e,!0,!1)})}function C1(n,e,t,r){return N(this,null,function*(){let i=yield lu(n.localStore,Jt(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield db(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&mm(n.remoteStore,i),a})}function db(n,e,t,r,i){return N(this,null,function*(){n.Ba=(f,g,y)=>function(D,S,k,U){return N(this,null,function*(){let F=S.view.da(k);F.Xi&&(F=yield zg(D.localStore,S.query,!1).then(({documents:I})=>S.view.da(I,F)));let W=U&&U.targetChanges.get(S.targetId),te=U&&U.targetMismatches.get(S.targetId)!=null,X=S.view.applyChanges(F,D.isPrimaryClient,W,te);return TD(D,S.targetId,X.fa),X.snapshot})}(n,f,g,y);let s=yield zg(n.localStore,e,!0),o=new im(e,s.hs),a=o.da(s.documents),u=dd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,u);TD(n,t,l.fa);let d=new CD(e,t,o);return n.ba.set(e,d),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),l.snapshot})}function e3(n,e,t){return N(this,null,function*(){let r=$(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!bd(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield du(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&hu(r.remoteStore,i.targetId),pu(r,i.targetId)}).catch(os))):(pu(r,i.targetId),yield du(r.localStore,i.targetId,!0))})}function t3(n,e){return N(this,null,function*(){let t=$(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),hu(t.remoteStore,r.targetId))})}function n3(n,e,t){return N(this,null,function*(){let r=gb(n);try{let i=yield function(o,a){let u=$(o),l=Qe.now(),d=a.reduce((y,_)=>y.add(_.key),ce()),f,g;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let _=on(),D=ce();return u.os.getEntries(y,d).next(S=>{_=S,_.forEach((k,U)=>{U.isValidDocument()||(D=D.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,_)).next(S=>{f=S;let k=[];for(let U of a){let F=mW(U,f.get(U.key).overlayedDocument);F!=null&&k.push(new Xn(U.key,F,_O(F.value.mapValue),Xe.exists(!0)))}return u.mutationQueue.addMutationBatch(y,l,k,a)}).next(S=>{g=S;let k=S.applyToLocalDocumentSet(f,D);return u.documentOverlayCache.saveOverlays(y,S.batchId,k)})}).then(()=>({batchId:g.batchId,changes:MO(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let l=o.xa[o.currentUser.toKey()];l||(l=new qe(ue)),l=l.insert(a,u),o.xa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield ri(r,i.changes),yield Eu(r.remoteStore)}catch(i){let s=Cu(i,"Failed to persist write");t.reject(s)}})}function D1(n,e){return N(this,null,function*(){let t=$(n);try{let r=yield OW(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(K(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?K(o.wa):i.removedDocuments.size>0&&(K(o.wa),o.wa=!1))}),yield ri(t,r,e)}catch(r){yield os(r)}})}function Qk(n,e,t){let r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=$(o);u.onlineState=a;let l=!1;u.queries.forEach((d,f)=>{for(let g of f.U_)g.j_(a)&&(l=!0)}),l&&lb(u)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function r3(n,e,t){return N(this,null,function*(){let r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new qe(B.comparator);o=o.insert(s,ht.newNoDocument(s,J.min()));let a=ce().add(s),u=new ld(J.min(),new Map,new qe(ue),o,a);yield D1(r,u),r.va=r.va.remove(s),r.Fa.delete(e),pb(r)}else yield du(r.localStore,e,!1).then(()=>pu(r,e,t)).catch(os)})}function i3(n,e){return N(this,null,function*(){let t=$(n),r=e.batch.batchId;try{let i=yield kW(t.localStore,e);fb(t,r,null),hb(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ri(t,i)}catch(i){yield os(i)}})}function s3(n,e,t){return N(this,null,function*(){let r=$(n);try{let i=yield function(o,a){let u=$(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return u.mutationQueue.lookupMutationBatch(l,a).next(f=>(K(f!==null),d=f.keys(),u.mutationQueue.removeMutationBatch(l,f))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>u.localDocuments.getDocuments(l,d))})}(r.localStore,e);fb(r,e,t),hb(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ri(r,i)}catch(i){yield os(i)}})}function o3(n,e){return N(this,null,function*(){let t=$(n);us(t.remoteStore)||O("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=$(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){let i=Cu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function hb(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function fb(n,e,t){let r=$(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function pu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||b1(n,r)})}function b1(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(hu(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),pb(n))}function TD(n,e,t){for(let r of t)r instanceof nm?(n.Ma.addReference(r.key,e),a3(n,r)):r instanceof rm?(O("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||b1(n,r.key)):G()}function a3(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(O("SyncEngine","New document in limbo: "+t),n.Ca.add(r),pb(n))}function pb(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new B(Ce.fromString(e)),r=n.Na.next();n.Fa.set(r,new DD(t)),n.va=n.va.insert(t,r),mm(n.remoteStore,new uu(Jt(_u(t.path)),r,"TargetPurposeLimboResolution",vn.oe))}}function ri(n,e,t){return N(this,null,function*(){let r=$(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,u)=>{o.push(r.Ba(u,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let d=l&&!l.fromCache;r.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(l){i.push(l);let d=iD.Ki(u.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(u,l){return N(this,null,function*(){let d=$(u);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>x.forEach(l,g=>x.forEach(g.qi,y=>d.persistence.referenceDelegate.addReference(f,g.targetId,y)).next(()=>x.forEach(g.Qi,y=>d.persistence.referenceDelegate.removeReference(f,g.targetId,y)))))}catch(f){if(!as(f))throw f;O("LocalStore","Failed to update sequence numbers: "+f)}for(let f of l){let g=f.targetId;if(!f.fromCache){let y=d.ns.get(g),_=y.snapshotVersion,D=y.withLastLimboFreeSnapshotVersion(_);d.ns=d.ns.insert(g,D)}}})}(r.localStore,s))})}function u3(n,e){return N(this,null,function*(){let t=$(n);if(!t.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());let r=yield l1(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(u=>{u.reject(new P(R.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ri(t,r.us)}})}function c3(n,e){let t=$(n),r=t.Fa.get(e);if(r&&r.wa)return ce().add(r.key);{let i=ce(),s=t.Da.get(e);if(!s)return i;for(let o of s){let a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function l3(n,e){return N(this,null,function*(){let t=$(n),r=yield zg(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&TD(t,e.targetId,i.fa),i})}function d3(n,e){return N(this,null,function*(){let t=$(n);return p1(t.localStore,e).then(r=>ri(t,r))})}function h3(n,e,t,r){return N(this,null,function*(){let i=$(n),s=yield function(a,u){let l=$(a),d=$(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.vn(f,u).next(g=>g?l.localDocuments.getDocuments(f,g):x.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Eu(i.remoteStore):t==="acknowledged"||t==="rejected"?(fb(i,e,r||null),hb(i,e),function(a,u){$($(a).mutationQueue).Mn(u)}(i.localStore,e)):G(),yield ri(i,s)):O("SyncEngine","Cannot apply mutation batch with id: "+e)})}function f3(n,e){return N(this,null,function*(){let t=$(n);if(ym(t),gb(t),e===!0&&t.La!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Yk(t,r.toArray());t.La=!0,yield mD(t.remoteStore,!0);for(let s of i)mm(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let r=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(pu(t,o),du(t.localStore,o,!0))),hu(t.remoteStore,o)}),yield i,yield Yk(t,r),function(o){let a=$(o);a.Fa.forEach((u,l)=>{hu(a.remoteStore,l)}),a.Ma.mr(),a.Fa=new Map,a.va=new qe(B.comparator)}(t),t.La=!1,yield mD(t.remoteStore,!1)}})}function Yk(n,e,t){return N(this,null,function*(){let r=$(n),i=[],s=[];for(let o of e){let a,u=r.Da.get(o);if(u&&u.length!==0){a=yield lu(r.localStore,Jt(u[0]));for(let l of u){let d=r.ba.get(l),f=yield l3(r,d);f.snapshot&&s.push(f.snapshot)}}else{let l=yield f1(r.localStore,o);a=yield lu(r.localStore,l),yield db(r,T1(l),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function T1(n){return bO(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function p3(n){return function(t){return $($(t).persistence).Bi()}($(n).localStore)}function g3(n,e,t,r){return N(this,null,function*(){let i=$(n);if(i.La)return void O("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield p1(i.localStore,SO(s[0])),a=ld.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Et.EMPTY_BYTE_STRING);yield ri(i,o,a);break}case"rejected":yield du(i.localStore,e,!0),pu(i,e,r);break;default:G()}})}function m3(n,e,t){return N(this,null,function*(){let r=ym(n);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){O("SyncEngine","Adding an already active target "+i);continue}let s=yield f1(r.localStore,i),o=yield lu(r.localStore,s);yield db(r,T1(s),o.targetId,!1,o.resumeToken),mm(r.remoteStore,o)}for(let i of t)r.Da.has(i)&&(yield du(r.localStore,i,!1).then(()=>{hu(r.remoteStore,i),pu(r,i)}).catch(os))}})}function ym(n){let e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=D1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=c3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=r3.bind(null,e),e.Sa.h_=YW.bind(null,e.eventManager),e.Sa.ka=ZW.bind(null,e.eventManager),e}function gb(n){let e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=i3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s3.bind(null,e),e}function y3(n,e,t){let r=$(n);(function(s,o,a){return N(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(y,_){let D=$(y),S=st(_.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",k=>D.$r.getBundleMetadata(k,_.id)).then(k=>!!k&&k.createTime.compareTo(S)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(I1(u));let l=new ID(u,s.localStore,o.serializer),d=yield o.qa();for(;d;){let g=yield l._a(d);g&&a._updateProgress(g),d=yield o.qa()}let f=yield l.complete();return yield ri(s,f.ca,void 0),yield function(y,_){let D=$(y);return D.persistence.runTransaction("Save bundle","readwrite",S=>D.$r.saveBundleMetadata(S,_))}(s.localStore,u),a._completeWith(f.progress),Promise.resolve(f.ua)}catch(u){return Pn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var _d=class{constructor(){this.synchronizeTabs=!1}initialize(e){return N(this,null,function*(){this.serializer=Sd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return c1(this.persistence,new Gg,e.initialUser,this.serializer)}createPersistence(e){return new Hg(qg.Hr,this.serializer)}createSharedClientState(e){return new Qg}terminate(){return N(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var sm=class n extends _d{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return N(this,null,function*(){yield ty(n.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield gb(this.Qa.syncEngine),yield Eu(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return c1(this.persistence,new Gg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new HC(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new aC(t,this.persistence);return new oC(e.asyncQueue,r)}createPersistence(e){let t=ib(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new rD(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,m1(),yg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Qg}},SD=class n extends sm{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return N(this,null,function*(){yield ty(n.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof ed&&(this.sharedClientState.syncEngine={Zs:h3.bind(null,t),Xs:g3.bind(null,t),eo:m3.bind(null,t),Bi:p3.bind(null,t),Ys:d3.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>N(this,null,function*(){yield f3(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=m1();if(!ed.D(t))throw new P(R.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=ib(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ed(t,e.asyncQueue,r,e.clientId,e.initialUser)}},wd=class{initialize(e,t){return N(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Qk(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=u3.bind(null,this.syncEngine),yield mD(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new _D}()}createDatastore(e){let t=Sd(e.databaseInfo.databaseId),r=function(s){return new lD(s)}(e.databaseInfo);return function(s,o,a,u){return new fD(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new gD(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Qk(this.syncEngine,t,0),function(){return Yg.D()?new Yg:new uD}())}createSyncEngine(e,t){return function(i,s,o,a,u,l,d){let f=new bD(i,s,o,a,u,l);return d&&(f.La=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return N(this,null,function*(){var e;yield function(r){return N(this,null,function*(){let i=$(r);O("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield wu(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function Zk(n,e=10240){let t=0;return{read(){return N(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return N(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var gu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):rt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var AD=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new dt,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return N(this,null,function*(){return this.metadata.promise})}qa(){return N(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return N(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(r);return new ED(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return N(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return N(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return N(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var xD=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return N(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(R.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return N(this,null,function*(){let o=$(i),a={documents:s.map(f=>hd(o.serializer,f))},u=yield o.xo("BatchGetDocuments",o.serializer.databaseId,Ce.emptyPath(),a,s.length),l=new Map;u.forEach(f=>{let g=IW(o.serializer,f);l.set(g.key.toString(),g)});let d=[];return s.forEach(f=>{let g=l.get(f.toString());K(!!g),d.push(g)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new is(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return N(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=B.fromPath(r);this.mutations.push(new ad(i,this.precondition(i)))}),yield function(r,i){return N(this,null,function*(){let s=$(r),o={writes:i.map(a=>fd(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,Ce.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw G();t=J.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new P(R.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(J.min())?Xe.exists(!1):Xe.updateTime(t):Xe.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(J.min()))throw new P(R.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Xe.updateTime(t)}return Xe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var MD=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new yd(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>N(this,null,function*(){let e=new xD(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let t=this.updateFunction(e);return!Cd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!BO(t)}return!1}};var RD=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=lt.UNAUTHENTICATED,this.clientId=wg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>N(this,null,function*(){O("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(O("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new P(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new dt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>N(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Cu(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function vg(n,e){return N(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>N(this,null,function*(){r.isEqual(i)||(yield l1(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function ND(n,e){return N(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield mb(n);O("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Wk(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Wk(e.remoteStore,i)),n._onlineComponents=e})}function S1(n){return n.name==="FirebaseError"?n.code===R.FAILED_PRECONDITION||n.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function mb(n){return N(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{yield vg(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!S1(t))throw t;Pn("Error using user provided cache. Falling back to memory cache: "+t),yield vg(n,new _d)}}else O("FirestoreClient","Using default OfflineComponentProvider"),yield vg(n,new _d);return n._offlineComponents})}function vm(n){return N(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),yield ND(n,n._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),yield ND(n,new wd))),n._onlineComponents})}function A1(n){return mb(n).then(e=>e.persistence)}function yb(n){return mb(n).then(e=>e.localStore)}function x1(n){return vm(n).then(e=>e.remoteStore)}function vb(n){return vm(n).then(e=>e.syncEngine)}function v3(n){return vm(n).then(e=>e.datastore)}function mu(n){return N(this,null,function*(){let e=yield vm(n),t=e.eventManager;return t.onListen=JW.bind(null,e.syncEngine),t.onUnlisten=e3.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=XW.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=t3.bind(null,e.syncEngine),t})}function _3(n){return n.asyncQueue.enqueue(()=>N(this,null,function*(){let e=yield A1(n),t=yield x1(n);return e.setNetworkEnabled(!0),function(i){let s=$(i);return s.M_.delete(0),Ad(s)}(t)}))}function w3(n){return n.asyncQueue.enqueue(()=>N(this,null,function*(){let e=yield A1(n),t=yield x1(n);return e.setNetworkEnabled(!1),function(i){return N(this,null,function*(){let s=$(i);s.M_.add(0),yield wu(s),s.N_.set("Offline")})}(t)}))}function E3(n,e){let t=new dt;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,s,o){return N(this,null,function*(){try{let a=yield function(l,d){let f=$(l);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new P(R.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=Cu(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield yb(n),e,t)})),t.promise}function M1(n,e,t={}){let r=new dt;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(s,o,a,u,l){let d=new gu({next:g=>{o.enqueueAndForget(()=>cb(s,f));let y=g.docs.has(a);!y&&g.fromCache?l.reject(new P(R.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&u&&u.source==="server"?l.reject(new P(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new vd(_u(a.path),d,{includeMetadataChanges:!0,ra:!0});return ub(s,f)}(yield mu(n),n.asyncQueue,e,t,r)})),r.promise}function I3(n,e){let t=new dt;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,s,o){return N(this,null,function*(){try{let a=yield zg(i,s,!0),u=new im(s,a.hs),l=u.da(a.documents),d=u.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let u=Cu(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield yb(n),e,t)})),t.promise}function R1(n,e,t={}){let r=new dt;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(s,o,a,u,l){let d=new gu({next:g=>{o.enqueueAndForget(()=>cb(s,f)),g.fromCache&&u.source==="server"?l.reject(new P(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new vd(a,d,{includeMetadataChanges:!0,ra:!0});return ub(s,f)}(yield mu(n),n.asyncQueue,e,t,r)})),r.promise}function C3(n,e){let t=new gu(e);return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,s){$(i).z_.add(s),s.next()}(yield mu(n),t)})),()=>{t.$a(),n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,s){$(i).z_.delete(s)}(yield mu(n),t)}))}}function D3(n,e,t,r){let i=function(o,a){let u;return u=typeof o=="string"?HO().encode(o):o,function(d,f){return new AD(d,f)}(function(d,f){if(d instanceof Uint8Array)return Zk(d,f);if(d instanceof ArrayBuffer)return Zk(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(t,Sd(e));n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){y3(yield vb(n),i,r)}))}function b3(n,e){return n.asyncQueue.enqueue(()=>N(this,null,function*(){return function(r,i){let s=$(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield yb(n),e)}))}function N1(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Jk=new Map;function _b(n,e,t){if(!t)throw new P(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function wb(n,e,t,r){if(e===!0&&r===!0)throw new P(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Xk(n){if(!B.isDocumentKey(n))throw new P(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function eO(n){if(B.isDocumentKey(n))throw new P(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function _m(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":G()}function De(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=_m(n);throw new P(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function P1(n,e){if(e<=0)throw new P(R.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var om=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}wb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=N1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new P(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new P(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new P(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ao=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new om({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new P(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new P(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new om(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new YI;switch(r.type){case"firstParty":return new eC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Jk.get(t);r&&(O("ComponentProvider","Removing Datastore"),Jk.delete(t),r.terminate())}(this),Promise.resolve()}};function k1(n,e,t,r={}){var i;let s=(n=De(n,ao))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Pn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=lt.MOCK_USER;else{a=Yd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new P(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new lt(l)}n._authCredentials=new ZI(new _g(a,u))}}var At=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Be=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new br(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},br=class n extends At{constructor(e,t,r){super(e,t,_u(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Be(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Eb(n,e,...t){if(n=ye(n),_b("collection","path",e),n instanceof ao){let r=Ce.fromString(e,...t);return eO(r),new br(n,null,r)}{if(!(n instanceof Be||n instanceof br))throw new P(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ce.fromString(e,...t));return eO(r),new br(n.firestore,null,r)}}function O1(n,e){if(n=De(n,ao),_b("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(R.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new At(n,null,function(r){return new Jn(Ce.emptyPath(),r)}(e))}function xd(n,e,...t){if(n=ye(n),arguments.length===1&&(e=wg.newId()),_b("doc","path",e),n instanceof ao){let r=Ce.fromString(e,...t);return Xk(r),new Be(n,null,new B(r))}{if(!(n instanceof Be||n instanceof br))throw new P(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ce.fromString(e,...t));return Xk(r),new Be(n.firestore,n instanceof br?n.converter:null,new B(r))}}function Ib(n,e){return n=ye(n),e=ye(e),(n instanceof Be||n instanceof br)&&(e instanceof Be||e instanceof br)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Cb(n,e){return n=ye(n),e=ye(e),n instanceof At&&e instanceof At&&n.firestore===e.firestore&&bd(n._query,e._query)&&n.converter===e.converter}var PD=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new yd(this,"async_queue_retry"),this.hu=()=>{let t=yg();t&&O("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=yg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=yg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new dt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return N(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!as(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw rt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=yD.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&G()}verifyOperationInProgress(){}du(){return N(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function kD(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var OD=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new dt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var F1=-1,We=class extends ao{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new PD}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||V1(this),this._firestoreClient.terminate()}};function gt(n){return n._firestoreClient||V1(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function V1(n){var e,t,r;let i=n._freezeSettings(),s=function(a,u,l,d){return new uC(a,u,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,N1(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new RD(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function L1(n,e){W1(n=De(n,We));let t=gt(n);if(t._uninitializedComponentsProvider)throw new P(R.FAILED_PRECONDITION,"SDK cache is already specified.");Pn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new wd;return U1(t,i,new sm(i,r.cacheSizeBytes,e?.forceOwnership))}function j1(n){W1(n=De(n,We));let e=gt(n);if(e._uninitializedComponentsProvider)throw new P(R.FAILED_PRECONDITION,"SDK cache is already specified.");Pn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new wd;return U1(e,r,new SD(r,t.cacheSizeBytes))}function U1(n,e,t){let r=new dt;return n.asyncQueue.enqueue(()=>N(this,null,function*(){try{yield vg(n,t),yield ND(n,e),r.resolve()}catch(i){let s=i;if(!S1(s))throw s;Pn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function B1(n){if(n._initialized&&!n._terminated)throw new P(R.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new dt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>N(this,null,function*(){try{yield function(r){return N(this,null,function*(){if(!Zi.D())return Promise.resolve();let i=r+"main";yield Zi.delete(i)})}(ib(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function $1(n){return function(t){let r=new dt;return t.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return o3(yield vb(t),r)})),r.promise}(gt(n=De(n,We)))}function H1(n){return _3(gt(n=De(n,We)))}function q1(n){return w3(gt(n=De(n,We)))}function G1(n,e){let t=gt(n=De(n,We)),r=new OD;return D3(t,n._databaseId,e,r),r}function z1(n,e){return b3(gt(n=De(n,We)),e).then(t=>t?new At(n,null,t.query):null)}function W1(n){if(n._initialized||n._terminated)throw new P(R.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var xr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Et.fromBase64String(e))}catch(t){throw new P(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var er=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new it(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ti=class{constructor(e){this._methodName=e}};var uo=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ue(this._lat,e._lat)||ue(this._long,e._long)}};var T3=/^__.*__$/,FD=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Xn(e,this.data,this.fieldMask,t,this.fieldTransforms):new rs(e,this.data,t,this.fieldTransforms)}},am=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Xn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function K1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G()}}var um=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return cm(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(K1(this.fu)&&T3.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},VD=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Sd(e)}Fu(e,t,r,i=!1){return new um({fu:e,methodName:t,vu:r,path:it.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function fo(n){let e=n._freezeSettings(),t=Sd(n._databaseId);return new VD(n._databaseId,!!e.ignoreUndefinedProperties,t)}function wm(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);Tb("Data must be an object, but it was:",o,r);let a=Z1(r,o),u,l;if(s.merge)u=new _n(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let f of s.mergeFields){let g=$D(e,f,t);if(!o.contains(g))throw new P(R.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);X1(d,g)||d.push(g)}u=new _n(d),l=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,l=o.fieldTransforms;return new FD(new Ut(a),u,l)}var Ed=class n extends ti{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function Q1(n,e,t){return new um({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var LD=class n extends ti{_toFieldTransform(e){return new io(e.path,new ts)}isEqual(e){return e instanceof n}},jD=class n extends ti{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=Q1(this,e,!0),r=this.Mu.map(s=>po(s,t)),i=new Xr(r);return new io(e.path,i)}isEqual(e){return e instanceof n&&iy(this.Mu,e.Mu)}},UD=class n extends ti{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=Q1(this,e,!0),r=this.Mu.map(s=>po(s,t)),i=new ei(r);return new io(e.path,i)}isEqual(e){return e instanceof n&&iy(this.Mu,e.Mu)}},BD=class n extends ti{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new ns(e.serializer,kO(e.serializer,this.xu));return new io(e.path,t)}isEqual(e){return e instanceof n&&this.xu===e.xu}};function Db(n,e,t,r){let i=n.Fu(1,e,t);Tb("Data must be an object, but it was:",i,r);let s=[],o=Ut.empty();ho(r,(u,l)=>{let d=Sb(e,u,t);l=ye(l);let f=i.Su(d);if(l instanceof Ed)s.push(d);else{let g=po(l,f);g!=null&&(s.push(d),o.set(d,g))}});let a=new _n(s);return new am(o,a,i.fieldTransforms)}function bb(n,e,t,r,i,s){let o=n.Fu(1,e,t),a=[$D(e,r,t)],u=[i];if(s.length%2!=0)throw new P(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push($D(e,s[g])),u.push(s[g+1]);let l=[],d=Ut.empty();for(let g=a.length-1;g>=0;--g)if(!X1(l,a[g])){let y=a[g],_=u[g];_=ye(_);let D=o.Su(y);if(_ instanceof Ed)l.push(y);else{let S=po(_,D);S!=null&&(l.push(y),d.set(y,S))}}let f=new _n(l);return new am(d,f,o.fieldTransforms)}function Y1(n,e,t,r=!1){return po(t,n.Fu(r?4:3,e))}function po(n,e){if(J1(n=ye(n)))return Tb("Unsupported field value:",e,n),Z1(n,e);if(n instanceof ti)return function(r,i){if(!K1(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=po(a,i.bu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Qe.fromDate(r);return{timestampValue:au(i.serializer,s)}}if(r instanceof Qe){let s=new Qe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:au(i.serializer,s)}}if(r instanceof uo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof xr)return{bytesValue:qO(i.serializer,r._byteString)};if(r instanceof Be){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:tb(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${_m(r)}`)}(n,e)}function Z1(n,e){let t={};return mO(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ho(n,(r,i)=>{let s=po(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function J1(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Qe||n instanceof uo||n instanceof xr||n instanceof Be||n instanceof ti)}function Tb(n,e,t){if(!J1(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=_m(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function $D(n,e,t){if((e=ye(e))instanceof er)return e._internalPath;if(typeof e=="string")return Sb(n,e);throw cm("Field path arguments must be of type string or ",n,!1,void 0,t)}var S3=new RegExp("[~\\*/\\[\\]]");function Sb(n,e,t){if(e.search(S3)>=0)throw cm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new er(...e.split("."))._internalPath}catch{throw cm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function cm(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new P(R.INVALID_ARGUMENT,a+n+u)}function X1(n,e){return n.some(t=>t.isEqual(e))}var co=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new HD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Em("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},HD=class extends co{data(){return super.data()}};function Em(n,e){return typeof e=="string"?Sb(n,e):e instanceof er?e._internalPath:e._delegate._internalPath}function eF(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Id=class{},lo=class extends Id{};function ii(n,e,...t){let r=[];e instanceof Id&&r.push(e),r=r.concat(t),function(s){let o=s.filter(u=>u instanceof qD).length,a=s.filter(u=>u instanceof lm).length;if(o>1||o>0&&a>0)throw new P(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var lm=class n extends lo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return lF(e._query,t),new At(e.firestore,e.converter,EC(e._query,t))}_parse(e){let t=fo(e.firestore);return function(s,o,a,u,l,d,f){let g;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new P(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){nO(f,d);let y=[];for(let _ of f)y.push(tO(u,s,_));g={arrayValue:{values:y}}}else g=tO(u,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||nO(f,d),g=Y1(a,o,f,d==="in"||d==="not-in");return _e.create(l,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function tF(n,e,t){let r=e,i=Em("where",n);return lm._create(i,r,t)}var qD=class n extends Id{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ne.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)lF(o,u),o=EC(o,u)}(e._query,t),new At(e.firestore,e.converter,EC(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var GD=class n extends lo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new P(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new no(s,o)}(e._query,this._field,this._direction);return new At(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Jn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function nF(n,e="asc"){let t=e,r=Em("orderBy",n);return GD._create(r,t)}var dm=class n extends lo{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new At(e.firestore,e.converter,Mg(e._query,this._limit,this._limitType))}};function rF(n){return P1("limit",n),dm._create("limit",n,"F")}function iF(n){return P1("limitToLast",n),dm._create("limitToLast",n,"L")}var hm=class n extends lo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=cF(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new Jn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function sF(...n){return hm._create("startAt",n,!0)}function oF(...n){return hm._create("startAfter",n,!1)}var fm=class n extends lo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=cF(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new Jn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function aF(...n){return fm._create("endBefore",n,!1)}function uF(...n){return fm._create("endAt",n,!0)}function cF(n,e,t,r){if(t[0]=ye(t[0]),t[0]instanceof co)return function(s,o,a,u,l){if(!u)throw new P(R.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let f of Xa(s))if(f.field.isKeyField())d.push(to(o,u.key));else{let g=u.data.field(f.field);if(gm(g))throw new P(R.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let y=f.field.canonicalString();throw new P(R.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(g)}return new Sr(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=fo(n.firestore);return function(o,a,u,l,d,f){let g=o.explicitOrderBy;if(d.length>g.length)throw new P(R.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let _=0;_<d.length;_++){let D=d[_];if(g[_].field.isKeyField()){if(typeof D!="string")throw new P(R.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof D}`);if(!XD(o)&&D.indexOf("/")!==-1)throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${D}' contains a slash.`);let S=o.path.child(Ce.fromString(D));if(!B.isDocumentKey(S))throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${S}' is not because it contains an odd number of segments.`);let k=new B(S);y.push(to(a,k))}else{let S=Y1(u,l,D);y.push(S)}}return new Sr(y,f)}(n._query,n.firestore._databaseId,i,e,t,r)}}function tO(n,e,t){if(typeof(t=ye(t))=="string"){if(t==="")throw new P(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!XD(e)&&t.indexOf("/")!==-1)throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Ce.fromString(t));if(!B.isDocumentKey(r))throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return to(n,new B(r))}if(t instanceof Be)return to(n,t._key);throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_m(t)}.`)}function nO(n,e){if(!Array.isArray(n)||n.length===0)throw new P(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function lF(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new P(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var yu=class{convertValue(e,t="none"){switch(eo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ji(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw G()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return ho(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new uo(Je(e.latitude),Je(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=ZD(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(id(e));default:return null}}convertTimestamp(e){let t=Jr(e);return new Qe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Ce.fromString(e);K(t1(r));let i=new Xi(r.get(1),r.get(3)),s=new B(r.popFirst(5));return i.isEqual(t)||rt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Im(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var zD=class extends yu{constructor(e){super(),this.firestore=e}convertBytes(e){return new xr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Be(this.firestore,null,t)}};var Zr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},On=class extends co{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Qi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Em("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Qi=class extends On{data(e={}){return super.data(e)}},tr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Zr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Qi(this._firestore,this._userDataWriter,r.key,r,new Zr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new Qi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new Qi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:A3(a.type),doc:u,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function A3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G()}}function Ab(n,e){return n instanceof On&&e instanceof On?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof tr&&e instanceof tr&&n._firestore===e._firestore&&Cb(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function dF(n){n=De(n,Be);let e=De(n.firestore,We);return M1(gt(e),n._key).then(t=>Nb(e,n,t))}var ni=class extends yu{constructor(e){super(),this.firestore=e}convertBytes(e){return new xr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Be(this.firestore,null,t)}};function hF(n){n=De(n,Be);let e=De(n.firestore,We),t=gt(e),r=new ni(e);return E3(t,n._key).then(i=>new On(e,r,n._key,i,new Zr(i!==null&&i.hasLocalMutations,!0),n.converter))}function fF(n){n=De(n,Be);let e=De(n.firestore,We);return M1(gt(e),n._key,{source:"server"}).then(t=>Nb(e,n,t))}function pF(n){n=De(n,At);let e=De(n.firestore,We),t=gt(e),r=new ni(e);return eF(n._query),R1(t,n._query).then(i=>new tr(e,r,n,i))}function gF(n){n=De(n,At);let e=De(n.firestore,We),t=gt(e),r=new ni(e);return I3(t,n._query).then(i=>new tr(e,r,n,i))}function mF(n){n=De(n,At);let e=De(n.firestore,We),t=gt(e),r=new ni(e);return R1(t,n._query,{source:"server"}).then(i=>new tr(e,r,n,i))}function xb(n,e,t){n=De(n,Be);let r=De(n.firestore,We),i=Im(n.converter,e,t);return Du(r,[wm(fo(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Xe.none())])}function Mb(n,e,t,...r){n=De(n,Be);let i=De(n.firestore,We),s=fo(i),o;return o=typeof(e=ye(e))=="string"||e instanceof er?bb(s,"updateDoc",n._key,e,t,r):Db(s,"updateDoc",n._key,e),Du(i,[o.toMutation(n._key,Xe.exists(!0))])}function yF(n){return Du(De(n.firestore,We),[new is(n._key,Xe.none())])}function vF(n,e){let t=De(n.firestore,We),r=xd(n),i=Im(n.converter,e);return Du(t,[wm(fo(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Xe.exists(!1))]).then(()=>r)}function Rb(n,...e){var t,r,i;n=ye(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||kD(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(kD(e[o])){let f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let u,l,d;if(n instanceof Be)l=De(n.firestore,We),d=_u(n._key.path),u={next:f=>{e[o]&&e[o](Nb(l,n,f))},error:e[o+1],complete:e[o+2]};else{let f=De(n,At);l=De(f.firestore,We),d=f._query;let g=new ni(l);u={next:y=>{e[o]&&e[o](new tr(l,g,f,y))},error:e[o+1],complete:e[o+2]},eF(n._query)}return function(g,y,_,D){let S=new gu(D),k=new vd(y,S,_);return g.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return ub(yield mu(g),k)})),()=>{S.$a(),g.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return cb(yield mu(g),k)}))}}(gt(l),d,a,u)}function _F(n,e){return C3(gt(n=De(n,We)),kD(e)?e:{next:e})}function Du(n,e){return function(r,i){let s=new dt;return r.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return n3(yield vb(r),i,s)})),s.promise}(gt(n),e)}function Nb(n,e,t){let r=t.docs.get(e._key),i=new ni(n);return new On(n,i,e._key,r,new Zr(t.hasPendingWrites,t.fromCache),e.converter)}var x3={maxAttempts:5};var pm=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=fo(e)}set(e,t,r){this._verifyNotCommitted();let i=Wi(e,this._firestore),s=Im(i.converter,t,r),o=wm(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Xe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Wi(e,this._firestore),o;return o=typeof(t=ye(t))=="string"||t instanceof er?bb(this._dataReader,"WriteBatch.update",s._key,t,r,i):Db(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Xe.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Wi(e,this._firestore);return this._mutations=this._mutations.concat(new is(t._key,Xe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Wi(n,e){if((n=ye(n)).firestore!==e)throw new P(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var WD=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=fo(t)}get(t){let r=Wi(t,this._firestore),i=new zD(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return G();let o=s[0];if(o.isFoundDocument())return new co(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new co(this._firestore,i,r._key,null,r.converter);throw G()})}set(t,r,i){let s=Wi(t,this._firestore),o=Im(s.converter,r,i),a=wm(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=Wi(t,this._firestore),a;return a=typeof(r=ye(r))=="string"||r instanceof er?bb(this._dataReader,"Transaction.update",o._key,r,i,s):Db(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=Wi(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Wi(e,this._firestore),r=new ni(this._firestore);return super.get(e).then(i=>new On(this._firestore,r,t._key,i._document,new Zr(!1,!1),t.converter))}};function wF(n,e,t){n=De(n,We);let r=Object.assign(Object.assign({},x3),t);return function(s){if(s.maxAttempts<1)throw new P(R.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new dt;return s.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){let l=yield v3(s);new MD(s.asyncQueue,l,a,o,u).Xa()})),u.promise}(gt(n),i=>e(new WD(n,i)),r)}function EF(){return new Ed("deleteField")}function IF(){return new LD("serverTimestamp")}function CF(...n){return new jD("arrayUnion",n)}function DF(...n){return new UD("arrayRemove",n)}function bF(n){return new BD("increment",n)}(function(e,t=!0){(function(i){vu=i})(th),fs(new un("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new We(new JI(r.getProvider("auth-internal")),new nC(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new P(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xi(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Vn(rk,"4.6.3",e),Vn(rk,"4.6.3","esm2017")})();var M3="@firebase/firestore-compat",R3="0.3.32";function Lb(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function TF(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function SF(){if(!yO())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Cm=class n{constructor(e){this._delegate=e}static fromBase64String(e){return SF(),new n(xr.fromBase64String(e))}static fromUint8Array(e){return TF(),new n(xr.fromUint8Array(e))}toBase64(){return SF(),this._delegate.toBase64()}toUint8Array(){return TF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Pb(n){return N3(n,["next","error","complete"])}function N3(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var kb=class{enableIndexedDbPersistence(e,t){return L1(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return j1(e._delegate)}clearIndexedDbPersistence(e){return B1(e._delegate)}},Dm=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Xi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Pn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){k1(this._delegate,e,t,r)}enableNetwork(){return H1(this._delegate)}disableNetwork(){return q1(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,wb("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return $1(this._delegate)}onSnapshotsInSync(e){return _F(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Su(this,Eb(this._delegate,e))}catch(t){throw Xt(t,"collection()","Firestore.collection()")}}doc(e){try{return new Mr(this,xd(this._delegate,e))}catch(t){throw Xt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new vo(this,O1(this._delegate,e))}catch(t){throw Xt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return wF(this._delegate,t=>e(new bm(this,t)))}batch(){return gt(this._delegate),new Tm(new pm(this._delegate,e=>Du(this._delegate,e)))}loadBundle(e){return G1(this._delegate,e)}namedQuery(e){return z1(this._delegate,e).then(t=>t?new vo(this,t):null)}},bu=class extends yu{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cm(new xr(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Mr.forKey(t,this.firestore,null)}};function P3(n){rO(n)}var bm=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new bu(e)}get(e){let t=go(e);return this._delegate.get(t).then(r=>new mo(this._firestore,new On(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=go(e);return r?(Lb("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=go(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=go(e);return this._delegate.delete(t),this}},Tm=class{constructor(e){this._delegate=e}set(e,t,r){let i=go(e);return r?(Lb("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=go(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=go(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Tu=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Qi(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new yo(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new bu(e),t),i.set(t,s)),s}};Tu.INSTANCES=new WeakMap;var Mr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new bu(e)}static forPath(e,t,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Be(t._delegate,r,new B(e)))}static forKey(e,t,r){return new n(t,new Be(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Su(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Su(this.firestore,Eb(this._delegate,e))}catch(t){throw Xt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ye(e),e instanceof Be?Ib(this._delegate,e):!1}set(e,t){t=Lb("DocumentReference.set",t);try{return t?xb(this._delegate,e,t):xb(this._delegate,e)}catch(r){throw Xt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?Mb(this._delegate,e):Mb(this._delegate,e,t,...r)}catch(i){throw Xt(i,"updateDoc()","DocumentReference.update()")}}delete(){return yF(this._delegate)}onSnapshot(...e){let t=AF(e),r=xF(e,i=>new mo(this.firestore,new On(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Rb(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=hF(this._delegate):e?.source==="server"?t=fF(this._delegate):t=dF(this._delegate),t.then(r=>new mo(this.firestore,new On(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Tu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Xt(n,e,t){return n.message=n.message.replace(e,t),n}function AF(n){for(let e of n)if(typeof e=="object"&&!Pb(e))return e;return{}}function xF(n,e){var t,r;let i;return Pb(n[0])?i=n[0]:Pb(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var mo=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Mr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Ab(this._delegate,e._delegate)}},yo=class extends mo{data(e){let t=this._delegate.data(e);return this._delegate._converter||iO(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},vo=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new bu(e)}where(e,t,r){try{return new n(this.firestore,ii(this._delegate,tF(e,t,r)))}catch(i){throw Xt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,ii(this._delegate,nF(e,t)))}catch(r){throw Xt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,ii(this._delegate,rF(e)))}catch(t){throw Xt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,ii(this._delegate,iF(e)))}catch(t){throw Xt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,ii(this._delegate,sF(...e)))}catch(t){throw Xt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,ii(this._delegate,oF(...e)))}catch(t){throw Xt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,ii(this._delegate,aF(...e)))}catch(t){throw Xt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,ii(this._delegate,uF(...e)))}catch(t){throw Xt(t,"endAt()","Query.endAt()")}}isEqual(e){return Cb(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=gF(this._delegate):e?.source==="server"?t=mF(this._delegate):t=pF(this._delegate),t.then(r=>new Md(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=AF(e),r=xF(e,i=>new Md(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Rb(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Tu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Ob=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new yo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Md=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new vo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new yo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Ob(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new yo(this._firestore,r))})}isEqual(e){return Ab(this._delegate,e._delegate)}},Su=class n extends vo{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Mr(this.firestore,e):null}doc(e){try{return e===void 0?new Mr(this.firestore,xd(this._delegate)):new Mr(this.firestore,xd(this._delegate,e))}catch(t){throw Xt(t,"doc()","CollectionReference.doc()")}}add(e){return vF(this._delegate,e).then(t=>new Mr(this.firestore,t))}isEqual(e){return Ib(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Tu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function go(n){return De(n,Be)}var Fb=class n{constructor(...e){this._delegate=new er(...e)}static documentId(){return new n(it.keyField().canonicalString())}isEqual(e){return e=ye(e),e instanceof er?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Vb=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=IF();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=EF();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=CF(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=DF(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=bF(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var k3={Firestore:Dm,GeoPoint:uo,Timestamp:Qe,Blob:Cm,Transaction:bm,WriteBatch:Tm,DocumentReference:Mr,DocumentSnapshot:mo,Query:vo,QueryDocumentSnapshot:yo,QuerySnapshot:Md,CollectionReference:Su,FieldPath:Fb,FieldValue:Vb,setLogLevel:P3,CACHE_SIZE_UNLIMITED:F1};function O3(n,e){n.INTERNAL.registerComponent(new un("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},k3)))}function F3(n){O3(n,(e,t)=>new Dm(e,t,new kb)),n.registerVersion(M3,R3)}F3(yt);function V3(n,e=vs){return new de(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function MF(n,e){return V3(n,e)}function L3(n,e){return MF(n,e).pipe(ws(void 0),tc(),Q(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function Bb(n,e){return MF(n,e).pipe(Q(t=>({payload:t,type:"query"})))}var Sm=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:s}=OF(r,t);return new xm(i,s,this.afs)}snapshotChanges(){return L3(this.ref,this.afs.schedulers.outsideAngular).pipe(nt)}valueChanges(e={}){return this.snapshotChanges().pipe(Q(({payload:t})=>e.idField?Ae(q({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return be(this.ref.get(e)).pipe(nt)}};function Am(n,e){return Bb(n,e).pipe(ws(void 0),tc(),Q(t=>{let[r,i]=t,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let l=s.find(f=>f.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(f=>f.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function RF(n,e,t){return Am(n,t).pipe(ir((r,i)=>j3(r,i.map(s=>s.payload),e),[]),Xu(),Q(r=>r.map(i=>({type:i.type,payload:i}))))}function j3(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=U3(n,r))}),n}function jb(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function U3(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return jb(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return jb(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return jb(n,e.oldIndex,1);break}return n}function NF(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var xm=class{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Am(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Q(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(ws(void 0),tc(),Tt(([r,i])=>i.length>0||!r),Q(([,r])=>r),nt)}auditTrail(e){return this.stateChanges(e).pipe(ir((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=NF(e);return RF(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt)}valueChanges(e={}){return Bb(this.query,this.afs.schedulers.outsideAngular).pipe(Q(t=>t.payload.docs.map(r=>e.idField?Ae(q({},r.data()),{[e.idField]:r.id}):r.data())),nt)}get(e){return be(this.query.get(e)).pipe(nt)}add(e){return this.ref.add(e)}doc(e){return new Sm(this.ref.doc(e),this.afs)}},Ub=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Am(this.query,this.afs.schedulers.outsideAngular).pipe(nt):Am(this.query,this.afs.schedulers.outsideAngular).pipe(Q(t=>t.filter(r=>e.indexOf(r.type)>-1)),Tt(t=>t.length>0),nt)}auditTrail(e){return this.stateChanges(e).pipe(ir((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=NF(e);return RF(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt)}valueChanges(e={}){return Bb(this.query,this.afs.schedulers.outsideAngular).pipe(Q(r=>r.payload.docs.map(i=>e.idField?q({[e.idField]:i.id},i.data()):i.data())),nt)}get(e){return be(this.query.get(e)).pipe(nt)}},PF=new z("angularfire2.enableFirestorePersistence"),kF=new z("angularfire2.firestore.persistenceSettings"),B3=new z("angularfire2.firestore.settings"),$3=new z("angularfire2.firestore.use-emulator");function OF(n,e=t=>t){return{query:e(n),ref:n}}var H3=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,s,o,a,u,l,d,f,g,y,_,D,S,k,U){this.schedulers=u;let F=Fs(t,a,r),W=d;f&&ol(F,a,g,_,D,S,y,k),[this.firestore,this.persistenceEnabled$]=va(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let te=a.runOutsideAngular(()=>F.firestore());if(s&&te.settings(s),W&&te.useEmulator(...W),i&&!Ps(o)){let X=()=>{try{return be(te.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),Z(!1)}};return[te,a.runOutsideAngular(X)]}else return[te,Z(!1)]},[s,W,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:o}=OF(i,r),a=this.schedulers.ngZone.run(()=>s);return new xm(a,o,this)}collectionGroup(t,r){let i=r||(o=>o),s=this.firestore.collectionGroup(t);return new Ub(i(s),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.schedulers.ngZone.run(()=>r);return new Sm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(V(Mi),V(Ri,8),V(PF,8),V(B3,8),V(Vt),V(Te),V(ya),V(kF,8),V($3,8),V(_a,8),V(el,8),V(tl,8),V(nl,8),V(rl,8),V(il,8),V(sl,8),V(zr,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),FF=(()=>{class n{constructor(){yt.registerVersion("angularfire",Ai.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:PF,useValue:!0},{provide:kF,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Wt({type:n});static \u0275inj=zt({providers:[H3]})}return n})();var VF={apiKey:"AIzaSyB9-l6PItoRZebyWB3FvFkSzcY68NOZQTg",authDomain:"crud-angular-595f3.firebaseapp.com",databaseURL:"https://crud-angular-595f3-default-rtdb.firebaseio.com",projectId:"crud-angular-595f3",storageBucket:"crud-angular-595f3.appspot.com",messagingSenderId:"357916148393",appId:"1:357916148393:web:e0b458da3c5cb307a8dfb8",measurementId:"G-Y2Y4LWJY6F"};var LF={providers:[DM(ek),jv([zM.initializeApp(VF),_a,mP,FF])]};var jF=(()=>{let e=class e{constructor(){this.title="crud-firebase-p"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=_i({type:e,selectors:[["app-root"]],standalone:!0,features:[Ci],decls:13,vars:0,consts:[[1,"navbar","navbar-expand-lg","border-bottom","sticky-top","bg-body-tertiary"],[1,"container"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["aria-current","page","href","#",1,"nav-link","active"],[1,"container","pt-4"]],template:function(i,s){i&1&&(je(0,"nav",0)(1,"div",1)(2,"a",2),tt(3,"Expense"),Fe(),je(4,"button",3),dr(5,"span",4),Fe(),je(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),tt(10,"Home"),Fe()()()()()(),je(11,"div",9),dr(12,"router-outlet"),Fe())},dependencies:[yw]});let n=e;return n})();Ox(jF,LF).catch(n=>console.error(n));
